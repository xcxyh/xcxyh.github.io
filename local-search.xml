<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>AirBnb Mavericks æ¡†æ¶æ¢ç©¶</title>
    <link href="/2024/07/13/AirBnb-Mavericks-%E6%A1%86%E6%9E%B6%E6%8E%A2%E7%A9%B6/"/>
    <url>/2024/07/13/AirBnb-Mavericks-%E6%A1%86%E6%9E%B6%E6%8E%A2%E7%A9%B6/</url>
    
    <content type="html"><![CDATA[<p>Mavericks æ˜¯ Airbnb çš„ Android MVI æ¡†æ¶ï¼Œæ˜¯ä¸€ç§å“åº”å¼çš„ UI æ¡†æ¶ã€‚</p><p>Mavericks å»ºç«‹åœ¨ä»¥ä¸‹ç°æœ‰æŠ€æœ¯å’Œæ¦‚å¿µä¹‹ä¸Šï¼š</p><ul><li>Kotlin è¯­è¨€</li><li>Android Architecture Componentsï¼ˆLifecycleã€ViewModel ç­‰ï¼‰</li><li>Kotlin Flow</li><li>React (æ¦‚å¿µ)</li></ul><p>Mavericks å¸æ”¶äº†æ¥è‡ª React çš„å“åº”å¼æ€æƒ³ï¼ŒåŒæ—¶ Mavericks ä¾èµ–äº† Kotlinã€AACï¼ˆAndroid Architecture Componentsï¼‰ã€Flow ç­‰æŠ€æœ¯ï¼Œå®ç°äº†ä¸€ä¸ª Android åŸç”Ÿçš„å“åº”å¼ UI æ¡†æ¶ã€‚</p><p>æŒ‡è·¯-&gt;ï¼š<a href="https://github.com/airbnb/mavericks">https://github.com/airbnb/mavericks</a></p><p>This is what it looks like:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorldState</span>(<span class="hljs-keyword">val</span> title: String = <span class="hljs-string">&quot;Hello World&quot;</span>) : MavericksState<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Refer to the wiki for how to set up your base ViewModel.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorldViewModel</span>(initialState: HelloWorldState) : MavericksViewModel&lt;HelloWorldState&gt;(initialState) &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getMoreExcited</span><span class="hljs-params">()</span></span> = setState &#123; copy(title = <span class="hljs-string">&quot;<span class="hljs-variable">$title</span>!&quot;</span>) &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorldFragment</span> : <span class="hljs-type">Fragment</span>(R.layout.hello_world_fragment), MavericksView &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewModel: HelloWorldViewModel <span class="hljs-keyword">by</span> fragmentViewModel()<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">invalidate</span><span class="hljs-params">()</span></span> = withState(viewModel) &#123; state -&gt;<br>        <span class="hljs-comment">// Update your views with the latest state here.</span><br>        <span class="hljs-comment">// This will get called any time your state changes and the viewLifecycleOwner is STARTED.</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¾èµ–ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">dependencies &#123;<br>  implementation <span class="hljs-string">&#x27;com.airbnb.android:mavericks:x.y.z&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å®˜æ–¹æ–‡æ¡£ç½‘ç«™ï¼š<a href="https://airbnb.io/mavericks/#/">Mavericks Docs (airbnb.io)</a></p><p>Mavericks å»ºç«‹åœ¨ Â <a href="https://developer.android.com/jetpack">Android Jetpack</a>Â  å’Œ Â <a href="https://developer.android.com/kotlin/coroutines">Kotlin åç¨‹</a>ä¹‹ä¸Šï¼Œå› æ­¤å¯ä»¥å°†å…¶è§†ä¸ºå¯¹ Google æ ‡å‡†åº“é›†çš„è¡¥å……ï¼Œè€Œä¸æ˜¯èƒŒç¦»ã€‚</p><p>Mavericks çš„ 1.0 ç‰ˆæœ¬ MVRX æ˜¯å»ºç«‹åœ¨ Rxjava çš„åŸºç¡€ä¹‹ä¸Šï¼Œä½†æ˜¯ï¼Œåœ¨å¦‚ä»Šå¤§éƒ¨åˆ† APP éƒ½åˆ‡æ¢åˆ° kotlin åç¨‹ä¹‹åï¼Œå¾ˆå¤š App éƒ½ä¸å†æœ‰ RxJava çš„ä¾èµ–äº†ï¼Œå› æ­¤ï¼ŒAirBnb ä½¿ç”¨ Kotlin Flow é‡å†™äº†è¯¥æ¡†æ¶ï¼Œä¹Ÿå°±æ˜¯ Mavericks 2.0ã€‚</p><p>ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å®ƒï¼Ÿ</p><ol><li>å‡å°‘ 50%åˆ° 75%ä»£ç ï¼Œæ›´ç®€æ´é«˜æ•ˆçš„å¼€å‘</li><li>çœŸæ­£çš„å“åº”å¼ï¼Œæ•°æ®ä¸ UI è§£è€¦ï¼Œæ›´æ¸…æ™°çš„ä»£ç </li><li>ä¸ Kotlinã€AAC çš„ç»“åˆä¸åŒ…å®¹ï¼Œæ›´ç¬¦åˆæŠ€æœ¯è¶‹åŠ¿</li><li>React æ€æƒ³åœ¨å®‰å“çš„æœ€ä½³å®è·µ</li></ol><p>å•å‘æ•°æ®æµã€å“åº”å¼ UI æ¶æ„æ¨¡å¼ï¼š</p><p>MVIï¼ˆModel-View-Intentï¼‰ å’Œ React æ˜¯ä¸¤ç§å¸¸ç”¨çš„ UI æ¶æ„æ¨¡å¼ï¼Œåˆ†åˆ«ç”¨äº Android å’Œå‰ç«¯å¼€å‘ã€‚MVI å’Œ React éƒ½æ˜¯ç°ä»£ UI æ¶æ„æ¨¡å¼ï¼Œå¼ºè°ƒå•å‘æ•°æ®æµå’Œä¸å¯å˜çŠ¶æ€ã€‚å°½ç®¡å®ƒä»¬åº”ç”¨äºä¸åŒçš„å¹³å°ï¼Œä½†å®ƒä»¬åœ¨è®¾è®¡ç†å¿µä¸Šæœ‰è®¸å¤šç›¸ä¼¼ä¹‹å¤„ï¼Œç‰¹åˆ«æ˜¯åœ¨å•å‘æ•°æ®æµçš„æ¦‚å¿µä¸Šã€‚</p><h3 id="MVIï¼ˆModel-View-Intentï¼‰"><a href="#MVIï¼ˆModel-View-Intentï¼‰" class="headerlink" title="MVIï¼ˆModel-View-Intentï¼‰"></a>MVIï¼ˆModel-View-Intentï¼‰</h3><p>MVI æ˜¯ä¸€ç§ç”¨äº Android åº”ç”¨çš„æ¶æ„æ¨¡å¼ï¼Œå®ƒå¼ºè°ƒå•å‘æ•°æ®æµå’Œä¸å¯å˜çŠ¶æ€ã€‚MVI ç”±ä¸‰ä¸ªä¸»è¦éƒ¨åˆ†ç»„æˆï¼š</p><ol><li><strong>Model</strong>: è¡¨ç¤ºåº”ç”¨çš„çŠ¶æ€ã€‚Model é€šå¸¸æ˜¯ä¸å¯å˜çš„ï¼Œè¿™æ„å‘³ç€æ¯æ¬¡çŠ¶æ€å˜åŒ–éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ Model å®ä¾‹ã€‚</li><li><strong>View</strong>: è´Ÿè´£å‘ˆç° UI å¹¶æ¥æ”¶ç”¨æˆ·è¾“å…¥ã€‚View å°†ç”¨æˆ·è¾“å…¥è½¬æ¢ä¸º Intentã€‚</li><li><strong>Intent</strong>: è¡¨ç¤ºç”¨æˆ·çš„æ„å›¾æˆ–åŠ¨ä½œã€‚Intent è¢«å‘é€åˆ° Modelï¼ŒModel æ ¹æ® Intent æ›´æ–°çŠ¶æ€ã€‚</li></ol><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202407131912670.png" alt="å•å‘æ•°æ®æµ"></p><h4 id="æ•°æ®æµ"><a href="#æ•°æ®æµ" class="headerlink" title="æ•°æ®æµ"></a>æ•°æ®æµ</h4><ol><li><strong>ç”¨æˆ·äº¤äº’</strong>: ç”¨æˆ·ä¸ View äº¤äº’ï¼Œè§¦å‘ä¸€ä¸ª Intentã€‚</li><li><strong>Intent å¤„ç†</strong>: Intent è¢«å‘é€åˆ° Modelï¼ŒModel å¤„ç† Intent å¹¶æ›´æ–°çŠ¶æ€ã€‚</li><li><strong>çŠ¶æ€æ›´æ–°</strong>: æ›´æ–°åçš„çŠ¶æ€é€šè¿‡å•å‘æ•°æ®æµä¼ é€’å› Viewï¼Œæ›´æ–° UIã€‚</li></ol><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewState</span>(<span class="hljs-keyword">val</span> count: <span class="hljs-built_in">Int</span>)<br><br><span class="hljs-keyword">sealed</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewIntent</span> &#123;<br>    <span class="hljs-keyword">object</span> Increment : ViewIntent()<br>    <span class="hljs-keyword">object</span> Decrement : ViewIntent()<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainViewModel</span> : <span class="hljs-type">ViewModel</span>() &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _viewState = MutableStateFlow(ViewState(<span class="hljs-number">0</span>))<br>    <span class="hljs-keyword">val</span> viewState: StateFlow&lt;ViewState&gt; = _viewState<br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processIntent</span><span class="hljs-params">(intent: <span class="hljs-type">ViewIntent</span>)</span></span> &#123;<br>        <span class="hljs-keyword">when</span> (intent) &#123;<br>            <span class="hljs-keyword">is</span> ViewIntent.Increment -&gt; _viewState.value = _viewState.value.copy(count = _viewState.value.count + <span class="hljs-number">1</span>)<br>            <span class="hljs-keyword">is</span> ViewIntent.Decrement -&gt; _viewState.value = _viewState.value.copy(count = _viewState.value.count - <span class="hljs-number">1</span>)<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@Composable</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">MainScreen</span><span class="hljs-params">(viewModel: <span class="hljs-type">MainViewModel</span>)</span></span> &#123;<br>    <span class="hljs-keyword">val</span> viewState <span class="hljs-keyword">by</span> viewModel.viewState.collectAsState()<br>    Column &#123;<br>        Text(<span class="hljs-string">&quot;Count: <span class="hljs-subst">$&#123;viewState.count&#125;</span>&quot;</span>)<br>        Button(onClick = &#123; viewModel.processIntent(ViewIntent.Increment) &#125;) &#123;<br>            Text(<span class="hljs-string">&quot;Increment&quot;</span>)<br>        &#125;<br>        Button(onClick = &#123; viewModel.processIntent(ViewIntent.Decrement) &#125;) &#123;<br>            Text(<span class="hljs-string">&quot;Decrement&quot;</span>)<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="React-Redux"><a href="#React-Redux" class="headerlink" title="React + Redux"></a>React + Redux</h3><p>React æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“ã€‚React ä¹Ÿå¼ºè°ƒå•å‘æ•°æ®æµå’Œä¸å¯å˜çŠ¶æ€ã€‚React çš„æ ¸å¿ƒæ¦‚å¿µåŒ…æ‹¬ï¼š</p><ol><li><strong>Component</strong>: React åº”ç”¨ç”±ç»„ä»¶ç»„æˆã€‚æ¯ä¸ªç»„ä»¶æè¿°äº† UI çš„ä¸€éƒ¨åˆ†ã€‚</li><li><strong>State</strong>: ç»„ä»¶å¯ä»¥æ‹¥æœ‰çŠ¶æ€ã€‚çŠ¶æ€å˜åŒ–ä¼šè§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</li><li><strong>Props</strong>: ç»„ä»¶å¯ä»¥æ¥æ”¶å¤–éƒ¨ä¼ å…¥çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®ç§°ä¸º Propsã€‚</li></ol><p>Redux æ˜¯ä¸€ä¸ªç”¨äº JavaScript åº”ç”¨çš„çŠ¶æ€ç®¡ç†åº“ï¼Œé€šå¸¸ä¸ React ä¸€èµ·ä½¿ç”¨ï¼Œä½†ä¹Ÿå¯ä»¥ä¸å…¶ä»– JavaScript æ¡†æ¶æˆ–åº“ä¸€èµ·ä½¿ç”¨ã€‚Redux æä¾›äº†ä¸€ç§å¯é¢„æµ‹çš„æ–¹å¼æ¥ç®¡ç†åº”ç”¨çš„çŠ¶æ€ï¼Œä½¿å¾—çŠ¶æ€å˜åŒ–æ›´åŠ é€æ˜å’Œå¯è°ƒè¯•ã€‚</p><p>Redux çš„è®¾è®¡åŸºäºå‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š</p><ol><li><strong>å•ä¸€æ•°æ®æºï¼ˆSingle Source of Truthï¼‰</strong>:<ul><li>åº”ç”¨çš„æ•´ä¸ªçŠ¶æ€è¢«å­˜å‚¨åœ¨ä¸€ä¸ªå¯¹è±¡æ ‘ä¸­ï¼Œè¿™ä¸ªå¯¹è±¡æ ‘åªå­˜åœ¨äºä¸€ä¸ªå•ä¸€çš„ store ä¸­ã€‚</li></ul></li><li><strong>çŠ¶æ€æ˜¯åªè¯»çš„ï¼ˆState is Read-Onlyï¼‰</strong>:<ul><li>å”¯ä¸€æ”¹å˜çŠ¶æ€çš„æ–¹æ³•æ˜¯è§¦å‘ä¸€ä¸ª actionã€‚è¿™æ ·å¯ä»¥ç¡®ä¿çŠ¶æ€çš„å˜åŒ–æ˜¯å¯é¢„æµ‹çš„å’Œå¯è¿½è¸ªçš„ã€‚</li></ul></li><li><strong>ä½¿ç”¨çº¯å‡½æ•°æ¥æ‰§è¡Œä¿®æ”¹ï¼ˆChanges are Made with Pure Functionsï¼‰</strong>:<ul><li>ä¸ºäº†æè¿°çŠ¶æ€æ ‘å¦‚ä½•é€šè¿‡ actions è½¬å˜æˆä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œä½ éœ€è¦ç¼–å†™çº¯å‡½æ•°ï¼ˆreducersï¼‰ã€‚</li></ul></li></ol><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202407131912371.png" alt="Redux"></p><h4 id="æ•°æ®æµ-1"><a href="#æ•°æ®æµ-1" class="headerlink" title="æ•°æ®æµ"></a>æ•°æ®æµ</h4><ol><li><strong>ç”¨æˆ·äº¤äº’</strong>: ç”¨æˆ·ä¸ç»„ä»¶äº¤äº’ï¼Œè§¦å‘çŠ¶æ€å˜åŒ–ã€‚</li><li><strong>çŠ¶æ€æ›´æ–°</strong>: çŠ¶æ€å˜åŒ–ä¼šè§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</li><li><strong>å•å‘æ•°æ®æµ</strong>: æ•°æ®ä»çˆ¶ç»„ä»¶æµå‘å­ç»„ä»¶ï¼Œå­ç»„ä»¶æ¥æ”¶äº‹ä»¶æ›´æ”¹çŠ¶æ€ï¼ŒçŠ¶æ€æ”¹å˜è§¦å‘ UI æ›´æ–°ã€‚</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-title class_">ReactDOM</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-dom&quot;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Provider</span>, useDispatch, useSelector &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-redux&quot;</span>;<br><span class="hljs-keyword">import</span> &#123; createStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux&quot;</span>;<br><br><span class="hljs-comment">// Reducer</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">counter</span>(<span class="hljs-params">state = <span class="hljs-number">0</span>, action</span>) &#123;<br>  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;INCREMENT&quot;</span>:<br>      <span class="hljs-keyword">return</span> state + <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;DECREMENT&quot;</span>:<br>      <span class="hljs-keyword">return</span> state - <span class="hljs-number">1</span>;<br>    <span class="hljs-attr">default</span>:<br>      <span class="hljs-keyword">return</span> state;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// åˆ›å»º Store</span><br><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(counter);<br><br><span class="hljs-comment">// React ç»„ä»¶</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Counter</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> count = <span class="hljs-title function_">useSelector</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state);<br>  <span class="hljs-keyword">const</span> dispatch = <span class="hljs-title function_">useDispatch</span>();<br><br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: &#123;count&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> dispatch(&#123; type: &quot;INCREMENT&quot; &#125;)&#125;&gt;Increment<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> dispatch(&#123; type: &quot;DECREMENT&quot; &#125;)&#125;&gt;Decrement<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  );<br>&#125;<br><br><span class="hljs-comment">// æ¸²æŸ“åº”ç”¨</span><br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<br>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Provider</span> <span class="hljs-attr">store</span>=<span class="hljs-string">&#123;store&#125;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Counter</span> /&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">Provider</span>&gt;</span></span>,<br>  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;root&quot;</span>)<br>);<br></code></pre></td></tr></table></figure><p>MVI å’Œ React + Redux ä¸¤è€…å…·æœ‰ç›¸åŒçš„å“åº”å¼æ€æƒ³å’Œæ¶æ„æ¨¡å¼ï¼š</p><ol><li><strong>ä¸å¯å˜çŠ¶æ€</strong>:<ul><li><strong>MVI</strong>: çŠ¶æ€æ˜¯ä¸å¯å˜çš„ï¼Œæ¯æ¬¡çŠ¶æ€å˜åŒ–éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çŠ¶æ€å¯¹è±¡ã€‚</li><li><strong>React + Redux</strong>: Redux å¼ºè°ƒä½¿ç”¨ä¸å¯å˜çŠ¶æ€ï¼Œæ¯æ¬¡çŠ¶æ€å˜åŒ–éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çŠ¶æ€å¯¹è±¡ã€‚</li></ul></li><li><strong>å•å‘æ•°æ®æµ</strong>:<ul><li><strong>MVI</strong>: æ•°æ®æµæ˜¯å•å‘çš„ï¼Œä» Intent åˆ° Modelï¼Œå†ä» Model åˆ° Viewã€‚</li><li><strong>React + Redux</strong>: æ•°æ®æµä¹Ÿæ˜¯å•å‘çš„ï¼Œä» Action åˆ° Reducerï¼Œå†ä» Store åˆ° Viewã€‚</li></ul></li><li><strong>çº¯å‡½æ•°</strong>:<ul><li><strong>MVI</strong>: Model æ›´æ–°æ˜¯é€šè¿‡çº¯å‡½æ•°å¤„ç†çš„ï¼Œå³ Reducerã€‚</li><li><strong>React + Redux</strong>: Redux ä¸­çš„ Reducer æ˜¯çº¯å‡½æ•°ï¼Œè´Ÿè´£æ ¹æ® Action æ›´æ–°çŠ¶æ€ã€‚</li></ul></li></ol><h3 id="Airbnb-Mavericks-æ¡†æ¶"><a href="#Airbnb-Mavericks-æ¡†æ¶" class="headerlink" title="Airbnb Mavericks æ¡†æ¶"></a>Airbnb Mavericks æ¡†æ¶</h3><p>è€Œå¯¹äº Airbnb çš„ Mavericks æ¥è¯´ï¼Œä¹Ÿæ˜¯å€Ÿé‰´å’Œç»§æ‰¿äº†ç›¸åŒçš„å“åº”å¼æ€æƒ³ï¼Œä¸‹é¢æˆ‘ä»¬å¯ä»¥æ¥å¯¹æ¯”ä¸€ä¸‹ï¼š</p><p><strong>çŠ¶æ€ä¸å¯å˜ï¼š</strong></p><p>MavericksState çš„çŠ¶æ€ä½¿ç”¨ <code>data class</code> å®šä¹‰ï¼Œæ˜¯ä¸å¯å˜çš„ï¼Œè¦ä¿®æ”¹çŠ¶æ€ï¼Œå¿…é¡»ç”¨<code>data class</code> çš„<code>clone</code>æ–¹æ³•ã€‚æ¯æ¬¡çŠ¶æ€å˜åŒ–ï¼Œéƒ½éœ€è¦é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs jsx">data <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserState</span>(<br>    val <span class="hljs-attr">score</span>: <span class="hljs-title class_">Int</span> = <span class="hljs-number">0</span>,<br>    val <span class="hljs-attr">previousHighScore</span>: <span class="hljs-title class_">Int</span> = <span class="hljs-number">150</span>,<br>    val <span class="hljs-attr">livesLeft</span>: <span class="hljs-title class_">Int</span> = <span class="hljs-number">99</span>,<br>) : <span class="hljs-title class_">MavericksState</span><br></code></pre></td></tr></table></figure><p><strong>å•å‘æ•°æ®æµï¼š</strong></p><p>é€šè¿‡ kotlin flow å®ç° æ•°æ® ï¼ˆstateï¼‰çš„å•å‘æµåŠ¨ã€‚</p><p>çŠ¶æ€æ›´æ–°ï¼šMavericks é€šè¿‡ setState æ–¹æ³•ï¼Œå¼‚æ­¥æ›´æ–° stateï¼Œç”±äº state ä¸º <code>data class</code> ï¼Œæ›´æ–°çŠ¶æ€æ—¶ç›´æ¥ä½¿ç”¨ copy æ–¹æ³•è·å–æ–°å¯¹è±¡ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs jsx">protected fun <span class="hljs-title function_">setState</span>(<span class="hljs-params">reducer: S.() -&gt; S</span>) &#123;<br><br>&#125;<br><span class="hljs-comment">// example:</span><br>setState &#123; <span class="hljs-title function_">copy</span>(yourProp = newValue) &#125;<br><br><span class="hljs-comment">//çŠ¶æ€å‘é€ï¼š</span><br>private suspend fun <span class="hljs-title function_">flushQueuesOnce</span>(<span class="hljs-params"></span>) &#123;<br>        select&lt;<span class="hljs-title class_">Unit</span>&gt; &#123;<br>            setStateChannel.<span class="hljs-property">onReceive</span> &#123; reducer -&gt;<br>                val newState = state.<span class="hljs-title function_">reducer</span>()<br>                <span class="hljs-keyword">if</span> (newState != state) &#123;<br>                    state = newState<br>                    stateSharedFlow.<span class="hljs-title function_">emit</span>(newState) <span class="hljs-comment">// å‘é€çŠ¶æ€</span><br>                &#125;<br>            &#125;<br>            withStateChannel.<span class="hljs-property">onReceive</span> &#123; block -&gt;<br>                <span class="hljs-title function_">block</span>(state)<br>            &#125;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>çŠ¶æ€ç›‘å¬ï¼šæœ€æ–°çš„çŠ¶æ€ é€šè¿‡ <strong>stateSharedFlow</strong> å‘é€ï¼Œé€šè¿‡ onEach ç›‘å¬ æ”¶é›† flow ä¸­çš„æœ€æ–°çŠ¶æ€ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-comment">// Invoked whenever propA changes only.</span><br><span class="hljs-title function_">onEach</span>(<span class="hljs-params">YourState::propA</span>) &#123; a -&gt;<br>&#125;<br><span class="hljs-comment">// Invoked whenever propA, propB, or propC changes only.</span><br><span class="hljs-title function_">onEach</span>(<span class="hljs-params">YourState::propA, YourState::propB, YourState::propC</span>) &#123; a, b, c -&gt;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>çº¯å‡½æ•°ï¼š</strong></p><p>Mavericks ä¸­çš„ setState { } ä»£ç å—å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ reducer: S.() -&gt; S è¿™éƒ¨åˆ†æ˜¯çº¯å‡½æ•°ã€‚</p><p>çº¯å‡½æ•°ï¼ˆPure Functionï¼‰æ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µã€‚ä¸€ä¸ªå‡½æ•°è¦è¢«è®¤ä¸ºæ˜¯çº¯å‡½æ•°ï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ol><li><strong>ç¡®å®šæ€§</strong>ï¼šå¯¹äºç›¸åŒçš„è¾“å…¥ï¼Œå‡½æ•°æ€»æ˜¯è¿”å›ç›¸åŒçš„è¾“å‡ºã€‚</li><li><strong>æ— å‰¯ä½œç”¨</strong>ï¼šå‡½æ•°çš„æ‰§è¡Œä¸ä¼šå½±å“å¤–éƒ¨çŠ¶æ€ï¼Œä¹Ÿä¸ä¼šä¾èµ–äºå¤–éƒ¨å¯å˜çŠ¶æ€ã€‚</li></ol><p>åœ¨ Mavericksï¼Œä¼šå¯¹ reducer å‡½æ•°æ‰§è¡Œä¸¤æ¬¡ï¼Œ è¿›è¡Œçº¯å‡½æ•°æ£€æŸ¥ï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jsx">val firstState = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">reducer</span>()<br>val secondState = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">reducer</span>()<br><br><span class="hljs-keyword">if</span> (firstState != secondState) &#123; &#125;<br></code></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œå¦‚ä¸‹å†™æ³• reducer å°±ä¸æ˜¯çº¯å‡½æ•°ï¼Œå¯¹äºç›¸åŒçš„è¾“å…¥ï¼Œä¸¤æ¬¡æ‰§è¡Œç»“æœä¸ä¸€è‡´ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jsx">setState &#123; <span class="hljs-title function_">copy</span>(time = <span class="hljs-title class_">System</span>.<span class="hljs-title function_">currentTimeMillis</span>()) &#125;<br></code></pre></td></tr></table></figure><h3 id="æ€ä¹ˆä½¿ç”¨ï¼Ÿ"><a href="#æ€ä¹ˆä½¿ç”¨ï¼Ÿ" class="headerlink" title="æ€ä¹ˆä½¿ç”¨ï¼Ÿ"></a>æ€ä¹ˆä½¿ç”¨ï¼Ÿ</h3><p>æ·»åŠ ä¾èµ–ï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jsx">dependencies &#123;<br>  implementation <span class="hljs-string">&#x27;com.airbnb.android:mavericks:x.y.z&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>åˆå§‹åŒ–ï¼ˆåœ¨ Application onCreate æ—¶åˆå§‹åŒ–ï¼‰ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SampleApplication</span> : <span class="hljs-type">Application</span>() &#123;<br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate()<br>        **Mavericks.initialize(<span class="hljs-keyword">this</span>)**<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs jsx">data <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorldState</span>(val <span class="hljs-attr">title</span>: <span class="hljs-title class_">String</span> = <span class="hljs-string">&quot;Hello World&quot;</span>) : <span class="hljs-title class_">MavericksState</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Refer to the wiki for how to set up your base ViewModel.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorldViewModel</span>(<span class="hljs-attr">initialState</span>: <span class="hljs-title class_">HelloWorldState</span>) : <span class="hljs-title class_">MavericksViewModel</span>&lt;<span class="hljs-title class_">HelloWorldState</span>&gt;(initialState) &#123;<br>    fun <span class="hljs-title function_">getMoreExcited</span>() = setState &#123; <span class="hljs-title function_">copy</span>(title = <span class="hljs-string">&quot;$title!&quot;</span>) &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorldFragment</span> : <span class="hljs-title class_">Fragment</span>(R.<span class="hljs-property">layout</span>.<span class="hljs-property">hello_world_fragment</span>), <span class="hljs-title class_">MavericksView</span> &#123;<br>    private val <span class="hljs-attr">viewModel</span>: <span class="hljs-title class_">HelloWorldViewModel</span> by <span class="hljs-title function_">fragmentViewModel</span>()<br><br>    override fun <span class="hljs-title function_">invalidate</span>() = <span class="hljs-title function_">withState</span>(<span class="hljs-params">viewModel</span>) &#123; state -&gt;<br>        <span class="hljs-comment">// Update your views with the latest state here.</span><br>        <span class="hljs-comment">// This will get called any time your state changes and the viewLifecycleOwner is STARTED.</span><br>    &#125;<br><br>    fun <span class="hljs-title function_">initView</span>(<span class="hljs-params"></span>) &#123;<br>    viewModel.<span class="hljs-title function_">onEach</span>(<span class="hljs-params">HelloWorldState::title</span>) &#123; title -&gt;<br>    <span class="hljs-comment">// Update views</span><br>    text_view.<span class="hljs-property">text</span> = title<br>    &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•°æ®æµçš„æµè½¬è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li>é€šè¿‡ ViewModel æ›´æ–° State</li><li>ViewModel æ¥æ”¶æ•°æ®</li><li>é€šè¿‡ setState æ›´æ–° state</li><li>MavericksState å‘ç”Ÿå˜åŒ–åå›è°ƒ invalidate æ–¹æ³•</li><li>é€šè¿‡ withState è·å– stateï¼Œæ›´æ–° UI</li><li>å¯ä»¥é€šè¿‡ onEach ç›‘å¬ state ä¸­æŸä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§çš„å˜åŒ–ã€‚</li></ol><h3 id="Mavericks-ç»“åˆ-Compose"><a href="#Mavericks-ç»“åˆ-Compose" class="headerlink" title="Mavericks ç»“åˆ Compose"></a>Mavericks ç»“åˆ Compose</h3><figure class="highlight fix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fix"><span class="hljs-attr">ğŸ’¡ Mavericks + Compose =</span>=<span class="hljs-string"> Redux/Mobx + React</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ Compose æ„å»º UIï¼ŒMavericks å¯ç”¨äºä¸šåŠ¡é€»è¾‘ã€æ•°æ®è·å–ã€å¯¹è±¡ä¾èµ–æ³¨å…¥ç­‰ï¼Œæœ‰ç‚¹ç±»ä¼¼äº Redux å’Œ React çš„å…³ç³»ï¼ŒRedux ç”¨äºæ•°æ®ç®¡ç†å’Œä¸šåŠ¡é€»è¾‘ï¼ŒReact ç»„ä»¶è´Ÿè´£æ„å»º UIã€‚</p><p>ç»“åˆ compose ä½¿ç”¨éœ€è¦æ·»åŠ ä¾èµ–ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">implementation <span class="hljs-string">&#x27;com.airbnb.android:mavericks-compose:x.y.z&#x27;</span><br></code></pre></td></tr></table></figure><p>æ–°å»ºçŠ¶æ€ å’Œ ViewModelï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CounterState</span>(<br>    <span class="hljs-keyword">val</span> count: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>,<br>) : MavericksState<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CounterViewModel</span>(initialState: CounterState) : MavericksViewModel&lt;CounterState&gt;(initialState) &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">incrementCount</span><span class="hljs-params">()</span></span> = setState &#123; copy(count = count + <span class="hljs-number">1</span>) &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>åªéœ€è¦åœ¨ Composable å‡½æ•°é‡Œè°ƒç”¨ Â <code>mavericksViewModel()</code>Â  æ¥è·å– ViewModel å®ä¾‹ã€‚å…¶é»˜è®¤å…³è”çš„ LifecycleOwner ä¸º <code>LocalLifecycleOwner</code>ï¼Œæ„å‘³ç€è¯¥ Â <code>LocalLifeyclerOwner</code>Â  ä¸‹çš„æ‰€æœ‰ Composable å°†è·å–åˆ°ç›¸åŒçš„ ViewModel å®ä¾‹ã€‚ä¸€èˆ¬ä¸º å½“å‰ Fragment çš„ LifecycleOwnerã€‚å¦‚æœä½¿ç”¨ mavericksActivityViewModel åˆ™ å½“å‰ ViewModel çš„ LifecycleOwner ä¸º å½“å‰ Fragment æ‰€åœ¨çš„ Activityï¼Œå¯¹äºåŒä¸€ä¸ª Activityï¼ŒmavericksActivityViewModel æ‹¿åˆ°çš„ éƒ½æ˜¯åŒä¸€ä¸ª ViewModel å®ä¾‹ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@Composable</span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">IncrementNavigationCountButton</span><span class="hljs-params">()</span></span> &#123;<br>        <span class="hljs-keyword">val</span> navScopedViewModel: CounterViewModel = mavericksViewModel()<br>        Button(onClick = navScopedViewModel::incrementCount) &#123;<br>            Text(<span class="hljs-string">&quot;Increment Navigation Scoped Count&quot;</span>)<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>è¦è®¢é˜… ViewModel é‡Œçš„çŠ¶æ€å˜åŒ–ï¼ŒMavericks æä¾›äº† Â <code>ViewModel.collectAsState()</code>ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// This will get or create a ViewModel scoped to the closest LocalLifecycleOwner which, in this case, is the NavHost.</span><br><span class="hljs-keyword">val</span> navScopedViewModel: CounterViewModel = mavericksViewModel()<br><span class="hljs-comment">// This will get or create a ViewModel scoped to the Activity.</span><br><span class="hljs-keyword">val</span> activityScopedViewModel: CounterViewModel = mavericksActivityViewModel()<br><br><span class="hljs-keyword">val</span> navScopedCount <span class="hljs-keyword">by</span> navScopedViewModel.collectAsState(CounterState::count)<br><span class="hljs-keyword">val</span> activityScopedCount <span class="hljs-keyword">by</span> activityScopedViewModel.collectAsStateWithLifecycle(CounterState::count)<br></code></pre></td></tr></table></figure><p>é€šè¿‡ å±æ€§å§”æ‰˜çš„æ–¹å¼ ï¼Œè·å–åˆ° State ä¸­çš„çŠ¶æ€å’Œå±æ€§ã€‚è¦ä¼˜åŒ–ä½¿ç”¨ Â <code>collectAsState()</code>ï¼Œä¸åŒ Composable è®¿é—®ä¸åŒçš„çŠ¶æ€å±æ€§ï¼Œåœ¨é‡ç»„æ—¶å€™å¯ä»¥æœ€å¤§é™åº¦åœ°å‡å°‘çŠ¶æ€æ›´æ”¹æ—¶éœ€è¦å®Œæˆçš„å·¥ä½œã€‚å› æ­¤åœ¨ Composable é‡Œè®¢é˜…çŠ¶æ€å±æ€§æ¯”è®¢é˜…æ•´ä¸ªçŠ¶æ€æ›´ç†æƒ³ã€‚</p><h3 id="æ ¸å¿ƒæºç æ¢ç©¶"><a href="#æ ¸å¿ƒæºç æ¢ç©¶" class="headerlink" title="æ ¸å¿ƒæºç æ¢ç©¶"></a>æ ¸å¿ƒæºç æ¢ç©¶</h3><p><strong>æ€ä¹ˆæ£€æŸ¥æ˜¯å¦æ˜¯çº¯å‡½æ•°ï¼Ÿ</strong></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">stateStore.<span class="hljs-keyword">set</span> &#123;<br><span class="hljs-keyword">val</span> firstState = <span class="hljs-keyword">this</span>.reducer()<br><span class="hljs-keyword">val</span> secondState = <span class="hljs-keyword">this</span>.reducer()<br><br><span class="hljs-keyword">if</span> (firstState != secondState) &#123; &#125;<br><br>firstState<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ Mavericks è°ƒè¯•æ¨¡å¼ä¸­ï¼Œå½“è°ƒç”¨ setState æ—¶ï¼Œä¼šå¯¹ reducer å‡½æ•°æ‰§è¡Œä¸¤æ¬¡ï¼Œ è¿›è¡Œçº¯å‡½æ•°æ£€æŸ¥ï¼Œå¦‚æœä¸æ˜¯ çº¯å‡½æ•°ï¼Œ ä¼šæŠ›å‡º IllegalArgumentExceptionï¼ˆä»…è°ƒè¯•æ¨¡å¼ï¼‰ã€‚</p><p><strong>shared flow è¿˜æ˜¯ state flowï¼Ÿ</strong></p><p><strong><code>SharedFlow</code></strong>Â  åœ¨ Mavericks ä¸­è¢«ç”¨æ¥å¤„ç†äº‹ä»¶æµå’ŒçŠ¶æ€æ›´æ–°ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> stateSharedFlow = MutableSharedFlow&lt;S&gt;(<br>        replay = <span class="hljs-number">1</span>,<br>        extraBufferCapacity = SubscriberBufferSize,<br>        onBufferOverflow = BufferOverflow.SUSPEND,<br>).apply &#123; tryEmit(initialState) &#125;<br><br> <span class="hljs-meta">@InternalMavericksApi</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> SubscriberBufferSize = <span class="hljs-number">63</span><br></code></pre></td></tr></table></figure><p><strong><code>replay</code></strong>Â  å‚æ•°æŒ‡å®šäº† Â <strong><code>SharedFlow</code></strong>Â  åº”è¯¥ç¼“å­˜å¤šå°‘ä¸ªæœ€æ–°çš„å€¼ï¼Œå¹¶ä¸”åœ¨æ–°çš„è®¢é˜…è€…å¼€å§‹æ”¶é›†æ—¶é‡æ”¾è¿™äº›å€¼ã€‚è¿™é‡Œè®¾ç½®ä¸º 1ï¼Œ ä»£è¡¨æœ‰æ–°çš„è®¢é˜…è€…æ—¶ï¼Œä¼šç«‹å³å‘é€å½“å‰æœ€æ–°å€¼ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„æ¶ˆæ¯è®¢é˜…æ˜¯ â€œç²˜æ€§çš„â€ã€‚è¿™å‡å°‘äº†è®¢é˜…è€…é”™è¿‡é‡è¦çŠ¶æ€æ›´æ–°çš„é£é™©ã€‚</p><p><strong><code>extraBufferCapacity</code></strong>Â  å‚æ•°æŒ‡å®šäº†é¢å¤–çš„ç¼“å†²åŒºå®¹é‡ã€‚<code>SubscriberBufferSize</code>æ˜¯ä¸€ä¸ªå¸¸é‡å€¼ 63ï¼Œè¡¨ç¤ºé¢å¤–çš„ç¼“å†²åŒºå¤§å°ã€‚è¿™ä¸ªç¼“å†²åŒºç”¨äºå­˜å‚¨åœ¨è®¢é˜…è€…è¿˜æ²¡æœ‰å‡†å¤‡å¥½å¤„ç†æ–°å€¼æ—¶å‘é€çš„å€¼ã€‚è¿™æœ‰åŠ©äºé¿å…ä¸¢å¤±äº‹ä»¶ã€‚æ˜¯ä¸€ä¸ªâ€œèƒŒå‹â€å‚æ•°ï¼ŒèƒŒå‹ï¼ˆBackpressureï¼‰æ˜¯æŒ‡åœ¨å¤„ç†æ•°æ®æµæ—¶ï¼Œæ¶ˆè´¹è€…æ— æ³•è·Ÿä¸Šç”Ÿäº§è€…çš„é€Ÿåº¦ï¼Œä»è€Œå¯¼è‡´æ•°æ®ç§¯å‹çš„é—®é¢˜ã€‚å½“æœ‰æ…¢é€Ÿæ¶ˆè´¹è€…æ—¶ï¼Œè¿™é‡Œä¼šä¸ºå…¶ç¼“å­˜çŠ¶æ€ã€‚</p><p><strong><code>BufferOverflow.SUSPEND</code></strong>Â  è¡¨ç¤ºå½“ç¼“å†²åŒºå·²æ»¡æ—¶ï¼Œæ–°çš„å€¼å°†ä¼šè¢«æŒ‚èµ·ï¼Œç›´åˆ°æœ‰ç©ºé—´å¯ç”¨ã€‚è¿™ç¡®ä¿äº†ä¸ä¼šä¸¢å¤±ä»»ä½•äº‹ä»¶ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´å‘é€æ–¹æŒ‚èµ·ï¼Œç›´åˆ°ç¼“å†²åŒºæœ‰ç©ºé—´ã€‚</p><p>sharedFlow å’Œ StateFlow æ¯”è¾ƒï¼š</p><p>StateFlow å°±æ˜¯ä¸€ä¸ª replaySize&#x3D;1 çš„ sharedFlowã€‚åŒæ—¶å®ƒå¿…é¡»æœ‰ä¸€ä¸ªåˆå§‹å€¼ï¼Œæ­¤å¤–ï¼Œæ¯æ¬¡æ›´æ–°æ•°æ®éƒ½ä¼šå’Œæ—§æ•°æ®åšä¸€æ¬¡æ¯”è¾ƒï¼Œåªæœ‰ä¸åŒæ—¶å€™æ‰ä¼šæ›´æ–°æ•°å€¼ã€‚</p><p>StateFlow<strong>é‡ç‚¹åœ¨çŠ¶æ€</strong>ï¼Œui æ°¸è¿œæœ‰çŠ¶æ€ï¼Œæ‰€ä»¥ StateFlow å¿…é¡»æœ‰åˆå§‹å€¼ï¼ŒåŒæ—¶å¯¹ ui è€Œè¨€ï¼Œè¿‡æœŸçš„çŠ¶æ€æ¯«æ— æ„ä¹‰ï¼Œæ‰€ä»¥ stateFLow æ°¸è¿œæ›´æ–°æœ€æ–°çš„æ•°æ®ï¼ˆå’Œ liveData ç›¸ä¼¼ï¼‰ï¼Œæ‰€ä»¥å¿…é¡»æœ‰ç²˜æ»åº¦&#x3D;1 çš„ç²˜æ»äº‹ä»¶ï¼Œè®© ui çŠ¶æ€ä¿æŒåˆ°æœ€æ–°ã€‚</p><p>SharedFlow<strong>ä¾§é‡åœ¨äº‹ä»¶</strong>ï¼Œå½“æŸä¸ªäº‹ä»¶è§¦å‘ï¼Œå‘é€åˆ°é˜Ÿåˆ—ä¹‹ä¸­ï¼ŒæŒ‰ç…§æŒ‚èµ·æˆ–è€…éæŒ‚èµ·ã€ç¼“å­˜ç­–ç•¥ç­‰å°†äº‹ä»¶å‘é€åˆ°æ¥å—æ–¹ï¼Œåœ¨å…·ä½“ä½¿ç”¨æ—¶ï¼ŒSharedFlow æ›´é€‚åˆé€šçŸ¥ ui ç•Œé¢çš„ä¸€äº›äº‹ä»¶ï¼Œæ¯”å¦‚ toast ç­‰ï¼Œä¹Ÿé€‚åˆä½œä¸º viewModel å’Œ repository ä¹‹é—´çš„æ¡¥æ¢ç”¨ä½œæ•°æ®çš„ä¼ è¾“ã€‚</p><p>ç»“è®ºï¼š</p><p>è¿™é‡Œ Mavericks ä½¿ç”¨ SharedFlow æ¥ å®ç°ä¸€ä¸ª StateFlow ç”¨äº State çŠ¶æ€çš„ ä¿å­˜å’Œæ›´æ–°ã€‚</p><p><strong>withstate å’Œ setstate æ€ä¹ˆä¿è¯æ—¶åºï¼Ÿ</strong></p><p>ğŸ’¡ viewModel ä¸­çš„ withState å’Œ View ä¸­çš„ withState åŒºåˆ«ï¼š</p><p>viewModel ä¸­çš„ withState æ˜¯ å¼‚æ­¥çš„ blockï¼Œé€šè¿‡ è¿™ä¸ª withState æ‹¿åˆ°çš„çŠ¶æ€å¯ä»¥ä¿è¯æ˜¯æœ€æ–°çš„çŠ¶æ€ã€‚View ä¸­çš„ withState æ˜¯ åŒæ­¥çš„ blockï¼Œç›´æ¥æ‰§è¡Œ View ä¸­çš„ withState è·å–åˆ°çš„çŠ¶æ€ä¸èƒ½ä¿è¯æ˜¯æœ€æ–°çš„ state çŠ¶æ€ã€‚</p><p>æˆ‘ä»¬åº”è¯¥å°½é‡åœ¨ invalidate æˆ–è€… onEachã€onAsync ç¯å¢ƒä¸­è°ƒç”¨ View ä¸­çš„ withStateã€‚<br>å› ä¸ºè¿™ä¸‰ä¸ªæ–¹æ³•éƒ½æ˜¯åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œå®Œ state çš„å˜æ›´åå›è°ƒåˆ°ä¸»çº¿ç¨‹çš„ï¼Œæ‰€ä»¥è¿™é‡Œè°ƒ withState è·å–åˆ°çš„è‚¯å®šæ˜¯æœ€æ–°çš„çŠ¶æ€ã€‚</p><p>withState é˜Ÿåˆ— ä¸ setState é˜Ÿåˆ—</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> setStateChannel = Channel&lt;S.() -&gt; S&gt;(capacity = Channel.UNLIMITED)<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> withStateChannel = Channel&lt;(S) -&gt; <span class="hljs-built_in">Unit</span>&gt;(capacity = Channel.UNLIMITED)<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">flushQueuesOnce</span><span class="hljs-params">()</span></span> &#123;<br>        select&lt;<span class="hljs-built_in">Unit</span>&gt; &#123;<br>            setStateChannel.onReceive &#123; reducer -&gt;<br>                <span class="hljs-keyword">val</span> newState = state.reducer()<br>                <span class="hljs-keyword">if</span> (newState != state) &#123;<br>                    state = newState<br>                    stateSharedFlow.emit(newState)<br>                &#125;<br>            &#125;<br>            withStateChannel.onReceive &#123; block -&gt;<br>                block(state)<br>            &#125;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p><strong><code>select</code></strong>Â  æ˜¯ä¸€ä¸ª Kotlin åç¨‹ä¸­çš„å¤šè·¯å¤ç”¨é€‰æ‹©å™¨ï¼Œå®ƒå…è®¸åœ¨å¤šä¸ªæŒ‚èµ·å‡½æ•°ä¸­é€‰æ‹©ä¸€ä¸ªé¦–å…ˆå®Œæˆçš„å‡½æ•°ã€‚å®ƒçš„ä½œç”¨ç±»ä¼¼äº Â <strong><code>select</code></strong>Â  è¯­å¥åœ¨ Go è¯­è¨€ä¸­çš„ä½œç”¨ã€‚</p><p>è¿™æ ·ä¿è¯äº†æ‰€æœ‰<strong>å¾…å¤„ç†</strong>çš„ Â <strong><code>setState</code></strong>Â reducer å°†åœ¨æ¯ä¸€ä¸ª Â <strong><code>withState</code></strong>Â lambda ä¹‹å‰è¿è¡Œã€‚</p><p>å‡è®¾ä½ æœ‰ä»¥ä¸‹ä¸¤ä¸ªæ“ä½œï¼š</p><ol><li><strong><code>setState &#123; ... &#125;</code></strong></li><li><strong><code>withState &#123; ... &#125;</code></strong></li></ol><p>åœ¨è°ƒç”¨ Â <code>flushQueuesOnce</code>Â  ä¹‹å‰ï¼Œ<code>setState</code>Â  æ“ä½œä¼šè¢«æ”¾å…¥ Â <code>setStateChannel</code>Â  ä¸­ï¼Œè€Œ Â <code>withState</code>Â  æ“ä½œä¼šè¢«æ”¾å…¥ Â <code>withStateChannel</code>Â  ä¸­ã€‚<code>flushQueuesOnce</code>Â  å‡½æ•°ä¼šç¡®ä¿é¦–å…ˆå¤„ç† Â <code>setStateChannel</code>Â  ä¸­çš„æ‰€æœ‰æ¶ˆæ¯ï¼Œç„¶åå†å¤„ç† Â <code>withStateChannel</code>Â  ä¸­çš„æ¶ˆæ¯ã€‚è¿™ç¡®ä¿äº†åœ¨ Â <code>withState</code>Â  æ“ä½œæ‰§è¡Œæ—¶ï¼ŒçŠ¶æ€å·²ç»æ˜¯æœ€æ–°çš„ã€‚</p><p><strong>invalidate æ•ˆç‡é—®é¢˜æ¢ç©¶</strong></p><p>é¦–å…ˆ<code>invalidate</code>çš„æ€è·¯æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œå®ƒå’Œ React ä¸­çš„<code>render</code>æ˜¯ä¿æŒä¸€è‡´çš„ï¼Œä½†æ˜¯ React ä¸­æ˜¯æœ‰ Virtual Dom çš„ diff ç®—æ³•æ¥ç¡®å®šå“ªäº›èŠ‚ç‚¹éœ€è¦çœŸæ­£æ›´æ–°çš„ï¼Œå¦‚æœæ²¡æœ‰è¿™æ ·çš„æœºåˆ¶ï¼Œå°±ä¼šé€ æˆæ•ˆç‡é—®é¢˜ã€‚</p><p>åœ¨å•çº¯ Mavericks ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨<code>invalidate()</code>å—ï¼Ÿ</p><p>æˆ‘è®¤ä¸ºæ˜¯ä¸åº”è¯¥çš„ï¼Œå› ä¸º Mavericks æ²¡æœ‰è¿™æ ·çš„ diff æœºåˆ¶æ¥ä¿è¯å±€éƒ¨åˆ·æ–°ï¼ˆå¯ä»¥é€šè¿‡ Airbnb çš„ å¦ä¸€ä¸ªæ¡†æ¶ Epoxy å€ŸåŠ© Recyclerview å®ç°çš„ diff æœºåˆ¶æ¥ä¿è¯å±€éƒ¨åˆ·æ–°ï¼Œä½†æ˜¯è¿™åˆæ˜¯å¦ä¸€å›äº‹äº†ï¼Œåœ¨æœ‰äº† Compose ä¹‹åï¼ŒEpoxy å°±æ˜¾å¾—æœ‰ç‚¹é¸¡è‚‹äº†ï¼‰ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨å•çº¯ Mavericks ç¯å¢ƒä¸‹åº”è¯¥å°½é‡ä½¿ç”¨<code>onEach</code>æ¥å¯¹æŒ‡å®šçš„å±æ€§è¿›è¡Œç›‘å¬å’Œè®¢é˜…ã€‚</p><h3 id="State-ä¸­ä¾¿æ·æ›´æ–°-List-Map-çš„æ‰©å±•æ–¹æ³•"><a href="#State-ä¸­ä¾¿æ·æ›´æ–°-List-Map-çš„æ‰©å±•æ–¹æ³•" class="headerlink" title="State ä¸­ä¾¿æ·æ›´æ–° List&#x2F;Map çš„æ‰©å±•æ–¹æ³•"></a>State ä¸­ä¾¿æ·æ›´æ–° List&#x2F;Map çš„æ‰©å±•æ–¹æ³•</h3><p>listï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// å¢åˆ </span><br>setState &#123; copy(list = list - newList) &#125;<br>setState &#123; copy(list = list + newList) &#125;<br><span class="hljs-comment">// ä¿®æ”¹</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> List<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">update</span><span class="hljs-params">(newValue: (<span class="hljs-type">T</span>) -&gt; <span class="hljs-type">T</span>, finder: (<span class="hljs-type">T</span>) -&gt; <span class="hljs-type">Boolean</span>)</span></span> =<br>    indexOfFirst(finder).let &#123; index -&gt;<br>        <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) copy(index, newValue(<span class="hljs-keyword">get</span>(index))) <span class="hljs-keyword">else</span> <span class="hljs-keyword">this</span><br>    &#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> List<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">copy</span><span class="hljs-params">(i: <span class="hljs-type">Int</span>, value: <span class="hljs-type">T</span>)</span></span>: List&lt;T&gt; = toMutableList().apply &#123; <span class="hljs-keyword">set</span>(i, value) &#125;<br><br>setState &#123; copy(list = list.update(&#123; it.copy(checked = <span class="hljs-literal">true</span>) &#125;, &#123; it.id == id &#125;)) &#125;<br></code></pre></td></tr></table></figure><p>map:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// ä¿®æ”¹</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;K, V&gt;</span> Map<span class="hljs-type">&lt;K, V&gt;</span>.<span class="hljs-title">copy</span><span class="hljs-params">(<span class="hljs-keyword">vararg</span> pairs: <span class="hljs-type">Pair</span>&lt;<span class="hljs-type">K</span>, V&gt;)</span></span> =<br>    HashMap&lt;K, V&gt;(size + pairs.size).apply &#123;<br>        putAll(<span class="hljs-keyword">this</span><span class="hljs-symbol">@copy</span>)<br>        pairs.forEach &#123; put(it.first, it.second) &#125;<br>    &#125;<br><br><span class="hljs-comment">// åˆ é™¤</span><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;K, V&gt;</span> Map<span class="hljs-type">&lt;K, V&gt;</span>.<span class="hljs-title">delete</span><span class="hljs-params">(<span class="hljs-keyword">vararg</span> keys: <span class="hljs-type">K</span>)</span></span> =<br>    HashMap&lt;K, V&gt;(size - keys.size).apply &#123;<br>        <span class="hljs-keyword">this</span><span class="hljs-symbol">@delete</span>.entries.asSequence()<br>            .filter &#123; it.key !<span class="hljs-keyword">in</span> keys &#125;<br>            .forEach &#123; put(it.key, it.value) &#125;<br>        &#125;<br></code></pre></td></tr></table></figure><h3 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h3><p><a href="https://airbnb.io/mavericks/#/">Mavericks Docs (airbnb.io)</a></p><p><a href="https://juejin.cn/post/7077226398854676493">Mavericks Meet Jetpack Compose - æ˜é‡‘ (juejin.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Android å¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Mavericks</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>QuickAnimate DSL</title>
    <link href="/2024/07/13/QuickAnimate-DSL/"/>
    <url>/2024/07/13/QuickAnimate-DSL/</url>
    
    <content type="html"><![CDATA[<p>ä¸€å¥è¯æè¿°ï¼š</p><p>ä½¿ç”¨ Kotlin DSL ï¼ˆDomain-Specific Languageï¼Œé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰å’Œ ValueAnimator å®ç°ä¸€ä¸ªåŠ¨ç”»æ¡†æ¶ï¼Œä»¥ DSL çš„æ–¹å¼æ¥æ–¹ä¾¿ã€å¿«é€Ÿçš„å®ç°å¯¹ view çš„å„ç§å±æ€§åŠ¨ç”»ã€‚</p><p>é€šè¿‡ Kotlin DSL çš„æ–¹å¼æ¥ç»„åˆé’ˆå¯¹ view çš„å¤šä¸ªå±æ€§çš„åŠ¨ç”»ï¼Œç”¨äºå¿«é€Ÿã€ç®€å•çš„å®ç°å¤æ‚çš„ç»„åˆåŠ¨ç”»æ•ˆæœã€‚ç®€å•åˆå¥½ç”¨â€”â€”ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">animateTest</span><span class="hljs-params">(view: <span class="hljs-type">View</span>)</span></span> &#123;<br>    <span class="hljs-keyword">val</span> controller: Animators.Controller = quickAnimate &#123;<br>        together &#123;<br>            play &#123;<br>                targets = listOf(view)<br>                duration = <span class="hljs-number">300L</span><br>                interpolator = LinearInterpolator()<br>                translationX(<span class="hljs-number">0f</span>, <span class="hljs-number">100f</span>)<br>            &#125;<br>            play &#123;<br>                targets = listOf(view)<br>                duration = <span class="hljs-number">300L</span><br>                interpolator = LinearInterpolator()<br>                translationY(<span class="hljs-number">0f</span>, <span class="hljs-number">100f</span>)<br>            &#125;<br>        &#125;<br>        onStart = &#123;&#125;<br>        onEnd = &#123;&#125;<br>    &#125;<br>    <span class="hljs-comment">// å¼€å§‹åŠ¨ç”»</span><br>    controller.start()<br>&#125;<br></code></pre></td></tr></table></figure><p>Animators ç±»ï¼š quickAnimate { } ä»£ç å—ä¸­çš„ receiver å®ç°ç±»ã€‚é€šè¿‡ å°è£… Controller çš„æ–¹å¼å¯¹å¤–æä¾›æ§åˆ¶åŠ¨ç”»çš„æ¥å£ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">quickAnimate</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Animators</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span>: Animators.Controller<br></code></pre></td></tr></table></figure><p>SingleAnimator ç±»ï¼š å…·ä½“çš„ åŠ¨ç”»åŠ¨ä½œ  å°è£…ç±» ï¼Œä¹Ÿå°±æ˜¯ play { } ä»£ç å—ä¸­çš„receiver å®ç°ç±»ã€‚è´Ÿè´£å®Œæˆå•ä¸ªå±æ€§åŠ¨ç”»ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">play</span><span class="hljs-params">(anim: <span class="hljs-type">SingleAnimator</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span><br></code></pre></td></tr></table></figure><p>åŒæ—¶ä¹Ÿæ”¯æŒå¤šä¸ªåŠ¨ç”»çš„ç»„åˆåŠ¨ç”»ï¼Œé€šè¿‡ together åŒ…è£¹çš„ åŠ¨ç”»ä¼šåŒæ—¶æ‰§è¡Œã€‚å¦åˆ™ï¼Œé»˜è®¤æ‰€æœ‰åŠ¨ç”»éƒ½æ˜¯ ä¸²è¡Œæ‰§è¡Œã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">together</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Animators</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span><br></code></pre></td></tr></table></figure><p>æœ€åï¼Œæä¾›ä¸€ä¸ªæ§åˆ¶ç±» Animators.Controller ï¼Œç”¨äº æ§åˆ¶ åŠ¨ç”»çš„ å¼€å§‹ ã€å–æ¶ˆï¼Œæš‚åœ ç­‰æ“ä½œã€‚</p><p>API æ¥å£è®¾è®¡å¦‚ä¸‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">quickAnimate</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Animators</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span>: Animators.Controller<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animators</span> &#123;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Controller</span> &#123;<br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">start</span><span class="hljs-params">()</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">cancel</span><span class="hljs-params">()</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">pause</span><span class="hljs-params">()</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">resume</span><span class="hljs-params">()</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isRunning</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">play</span><span class="hljs-params">(anim: <span class="hljs-type">SingleAnimator</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">together</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Animators</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SingleAnimator</span> &#123;<br><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹äº å…·ä½“çš„View çš„å±æ€§åŠ¨ç”»ï¼Œä¸»è¦åˆ©ç”¨ä»¥ä¸‹API æ¥å®ç°ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">public</span> static &lt;T&gt; ObjectAnimator ofFloat(T target, Property&lt;T, <span class="hljs-built_in">Float</span>&gt; property, float... values)<br></code></pre></td></tr></table></figure><p><code>ObjectAnimator</code> æ˜¯ Android åŠ¨ç”»æ¡†æ¶ä¸­çš„ä¸€ä¸ªç±»ï¼Œä¸“é—¨ç”¨äºæ‰§è¡Œå±æ€§åŠ¨ç”»ã€‚<code>ObjectAnimator</code> å¯ä»¥å¯¹ç›®æ ‡å¯¹è±¡çš„æŸä¸ªå±æ€§æ‰§è¡ŒåŠ¨ç”»ï¼Œä¾‹å¦‚é€æ˜åº¦ã€æ—‹è½¬è§’åº¦ã€ä½ç½®ç­‰ã€‚</p><p><strong><code>Property&lt;T, Float&gt; property</code></strong>: ç›®æ ‡å¯¹è±¡çš„å±æ€§ã€‚<code>Property</code> æ˜¯ä¸€ä¸ªå±æ€§çš„æŠ½è±¡è¡¨ç¤ºï¼Œè¿™é‡Œå¯ä»¥ä¼ å…¥ä»¥ä¸‹å±æ€§ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">View.ALPHA<br>View.ROTATION<br>View.TRANSLATION_X<br>View.TRANSLATION_Y<br>......<br></code></pre></td></tr></table></figure><p><strong><code>float... values</code></strong>:  åŠ¨ç”»çš„å…³é”®å¸§å€¼åºåˆ—ã€‚å¯ä»¥ä¼ å…¥å¤šä¸ªå€¼ï¼ŒåŠ¨ç”»å°†ä¾æ¬¡åœ¨è¿™äº›å€¼ä¹‹é—´è¿›è¡Œæ’å€¼ã€‚</p><p>å¯¹äºå•ä¸ªåŠ¨ç”»ï¼Œå¯ä»¥æä¾›ä»¥ä¸‹é…ç½®å±æ€§ï¼Œç”¨äºé…ç½®åŠ¨ç”»çš„ viewå¯¹è±¡ã€åŠ¨ç”»æ—¶é•¿ã€æ’å€¼å™¨ã€repeatMode ç­‰å‚æ•°ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">var</span> duration: <span class="hljs-built_in">Long</span> = <span class="hljs-number">0L</span><br><span class="hljs-keyword">var</span> targets: List&lt;View?&gt; = emptyList()<br><span class="hljs-keyword">var</span> interpolator: TimeInterpolator? = <span class="hljs-literal">null</span><br><span class="hljs-keyword">var</span> repeatMode: <span class="hljs-built_in">Int</span> = ValueAnimator.RESTART<br><span class="hljs-keyword">var</span> repeatCount: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>å•ä¸ªåŠ¨ç”»ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">play &#123;<br>targets = listOf(view)<br>duration = <span class="hljs-number">300L</span><br>interpolator = LinearInterpolator()<br>repeatMode = ValueAnimator.RESTART<br>repeatCount = <span class="hljs-number">0</span><br>translationY(<span class="hljs-number">0f</span>, <span class="hljs-number">100f</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼šè¿™é‡Œåªæ˜¯å®Œæˆäº†åŠ¨ç”»çš„é…ç½®ï¼Œå¹¶æ²¡æœ‰çœŸæ­£å¼€å§‹åŠ¨ç”»ï¼Œéœ€è¦é€šè¿‡ Animators.Controller æ¥ç»Ÿä¸€æ¥æ§åˆ¶åŠ¨ç”»çš„ å¼€å§‹ ã€æš‚åœã€ç»§ç»­ã€å–æ¶ˆç­‰ã€‚</p><p>å®Œæ•´æºç ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.example.helloworld<br><br><span class="hljs-keyword">import</span> android.animation.*<br><span class="hljs-keyword">import</span> android.util.Log<br><span class="hljs-keyword">import</span> android.util.Property<br><span class="hljs-keyword">import</span> android.view.View<br><span class="hljs-keyword">import</span> android.view.animation.LinearInterpolator<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">quickAnimate</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Animators</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span>: Animators.Controller &#123;<br>    <span class="hljs-keyword">val</span> animators = Animators().apply(<span class="hljs-keyword">init</span>)<br>    <span class="hljs-keyword">val</span> animSet = AnimatorSet()<br>    animSet.addListener(<span class="hljs-keyword">object</span> : Animator.AnimatorListener &#123;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onAnimationStart</span><span class="hljs-params">(animation: <span class="hljs-type">Animator</span>?)</span></span> &#123;<br>            animators.onStart?.invoke()<br>        &#125;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onAnimationEnd</span><span class="hljs-params">(animation: <span class="hljs-type">Animator</span>?)</span></span> &#123;<br>            animators.onEnd?.invoke()<br>        &#125;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onAnimationCancel</span><span class="hljs-params">(animation: <span class="hljs-type">Animator</span>?)</span></span> &#123;<br>        &#125;<br>        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onAnimationRepeat</span><span class="hljs-params">(animation: <span class="hljs-type">Animator</span>?)</span></span> &#123;<br>        &#125;<br>    &#125;)<br>    Log.i(<span class="hljs-string">&quot;xcc&quot;</span>, <span class="hljs-string">&quot;quick anim: <span class="hljs-subst">$&#123;animators.getAnimatorList()&#125;</span>&quot;</span>)<br>    animSet.playSequentially(animators.getAnimatorList())<br>    <span class="hljs-keyword">return</span> Animators.Controller(animSet)<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animators</span> &#123;<br><br>    <span class="hljs-keyword">var</span> onStart: (() -&gt; <span class="hljs-built_in">Unit</span>)? = <span class="hljs-literal">null</span><br><br>    <span class="hljs-keyword">var</span> onEnd: (() -&gt; <span class="hljs-built_in">Unit</span>)? = <span class="hljs-literal">null</span><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> anims: MutableList&lt;Animator&gt; = mutableListOf()<br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getAnimatorList</span><span class="hljs-params">()</span></span> = anims.toList()<br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">play</span><span class="hljs-params">(anim: <span class="hljs-type">SingleAnimator</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> &#123;<br>        <span class="hljs-keyword">val</span> animator = SingleAnimator().apply(anim).createAnimator()<br>        Log.i(<span class="hljs-string">&quot;xcc&quot;</span>, <span class="hljs-string">&quot;add anim: <span class="hljs-variable">$animator</span>&quot;</span>)<br>        anims.add(animator)<br><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">together</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Animators</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> &#123;<br>        <span class="hljs-keyword">val</span> animSet = Animators().apply(<span class="hljs-keyword">init</span>).createAnimator()<br>        Log.i(<span class="hljs-string">&quot;xcc&quot;</span>, <span class="hljs-string">&quot;add animSet: <span class="hljs-variable">$animSet</span>&quot;</span>)<br>        anims.add(animSet)<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createAnimator</span><span class="hljs-params">()</span></span>: Animator &#123;<br>        <span class="hljs-keyword">val</span> animSet = AnimatorSet()<br>        animSet.addListener(<span class="hljs-keyword">object</span> : Animator.AnimatorListener &#123;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onAnimationStart</span><span class="hljs-params">(animation: <span class="hljs-type">Animator</span>?)</span></span> &#123;<br>                onStart?.invoke()<br>            &#125;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onAnimationEnd</span><span class="hljs-params">(animation: <span class="hljs-type">Animator</span>?)</span></span> &#123;<br>                onEnd?.invoke()<br>            &#125;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onAnimationCancel</span><span class="hljs-params">(animation: <span class="hljs-type">Animator</span>?)</span></span> &#123;<br>            &#125;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onAnimationRepeat</span><span class="hljs-params">(animation: <span class="hljs-type">Animator</span>?)</span></span> &#123;<br>            &#125;<br>        &#125;)<br>        animSet.playTogether(anims.toList())<br>        <span class="hljs-keyword">return</span> animSet<br>    &#125;<br><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Controller</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> animator: Animator) &#123;<br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">start</span><span class="hljs-params">()</span></span> &#123;<br>            animator.start()<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">cancel</span><span class="hljs-params">()</span></span>&#123;<br>            animator.cancel()<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">pause</span><span class="hljs-params">()</span></span> &#123;<br>            animator.pause()<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">resume</span><span class="hljs-params">()</span></span> &#123;<br>            animator.resume()<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isRunning</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>            <span class="hljs-keyword">return</span> animator.isRunning<br>        &#125;<br><br>    &#125;<br><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">SingleAnimator</span> &#123;<br><br>        <span class="hljs-keyword">var</span> duration: <span class="hljs-built_in">Long</span> = <span class="hljs-number">0L</span><br>        <span class="hljs-keyword">var</span> targets: List&lt;View?&gt; = emptyList()<br>        <span class="hljs-keyword">var</span> interpolator: TimeInterpolator? = <span class="hljs-literal">null</span><br>        <span class="hljs-keyword">var</span> repeatMode: <span class="hljs-built_in">Int</span> = ValueAnimator.RESTART<br>        <span class="hljs-keyword">var</span> repeatCount: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span><br><br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> animList: MutableList&lt;Animator&gt; = mutableListOf()<br><br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createAnimator</span><span class="hljs-params">()</span></span>: Animator &#123;<br>            <span class="hljs-keyword">val</span> animSet = AnimatorSet()<br>            animSet.duration = <span class="hljs-keyword">this</span>.duration<br>            animSet.interpolator = <span class="hljs-keyword">this</span>.interpolator<br>            animSet.playSequentially(animList.toList())<br>            <span class="hljs-keyword">return</span> animSet<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">translationY</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">            <span class="hljs-keyword">vararg</span> values: <span class="hljs-type">Float</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">            onUpdate: ((<span class="hljs-type">animation</span>: <span class="hljs-type">ValueAnimator</span>) -&gt; <span class="hljs-type">Unit</span>)? = <span class="hljs-literal">null</span></span></span><br><span class="hljs-params"><span class="hljs-function">        )</span></span> &#123;<br>            anim(property = View.TRANSLATION_Y, values = values, onUpdate = onUpdate)<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">translationX</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">            <span class="hljs-keyword">vararg</span> values: <span class="hljs-type">Float</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">            onUpdate: ((<span class="hljs-type">animation</span>: <span class="hljs-type">ValueAnimator</span>) -&gt; <span class="hljs-type">Unit</span>)? = <span class="hljs-literal">null</span></span></span><br><span class="hljs-params"><span class="hljs-function">        )</span></span> &#123;<br>            anim(property = View.TRANSLATION_X, values = values, onUpdate = onUpdate)<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">alpha</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">            <span class="hljs-keyword">vararg</span> values: <span class="hljs-type">Float</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">            onUpdate: ((<span class="hljs-type">animation</span>: <span class="hljs-type">ValueAnimator</span>) -&gt; <span class="hljs-type">Unit</span>)? = <span class="hljs-literal">null</span></span></span><br><span class="hljs-params"><span class="hljs-function">        )</span></span> &#123;<br>            anim(property = View.ALPHA, values = values, onUpdate = onUpdate)<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">rotate</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">            <span class="hljs-keyword">vararg</span> values: <span class="hljs-type">Float</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">            onUpdate: ((<span class="hljs-type">animation</span>: <span class="hljs-type">ValueAnimator</span>) -&gt; <span class="hljs-type">Unit</span>)? = <span class="hljs-literal">null</span></span></span><br><span class="hljs-params"><span class="hljs-function">        )</span></span> &#123;<br>            anim(property = View.ROTATION, values = values, onUpdate = onUpdate)<br>        &#125;<br><br>        <span class="hljs-comment">// add more view property here...</span><br><br>        <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">anim</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">            property: <span class="hljs-type">Property</span>&lt;<span class="hljs-type">View</span>, <span class="hljs-built_in">Float</span>&gt;,</span></span><br><span class="hljs-params"><span class="hljs-function">            <span class="hljs-keyword">vararg</span> values: <span class="hljs-type">Float</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">            onUpdate: ((<span class="hljs-type">animation</span>: <span class="hljs-type">ValueAnimator</span>) -&gt; <span class="hljs-type">Unit</span>)? = <span class="hljs-literal">null</span></span></span><br><span class="hljs-params"><span class="hljs-function">        )</span></span> &#123;<br>            targets.forEach &#123;<br>                <span class="hljs-keyword">if</span> (it == <span class="hljs-literal">null</span>) &#123;<br>                    <span class="hljs-keyword">return</span><span class="hljs-symbol">@forEach</span><br>                &#125;<br>                <span class="hljs-keyword">val</span> anim = ObjectAnimator.ofFloat(it, property, *values)<br>                anim.addUpdateListener &#123; animation -&gt;<br>                    onUpdate?.invoke(animation)<br>                &#125;<br>                anim.duration = <span class="hljs-keyword">this</span>.duration<br>                anim.interpolator = <span class="hljs-keyword">this</span>.interpolator<br>                anim.repeatMode = <span class="hljs-keyword">this</span>.repeatMode<br>                anim.repeatCount = <span class="hljs-keyword">this</span>.repeatCount<br>                animList.add(anim)<br>            &#125;<br>        &#125;<br><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> controller: Animators.Controller? = <span class="hljs-literal">null</span><br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">animateTest</span><span class="hljs-params">(view: <span class="hljs-type">View</span>)</span></span> &#123;<br>    controller = quickAnimate &#123;<br>        together &#123;<br>            play &#123;<br>                targets = listOf(view)<br>                duration = <span class="hljs-number">300L</span><br>                interpolator = LinearInterpolator()<br>                translationX(view.translationX, view.translationX + <span class="hljs-number">100f</span>)<br>            &#125;<br>            play &#123;<br>                targets = listOf(view)<br>                duration = <span class="hljs-number">300L</span><br>                interpolator = LinearInterpolator()<br>                translationY(view.translationY, view.translationY + <span class="hljs-number">100f</span>) &#123;<br>                    Log.i(<span class="hljs-string">&quot;xcc&quot;</span>, <span class="hljs-string">&quot;on update: <span class="hljs-subst">$&#123;it.animatedValue&#125;</span>&quot;</span>)<br>                &#125;<br>            &#125;<br>        &#125;<br>        play &#123;<br>            targets = listOf(view)<br>            duration = <span class="hljs-number">300L</span><br>            interpolator = LinearInterpolator()<br>            alpha(<span class="hljs-number">0f</span>, <span class="hljs-number">1f</span>)<br>        &#125;<br>        play &#123;<br>            targets = listOf(view)<br>            duration = <span class="hljs-number">300L</span><br>            interpolator = LinearInterpolator()<br>            rotate(<span class="hljs-number">0f</span>, <span class="hljs-number">360f</span>)<br>        &#125;<br>        onStart = &#123;<br>            Log.i(<span class="hljs-string">&quot;xcc&quot;</span>, <span class="hljs-string">&quot;onStart&quot;</span>)<br>        &#125;<br>        onEnd = &#123;<br>            Log.i(<span class="hljs-string">&quot;xcc&quot;</span>, <span class="hljs-string">&quot;onEnd&quot;</span>)<br>        &#125;<br>    &#125;<br>    controller?.start()<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Android å¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android æ„å»ºæµç¨‹ï¼ˆç¬”è®°æµï¼‰</title>
    <link href="/2024/07/06/Android-%E6%9E%84%E5%BB%BA%E6%B5%81%E7%A8%8B%EF%BC%88%E7%AC%94%E8%AE%B0%E6%B5%81%EF%BC%89/"/>
    <url>/2024/07/06/Android-%E6%9E%84%E5%BB%BA%E6%B5%81%E7%A8%8B%EF%BC%88%E7%AC%94%E8%AE%B0%E6%B5%81%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<p>Androidçš„Apkæ„å»ºæµç¨‹ä¸»è¦åŒ…æ‹¬èµ„æºçš„ç¼–è¯‘å’Œä»£ç çš„ç¼–è¯‘ã€‚æ¢³ç†æ¸…æ¥šæ‰“åŒ…æ„å»ºè¿‡ç¨‹èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬ç†è§£ä¸ºä»€ä¹ˆç¼–è¯‘è€—æ—¶ä¹…ä»¥åŠå¦‚ä½•å»ä¼˜åŒ–ã€‚æˆ‘ä»¬å¯ä»¥ä»ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢å»ç†è§£Androidçš„Apkæ‰“åŒ…æ„å»ºçš„è¿‡ç¨‹ï¼š</p><ul><li>Apkæ„å»ºæ­¥éª¤</li><li>Apkè‡ªåŠ¨åŒ–æ„å»ºä¸­çš„Gradle Task</li></ul><h3 id="Apkæ„å»ºæ­¥éª¤"><a href="#Apkæ„å»ºæ­¥éª¤" class="headerlink" title="Apkæ„å»ºæ­¥éª¤"></a>Apkæ„å»ºæ­¥éª¤</h3><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202407062110151.png" alt="APKæ„å»º"></p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202407062111331.png" alt="APKæ‰“åŒ…æµç¨‹"></p><p>Apkçš„æ„å»ºä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ol><li>èµ„æºæ–‡ä»¶çš„ç¼–è¯‘ï¼ŒåŒ…æ‹¬é€šè¿‡aaptå·¥å…·ç¼–è¯‘ï¼ˆAndroidManifest.xmlï¼Œresï¼‰ç­‰èµ„æºï¼Œé€šè¿‡AIDLå·¥å…·å¤„ç†AIDLæ–‡ä»¶ç”ŸæˆJavaæ–‡ä»¶ã€‚</li><li>Java &amp; kotlin æºä»£ç ç¼–è¯‘ã€‚</li><li>ä»£ç æ··æ·†ï¼Œä»¥åŠåˆ©ç”¨dex å·¥å…·å°† class æ–‡ä»¶ç¼–è¯‘ä¸º dex æ–‡ä»¶ã€‚</li><li>é€šè¿‡ apkbuilder &#x2F; zipflinger ç”Ÿæˆ apkæ–‡ä»¶ã€‚</li><li>ä½¿ç”¨zipalign å¯¹é½ï¼Œæå‡ mmap è®¿é—®apkæ–‡ä»¶çš„é€Ÿåº¦ã€‚</li><li>åˆ©ç”¨ apksigner å¯¹apkæ–‡ä»¶è¿›è¡Œç­¾åã€‚</li></ol><p><strong>èµ„æºæ–‡ä»¶çš„ç¼–è¯‘</strong><br>å¯ä»¥åˆ†æä¸€ä¸‹ä¸€ä¸ªAndroidå·¥ç¨‹ä¸­é€šå¸¸ä¼šåŒ…æ‹¬å“ªäº›èµ„æºæ–‡ä»¶ï¼š</p><ol><li>AndroidManifest.xml</li><li>res&#x2F; æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶</li><li>asset&#x2F; æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶</li></ol><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202407062111418.png" alt="appæ–‡ä»¶"></p><p>åœ¨ç¼–è¯‘èµ„æºæ–‡ä»¶æ—¶ï¼Œé™¤äº† asset&#x2F; æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ä¼šç›´æ¥ä¿ç•™ä¹‹å¤–ï¼Œxml ä¸ res&#x2F;ä¸‹çš„æ–‡ä»¶éƒ½ä¼šé€šè¿‡ aapt2 æ¥ç¼–è¯‘ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p><p><code>AAPT2</code>ï¼ˆ<code>Android Asset Packaging Tool2</code>ï¼‰æ˜¯ä¸€ç§æ„å»ºå·¥å…·ï¼Œ<code>Android Studio</code> å’Œ <code>Android Gradle</code> æ’ä»¶ä½¿ç”¨å®ƒæ¥ç¼–è¯‘å’Œæ‰“åŒ…åº”ç”¨çš„èµ„æºã€‚<code>AAPT2</code> ä¼šè§£æèµ„æºã€ä¸ºèµ„æºç¼–åˆ¶ç´¢å¼•ï¼Œå¹¶å°†èµ„æºç¼–è¯‘ä¸ºé’ˆå¯¹ <code>Android</code>å¹³å°è¿›è¡Œè¿‡ä¼˜åŒ–çš„äºŒè¿›åˆ¶æ ¼å¼ã€‚Android Gradle æ’ä»¶ 3.0.0 åŠæ›´é«˜ç‰ˆæœ¬é»˜è®¤æƒ…å†µä¸‹ä¼šå¯ç”¨ AAPT2ï¼Œå› æ­¤é€šå¸¸ä¸éœ€è¦è‡ªè¡Œè°ƒç”¨Â <code>aapt2</code>ã€‚</p><p>å…¶è·¯å¾„ä½äºï¼š<code>android_sdk/build-tools/version/</code>ä¸‹</p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202407062112525.png" alt="aapt"></p><p>AAPT2 æ”¯æŒé€šè¿‡å¯ç”¨å¢é‡ç¼–è¯‘å®ç°æ›´å¿«çš„èµ„æºç¼–è¯‘ã€‚è¿™æ˜¯é€šè¿‡å°†èµ„æºå¤„ç†æ‹†åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤æ¥å®ç°çš„ï¼š</p><ul><li><a href="https://developer.android.google.cn/studio/command-line/aapt2?hl=zh-cn#compile">ç¼–è¯‘</a>ï¼šå°†èµ„æºæ–‡ä»¶ç¼–è¯‘ä¸ºäºŒè¿›åˆ¶æ ¼å¼ã€‚</li><li><a href="https://developer.android.google.cn/studio/command-line/aapt2?hl=zh-cn#link">é“¾æ¥</a>ï¼šåˆå¹¶æ‰€æœ‰å·²ç¼–è¯‘çš„æ–‡ä»¶å¹¶å°†å®ƒä»¬æ‰“åŒ…åˆ°ä¸€ä¸ªè½¯ä»¶åŒ…ä¸­ã€‚</li></ul><p>è¿™ç§æ‹†åˆ†æ–¹å¼æœ‰åŠ©äºæé«˜å¢é‡ç¼–è¯‘çš„æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŸä¸ªæ–‡ä»¶ä¸­æœ‰æ›´æ”¹ï¼Œåªéœ€è¦é‡æ–°ç¼–è¯‘è¯¥æ–‡ä»¶ã€‚</p><p>ç¼–è¯‘è¿‡ç¨‹ï¼š</p><ol><li>é’ˆå¯¹ä½äº<code>res/values/</code>ä¸‹çš„ xmlèµ„æºæ–‡ä»¶ï¼Œä¼šè¢«ç¼–è¯‘ä¸ºä»¥Â <code>*.arsc.flat</code>ä½œä¸ºæ‰©å±•åçš„èµ„æºè¡¨ã€‚</li><li>å…¶ä»–èµ„æºæ–‡ä»¶ä¸­ï¼Œå…¶ä»–æ‰€æœ‰çš„xmlæ–‡ä»¶éƒ½å°†è½¬æ¢ä¸ºæ‰©å±•åä¸ºÂ <code>*.flat</code>Â çš„äºŒè¿›åˆ¶ XML æ–‡ä»¶ã€‚è€Œå¯¹äºpngå›¾ç‰‡ï¼Œåˆ™ä¼šè¢«å‹ç¼©ï¼Œå¹¶é‡‡ç”¨Â <code>*.png.flat</code>Â ä½œä¸ºæ‰©å±•åã€‚</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">aapt2 compile project_root/module_root/src/main/res/values-en/<br>strings.xml -o compiled/<br>aapt2 compile project_root/module_root/src/main/res/drawable<br>/myImage.png -o compiled/<br><br><span class="hljs-comment"># ç”Ÿæˆæ–‡ä»¶ values-en_strings.arsc.flat å’Œ drawable_img.png.flat</span><br></code></pre></td></tr></table></figure><p>é“¾æ¥è¿‡ç¨‹ï¼š</p><p>AAPT2 è¾“å‡ºçš„æ–‡ä»¶ä¸æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¿…é¡»åœ¨é“¾æ¥é˜¶æ®µæ·»åŠ è¿™äº›äºŒè¿›åˆ¶æ–‡ä»¶ä½œä¸ºè¾“å…¥æ¥ç”Ÿæˆ APKï¼Œåœ¨é“¾æ¥é˜¶æ®µï¼ŒAAPT2 ä¼šåˆå¹¶åœ¨ç¼–è¯‘é˜¶æ®µç”Ÿæˆçš„æ‰€æœ‰ä¸­é—´æ–‡ä»¶ï¼ˆå¦‚èµ„æºè¡¨ã€äºŒè¿›åˆ¶ XML æ–‡ä»¶å’Œå¤„ç†è¿‡çš„ PNG ç­‰ .flatæ–‡ä»¶ï¼‰ï¼Œå¹¶å°†å®ƒä»¬æ‰“åŒ…æˆä¸€ä¸ª APKã€‚è€Œä¸”ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­è¿˜ä¼šç”Ÿæˆ R.javaæ–‡ä»¶ã€resources.arscå’ŒProGuard è§„åˆ™æ–‡ä»¶ï¼Œæ­¤æ—¶ç”Ÿæˆçš„apk ä¸å« Dex ç­‰æºç æ–‡ä»¶ï¼Œæ— æ³•å®‰è£…åˆ°è®¾å¤‡ä½¿ç”¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">aapt2 <span class="hljs-built_in">link</span> -o output.apk<br> -I android_sdk/platforms/android_version/android.jar<br>    compiled/res/values_values.arsc.flat<br>    compiled/res/drawable_img.flat --manifest /path/to/AndroidManifest.xml -v<br></code></pre></td></tr></table></figure><p><a href="http://r.java/">R.java</a> æ–‡ä»¶æä¾›èµ„æºæ–‡ä»¶çš„idè¿›è¡Œç´¢å¼•ï¼Œè€Œ resources.arsc æ–‡ä»¶æ˜¯èµ„æºç´¢å¼•è¡¨ï¼Œä¾›åœ¨ç¨‹åºè¿è¡Œæ—¶æ ¹æ®idç´¢å¼•åˆ°å…·ä½“çš„èµ„æºè·¯å¾„ã€‚å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œ resources.arsc ä¿å­˜äº†id ã€nameå’Œè·¯å¾„çš„æ˜ å°„å…³ç³»ã€‚</p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202407062112749.png" alt="resourcesæ–‡ä»¶"></p><p>resources.arsc æ–‡ä»¶çš„æ ¼å¼ï¼š</p><p>æ–‡ä»¶å¤´ï¼šæè¿°æ•´ä¸ªæ–‡ä»¶çš„ä¿¡æ¯ï¼Œæ•°æ®ç»“æ„ä¸º Restable_header ï¼ˆ<a href="https://android.googlesource.com/platform/frameworks/base/+/56a2301/include/androidfw/ResourceTypes.h">ResourceTypes.h</a>ï¼‰</p><p>å…¨å±€å­—ç¬¦å¸¸é‡æ± ï¼šå­˜æ”¾æ‰€æœ‰çš„å­—ç¬¦ä¸²ï¼Œä¾¿äºå­—ç¬¦èµ„æºçš„å¤ç”¨ã€‚</p><p>èµ„æºåŒ…ï¼šå¤šä¸ªèµ„æºåŒ…ï¼Œç³»ç»Ÿèµ„æºåº”ç”¨èµ„æºç­‰ã€‚</p><p>AIDLæ–‡ä»¶æ˜¯ä¸€ç§ç”¨äºè¿›ç¨‹é—´é€šä¿¡çš„æ¥å£æ–‡ä»¶ï¼Œæœ€ç»ˆè¿˜æ˜¯è¦ç”Ÿæˆä¸ºjavaæ–‡ä»¶ï¼Œä½äº<code>android_sdk/build-tools/version/</code>çš„ aidl å·¥å…· ä¼šå°† aidlæ–‡ä»¶ç¼–è¯‘ä¸ºjavaæ–‡ä»¶ã€‚</p><p><strong>Java &amp; kotlin æºä»£ç ç¼–è¯‘</strong></p><p>Javac ç¼–è¯‘ æ‰€æœ‰Javaä»£ç ï¼ŒåŒ…æ‹¬ AIDLç”Ÿæˆçš„javaæ–‡ä»¶ï¼Œç”Ÿæˆ .classæ–‡ä»¶ã€‚kotlinc ç¼–è¯‘æ‰€æœ‰çš„kotinä»£ç ï¼Œç”Ÿæˆ .class æ–‡ä»¶ã€‚APT&#x2F;KAPTç”Ÿæˆçš„ä»£ç ä¹Ÿæ˜¯ä½äºè¿™ä¸ªé˜¶æ®µï¼Œå½“æ³¨è§£è¢«æ ‡è®°ä¸º <code>AnnotationTarget.CLASS</code>æ—¶ï¼Œç›¸å¯¹åº”çš„æ³¨è§£å¤„ç†å™¨ä¼šåœ¨è¯¥é˜¶æ®µç”Ÿæˆå¯¹åº”çš„javaæ–‡ä»¶å’Œclassæ–‡ä»¶ã€‚</p><p><strong>ä»£ç æ··æ·† D8</strong></p><p>åœ¨Â <code>AGP 3.X</code>ä»¥åï¼Œ<code>Google</code>Â åˆ†åˆ«å¼•å…¥Â <code>D8</code>ç¼–è¯‘å™¨å’ŒÂ <code>R8</code>å·¥å…·ä½œä¸ºé»˜è®¤çš„Â <code>DEX</code>ç¼–è¯‘å™¨å’Œæ··æ·†å‹ç¼©å·¥å…·ã€‚</p><p><code>d8</code>æ˜¯ä¸€ç§å‘½ä»¤è¡Œå·¥å…·ï¼Œä½äº<code>android_sdk/build-tools/version/</code>ï¼ŒAndroid Studio å’Œ Android Gradle æ’ä»¶ä½¿ç”¨è¯¥å·¥å…·æ¥å°†é¡¹ç›®çš„.classå­—èŠ‚ç æ–‡ä»¶ç¼–è¯‘ä¸ºåœ¨ Android è®¾å¤‡ä¸Šè¿è¡Œçš„ DEX å­—èŠ‚ç ï¼Œå³<code>dexing</code> è¿‡ç¨‹ã€‚</p><p><code>R8</code>æ˜¯Â <code>ProGuard</code>Â çš„æ›¿ä»£å·¥å…·ï¼Œç”¨äºä»£ç çš„å‹ç¼©ï¼ˆ<code>shrinking</code>ï¼‰å’Œæ··æ·†ï¼ˆ<code>obfuscation</code>ï¼‰ã€‚</p><p>åœ¨Â <code>AGP3.4.0</code>ç‰ˆæœ¬ä¸­ï¼Œ<code>R8</code>æŠŠÂ <code>desugaring</code>ã€<code>shrinking</code>ã€<code>obfuscating</code>ã€<code>optimizing</code>Â å’ŒÂ <code>dexing</code>éƒ½åˆå¹¶åˆ°ä¸€æ­¥è¿›è¡Œæ‰§è¡Œã€‚</p><p>è„±ç³–ï¼ˆ<code>desugaring</code>ï¼‰å³åœ¨ç¼–è¯‘é˜¶æ®µå°†åœ¨è¯­æ³•å±‚é¢ä¸€äº›åº•å±‚å­—èŠ‚ç ä¸æ”¯æŒçš„ç‰¹æ€§è½¬æ¢ä¸ºåŸºç¡€çš„å­—èŠ‚ç ç»“æ„ï¼Œ(æ¯”å¦‚ <code>List</code> ä¸Šçš„æ³›å‹è„±ç³–ååœ¨å­—èŠ‚ç å±‚é¢å®é™…ä¸º <code>Object</code>)ï¼Œæ–°çš„è¯­æ³•å¯ä»¥åœ¨æ‰€æœ‰çš„è®¾å¤‡ä¸Šè¿è¡Œã€‚</p><p>å¯ä»¥åœ¨ gradle.properties ä¸­é…ç½®ç›¸å…³å±æ€§ï¼Œæ¥ç¦ç”¨D8ã€R8 å’Œ desugaringç­‰è¿‡ç¨‹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Disables R8 for Android Library modules only.</span><br>android.enableR8.libraries = <span class="hljs-literal">false</span><br><span class="hljs-comment"># Disables R8 for all modules.</span><br>android.enableR8 = <span class="hljs-literal">false</span><br><span class="hljs-comment"># Disables desugaring</span><br>android.enableIncrementalDesugaring=<span class="hljs-literal">false</span><br>android.enableDesugar=<span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><p>d8è¿˜å¯ç”¨äºå¢é‡æ„å»ºï¼Œ<code>d8</code>Â åœ¨æ‰§è¡Œå¢é‡æ„å»ºæ—¶ï¼Œä¼šå°†ä¸€äº›é¢å¤–çš„ä¿¡æ¯å­˜å‚¨åœ¨ DEX è¾“å‡ºä¸­ã€‚éšååœ¨å®Œæ•´æ„å»ºåº”ç”¨æ—¶ï¼Œ<code>d8</code>ä¼šåˆ©ç”¨è¿™äº›ä¿¡æ¯æ¥æ­£ç¡®å¤„ç†Â <code>--main-dex-list</code>é€‰é¡¹ä»¥åŠåˆå¹¶ DEX æ–‡ä»¶ã€‚</p><p><strong>apkbuilder &#x2F; zipflinger ç”Ÿæˆ apk</strong></p><p>å°†<code>manifest</code>æ–‡ä»¶ã€<code>resources</code>æ–‡ä»¶ã€<code>dex</code>æ–‡ä»¶ã€<code>assets</code>æ–‡ä»¶ç­‰ç­‰æ‰“åŒ…æˆä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä¹Ÿå°±æ˜¯<code>apk</code>æ–‡ä»¶ã€‚è€ç‰ˆæœ¬ä½¿ç”¨ apkbuilder ï¼Œåœ¨<code>AGP3.6.0</code>ä¹‹åï¼Œä½¿ç”¨<code>zipflinger</code>ä½œä¸ºé»˜è®¤æ‰“åŒ…å·¥å…·æ¥æ„å»º<code>APK</code>ï¼Œä»¥æé«˜æ„å»ºé€Ÿåº¦ã€‚</p><p><strong>zipalign å¯¹é½</strong></p><p><code>zipalign</code>æ˜¯ä¸€ç§ zip å½’æ¡£æ–‡ä»¶å¯¹é½å·¥å…·ï¼Œæœ‰åŠ©äºç¡®ä¿å½’æ¡£æ–‡ä»¶ä¸­çš„æ‰€æœ‰æœªå‹ç¼©æ–‡ä»¶ç›¸å¯¹äºæ–‡ä»¶å¼€å¤´å¯¹é½ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ‚¨ä¾¿å¯ç›´æ¥é€šè¿‡Â mmap è®¿é—®è¿™äº›æ–‡ä»¶ï¼Œè€Œæ— éœ€åœ¨ RAM ä¸­å¤åˆ¶è¿™äº›æ•°æ®å¹¶å‡å°‘äº†åº”ç”¨çš„å†…å­˜ç”¨é‡ã€‚</p><aside>ğŸ’¡ æ³¨æ„ï¼šæ‚¨å¿…é¡»åœ¨æ„å»ºæµç¨‹çš„ç‰¹å®šæ—¶é—´ç‚¹ä½¿ç”¨Â `zipalign`ã€‚è¯¥æ—¶é—´ç‚¹å–å†³äºæ‚¨ä½¿ç”¨çš„åº”ç”¨ç­¾åå·¥å…·ï¼š<ul><li>å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯Â <a href="https://developer.android.google.cn/studio/command-line/apksigner?hl=zh-cn"><strong><code>apksigner</code></strong></a>ï¼Œåˆ™å¿…é¡»åœ¨ä¸º APK æ–‡ä»¶ç­¾å<strong>ä¹‹å‰</strong>ä½¿ç”¨Â **<code>zipalign</code>**ã€‚å¦‚æœæ‚¨åœ¨ä½¿ç”¨Â <strong><code>apksigner</code></strong>Â ä¸º APK ç­¾åä¹‹åå¯¹ APK åšå‡ºäº†è¿›ä¸€æ­¥æ›´æ”¹ï¼Œç­¾åä¾¿ä¼šå¤±æ•ˆã€‚</li><li>å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯Â <a href="https://docs.oracle.com/javase/tutorial/deployment/jar/signing.html"><strong><code>jarsigner</code></strong></a>ï¼Œåˆ™å¿…é¡»åœ¨ä¸º APK æ–‡ä»¶ç­¾å<strong>ä¹‹å</strong>ä½¿ç”¨Â **<code>zipalign</code>**ã€‚</aside></li></ul><p>ä¸ºäº†å®ç°å¯¹é½ï¼Œ<code>zipalign</code>ä¼šæ›´æ”¹ zipÂ <strong>æœ¬åœ°æ–‡ä»¶æ ‡å¤´</strong>éƒ¨åˆ†ä¸­Â <code>&quot;extra&quot;</code>å­—æ®µçš„å¤§å°ã€‚æ­¤è¿‡ç¨‹è¿˜ä¼šæ›´æ”¹Â <code>&quot;extra&quot;</code>å­—æ®µä¸­çš„ç°æœ‰æ•°æ®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">zipalign -p -f -v 4 infile.apk outfile.apk<br><br>-p å¯¹é½ <br>-f è¦†ç›–è¾“å‡º<br>-v è¯¦ç»†ä¿¡æ¯<br>4 4å­—èŠ‚å¯¹é½<br></code></pre></td></tr></table></figure><p>å¯¹é½çš„ä¸»è¦è¿‡ç¨‹æ˜¯å°†<code>APK</code>åŒ…ä¸­æ‰€æœ‰çš„èµ„æºæ–‡ä»¶è·ç¦»æ–‡ä»¶èµ·å§‹åç§»ä¸º4å­—èŠ‚æ•´æ•°å€ï¼Œå¯¹é½åå°±å¯ä»¥ä½¿ç”¨<code>mmap</code>å‡½æ•°è¯»å–æ–‡ä»¶ï¼Œå¯ä»¥åƒè¯»å–å†…å­˜ä¸€æ ·å¯¹æ™®é€šæ–‡ä»¶è¿›è¡Œæ“ä½œã€‚</p><p><strong>apksigner ç­¾å</strong></p><p>éœ€è¦å¯¹apkæ–‡ä»¶è¿›è¡Œç­¾åï¼Œå¦åˆ™æ— æ³•å®‰è£…ï¼Œå®é™…é¡¹ç›®ä¸­ä¼šæœ‰ debug å’Œrelease ä¸¤ç§ä¸åŒçš„ç­¾åæ–‡ä»¶ã€‚<code>jarsigner</code>åªèƒ½è¿›è¡Œ<code>v1</code>ç­¾åï¼Œè€Œ<code>apksigner</code>å¯ä»¥è¿›è¡Œ<code>v2</code>ã€<code>v3</code>ã€<code>v4</code>ç­¾åã€‚</p><p>è¯¦ç»†ä»‹ç»ï¼š<a href="https://juejin.cn/post/7111116047960244254">Androidå¼€å‘åº”è¯¥çŸ¥é“çš„ç­¾åçŸ¥è¯†ï¼ - æ˜é‡‘ (juejin.cn)</a></p><p>æ¶ˆæ¯æ‘˜è¦ï¼šå¯¹æ•°æ®è¿›è¡Œå•å‘hashï¼Œå¾—åˆ°å›ºå®šhashå€¼çš„è¿‡ç¨‹ã€‚å¸¸è§çš„æ‘˜è¦ç®—æ³•éƒ½æœ‰ MD5ã€SHA-1 å’Œ SHA-256ï¼Œæ»¡è¶³ å¯¹ç›¸åŒå†…å®¹å¤šæ¬¡hashç»“æœä¸€è‡´ï¼Œä¸”å¾ˆå°‘å‘ç”Ÿhashç¢°æ’ã€‚</p><p>éå¯¹ç§°åŠ å¯†ï¼šéå¯¹ç§°åŠ å¯†æ˜¯ä½¿ç”¨å…¬é’¥&#x2F;ç§é’¥ä¸­çš„å…¬é’¥æ¥åŠ å¯†æ˜æ–‡ï¼Œç„¶åä½¿ç”¨å¯¹åº”çš„ç§é’¥&#x2F;ç§é’¥æ¥è§£å¯†å¯†æ–‡çš„è¿‡ç¨‹ã€‚ä¾‹å¦‚ https é€šä¿¡è¿‡ç¨‹ä¸­çš„éå¯¹ç§°åŠ å¯†è¿‡ç¨‹ã€‚</p><p>æ•°å­—è¯ä¹¦ï¼šç”± CAæœºæ„é¢å‘çš„è¯æ˜å…¬é’¥çš„èº«ä»½çš„è¯ä¹¦ã€‚</p><p>Android ä¸­æ•°å­—ç­¾åçš„ç”Ÿæˆå’Œæ™®é€šçš„æ•°å­—ç­¾åå¹¶æ²¡æœ‰å¾ˆå¤§çš„åŒºåˆ«ã€‚Androidä¸»è¦ä½¿ç”¨è‡ªç­¾åçš„æ–¹å¼ï¼Œä¸éœ€è¦CAæœºæ„é¢å‘çš„æ•°å­—è¯ä¹¦ã€‚</p><p><strong>v1 ç­¾åï¼š</strong></p><p>åˆ©ç”¨<code>META-INFO</code>æ–‡ä»¶å¤¹ä¸­ä»¥<code>MF</code>ã€<code>SF</code>å’ŒÂ <code>RSA</code>ä¸ºæ‰©å±•åçš„ä¸‰ä¸ªæ–‡ä»¶ï¼Œå°†<code>apk</code>ä¸­é™¤äº†<code>META-INFO</code>æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶è¿›è¡Œè¿›è¡Œæ‘˜è¦å†™åˆ° <code>META-INFO/MANIFEST.MF</code>ï¼›ç„¶åè®¡ç®—<code>MANIFEST.MF</code>æ–‡ä»¶çš„æ‘˜è¦å†™åˆ°<code>CERT.SF</code>ï¼›æœ€åè®¡ç®—<code>CERT.SF</code>çš„æ‘˜è¦ï¼Œä½¿ç”¨ç§é’¥è®¡ç®—ç­¾åï¼Œå°†ç­¾åå’Œå¼€å‘è€…è¯ä¹¦å†™åˆ°<code>CERT.RSA</code>ã€‚</p><p>v1ç­¾åçš„é—®é¢˜ï¼š</p><p>ç­¾åæ ¡éªŒæ…¢ã€‚</p><p><code>META-INFO</code>æ–‡ä»¶å¤¹ä¸ä¼šè¢«ç­¾åï¼Œå­˜åœ¨ä¸€å®šå®‰å…¨éšæ‚£</p><p><strong>v2ç­¾åï¼š</strong></p><p>Apkæœ¬è´¨ä¸Šä¸ºä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè€Œå‹ç¼©åŒ…æ–‡ä»¶æ ¼å¼ä¸€èˆ¬åˆ†ä¸ºä¸‰å—ï¼šæ–‡ä»¶æ•°æ®åŒºï¼Œä¸­å¤®ç›®å½•ï¼Œä¸­å¤®ç›®å½•ç»“æŸèŠ‚ã€‚<code>V2</code>è¦åšçš„å°±æ˜¯ï¼Œåœ¨æ–‡ä»¶ä¸­æ’å…¥ä¸€ä¸ª<code>APK Signing Block</code>ï¼Œä½äºä¸­å¤®ç›®å½•éƒ¨åˆ†ä¹‹å‰ã€‚</p><h3 id="Apkè‡ªåŠ¨åŒ–æ„å»ºä¸­çš„Gradle-Task"><a href="#Apkè‡ªåŠ¨åŒ–æ„å»ºä¸­çš„Gradle-Task" class="headerlink" title="Apkè‡ªåŠ¨åŒ–æ„å»ºä¸­çš„Gradle Task"></a>Apkè‡ªåŠ¨åŒ–æ„å»ºä¸­çš„Gradle Task</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs bash">&gt; Configure project :app<br>&gt; Task :app:preBuild UP-TO-DATE<br>&gt; Task :app:preDebugBuild UP-TO-DATE<br>&gt; Task :app:mergeDebugNativeDebugMetadata NO-SOURCE<br>&gt; Task :app:compileDebugAidl NO-SOURCE<br>&gt; Task :app:compileDebugRenderscript NO-SOURCE<br>&gt; Task :app:generateDebugBuildConfig UP-TO-DATE<br>&gt; Task :app:checkDebugAarMetadata UP-TO-DATE<br>&gt; Task :app:generateDebugResValues UP-TO-DATE<br>&gt; Task :app:generateDebugResources UP-TO-DATE<br>&gt; Task :app:mergeDebugResources UP-TO-DATE<br>&gt; Task :app:packageDebugResources UP-TO-DATE<br>&gt; Task :app:parseDebugLocalResources UP-TO-DATE<br>&gt; Task :app:createDebugCompatibleScreenManifests UP-TO-DATE<br>&gt; Task :app:extractDeepLinksDebug UP-TO-DATE<br>&gt; Task :app:processDebugMainManifest UP-TO-DATE<br>&gt; Task :app:processDebugManifest UP-TO-DATE<br>&gt; Task :app:processDebugManifestForPackage UP-TO-DATE<br>&gt; Task :app:processDebugResources UP-TO-DATE<br>&gt; Task :app:compileDebugKotlin UP-TO-DATE<br>&gt; Task :app:javaPreCompileDebug UP-TO-DATE<br>&gt; Task :app:compileDebugJavaWithJavac UP-TO-DATE<br>&gt; Task :app:mergeDebugShaders UP-TO-DATE<br>&gt; Task :app:compileDebugShaders NO-SOURCE<br>&gt; Task :app:generateDebugAssets UP-TO-DATE<br>&gt; Task :app:mergeDebugAssets UP-TO-DATE<br>&gt; Task :app:compressDebugAssets UP-TO-DATE<br>&gt; Task :app:processDebugJavaRes NO-SOURCE<br>&gt; Task :app:mergeDebugJavaResource UP-TO-DATE<br>&gt; Task :app:checkDebugDuplicateClasses UP-TO-DATE<br>&gt; Task :app:desugarDebugFileDependencies UP-TO-DATE<br>&gt; Task :app:mergeExtDexDebug UP-TO-DATE<br>&gt; Task :app:mergeLibDexDebug UP-TO-DATE<br>&gt; Task :app:dexBuilderDebug UP-TO-DATE<br>&gt; Task :app:mergeProjectDexDebug UP-TO-DATE<br>&gt; Task :app:mergeDebugJniLibFolders UP-TO-DATE<br>&gt; Task :app:mergeDebugNativeLibs NO-SOURCE<br>&gt; Task :app:stripDebugDebugSymbols NO-SOURCE<br>&gt; Task :app:validateSigningDebug UP-TO-DATE<br>&gt; Task :app:writeDebugAppMetadata UP-TO-DATE<br>&gt; Task :app:writeDebugSigningConfigVersions UP-TO-DATE<br>&gt; Task :app:packageDebug UP-TO-DATE<br>&gt; Task :app:createDebugApkListingFileRedirect UP-TO-DATE<br>&gt; Task :app:assembleDebug UP-TO-DATE<br><br>BUILD SUCCESSFUL <span class="hljs-keyword">in</span> 571ms<br>31 actionable tasks: 31 up-to-date<br><br>Build Analyzer results available<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash">:app:preBuild UP-TO-DATE    â†’ ç©ºtaskï¼Œé”šç‚¹<br>:app:preDebugBuild  â†’ ç©ºtaskï¼Œé”šç‚¹<br>:app:compileDebugAidl NO-SOURCE â†’ å¤„ç†AIDL<br>:app:checkDebugManifest â†’ æ£€æŸ¥Manifestæ˜¯å¦å­˜åœ¨<br>:app:compileDebugRenderscript NO-SOURCE â†’ å¤„ç†renderscript<br>:app:generateDebugBuildConfig   â†’ ç”Ÿæˆ BuildConfig.java<br>:app:mainApkListPersistenceDebug â†’ ç”Ÿæˆ app-list.gson<br>:app:generateDebugResValues â†’ ç”Ÿæˆresvalueï¼Œgenerated.xml<br>:app:generateDebugResources â†’ ç©ºtaskï¼Œé”šç‚¹<br>:app:mergeDebugResources    â†’ åˆå¹¶èµ„æºæ–‡ä»¶<br>:app:createDebugCompatibleScreenManifests   â†’ manifestæ–‡ä»¶ä¸­ç”Ÿæˆcompatible-screensï¼ŒæŒ‡å®šå±å¹•é€‚é…<br>:app:processDebugManifest â†’ åˆå¹¶manifest.xmlæ–‡ä»¶<br>:app:processDebugResources â†’ aaptæ‰“åŒ…èµ„æº<br>:app:compileDebugKotlin â†’ ç¼–è¯‘Kotlinæ–‡ä»¶<br>:app:prepareLintJar UP-TO-DATE â†’ æ‹·è´ lint jaråŒ…åˆ°æŒ‡å®šä½ç½®<br>:app:generateDebugSources â†’ ç©ºtaskï¼Œé”šç‚¹<br>:app:javaPreCompileDebug â†’ ç”Ÿæˆ annotationProcessors.json æ–‡ä»¶<br>:app:compileDebugJavaWithJavac â†’ ç¼–è¯‘ javaæ–‡ä»¶<br>:app:compileDebugNdk â†’ ç¼–è¯‘ndk<br>:app:compileDebugSources â†’ ç©ºtaskï¼Œé”šç‚¹<br>:app:mergeDebugShaders â†’ åˆå¹¶ shaderæ–‡ä»¶<br>:app:compileDebugShaders â†’ ç¼–è¯‘ shaders<br>:app:generateDebugAssets â†’ ç©ºtaskï¼Œé”šç‚¹<br>:app:mergeDebugAssets â†’ åˆå¹¶ assestsæ–‡ä»¶<br>:app:validateSigningDebug â†’ éªŒè¯ç­¾å<br>:app:signingConfigWriterDebug â†’ ç¼–å†™SigningConfigä¿¡æ¯<br>:app:checkDebugDuplicateClasses â†’ æ£€æŸ¥é‡å¤class<br>:app:transformClassesWithDexBuilderForDebug â†’ classæ‰“åŒ…æˆdex<br>:app:transformDexArchiveWithExternalLibsDexMergerForDebug â†’ æ‰“åŒ…ç¬¬ä¸‰æ–¹åº“çš„dex<br>:app:transformDexArchiveWithDexMergerForDebug â†’ æ‰“åŒ…æœ€ç»ˆçš„dex<br>:app:mergeDebugJniLibFolders â†’ åˆå¹¶jni lib æ–‡ä»¶<br>:app:transformNativeLibsWithMergeJniLibsForDebug â†’ åˆå¹¶jnilibs<br>:app:transformNativeLibsWithStripDebugSymbolForDebug â†’ å»æ‰native libé‡Œçš„debugç¬¦å·<br>:app:processDebugJavaRes NO-SOURCE â†’ å¤„ç†java res<br>:app:transformResourcesWithMergeJavaResForDebug â†’ åˆå¹¶java res<br>:app:packageDebug  â†’ æ‰“åŒ…apk<br>:app:assembleDebug â†’ ç©ºtaskï¼Œé”šç‚¹<br>:app:extractProguardFiles â†’ ç”Ÿæˆæ··æ·†æ–‡ä»¶<br></code></pre></td></tr></table></figure><p>Android Gradle Pluginæºç é˜…è¯»å‡†å¤‡</p><p><a href="https://juejin.cn/column/6963508988642230285">Gradle - renxhuiçš„ä¸“æ  - æ˜é‡‘ (juejin.cn)</a></p><p>Android gradle plugin çš„æºç çš„ä¾èµ–ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">implementation <span class="hljs-string">&quot;com.android.tools.build:gradle:<span class="hljs-variable">$VERSION</span>&quot;</span><br></code></pre></td></tr></table></figure><p>åœ¨ gradle 7.0 ä¹‹å‰ï¼Œgradle çš„ç‰ˆæœ¬å’Œ agp çš„ç‰ˆæœ¬å·ä¸ä¸€è‡´ï¼Œä»¥ä¸‹æ˜¯å¯¹åº”å…³ç³»ï¼š</p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202407062112400.png" alt="AGPç‰ˆæœ¬å¯¹åº”"></p><p>å®‰åˆ©æŸ¥çœ‹Â <code>AGP</code>Â æºç çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç›´æ¥åœ¨é¡¹ç›®ä¾èµ–å¯¹åº”Â <code>AGP</code>Â ç‰ˆæœ¬å³å¯ï¼Œä¸éœ€è¦æ‰‹åŠ¨ä¸‹è½½æºç </p><p><code>implementation &quot;com.android.tools.build:gradle:7.1.2&quot;</code></p><p>sync å®Œæˆä¹‹åï¼Œæ‰å¯ä»¥çœ‹åˆ°AGPæºç </p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202407062113285.png" alt="gradle"></p><p>å…¨å±€æœç´¢ AppPlugin.java ç±»ï¼Œè€Œä¸æ˜¯ AppPlugin.kt æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ° <a href="http://com.android.application.properties/">com.android.application.properties</a> æ–‡ä»¶ä¸­è®°å½•çš„implementation-classå¯¹åº”çš„å®ç°ç±»ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">implementation-class=com.android.build.gradle.AppPlugin<br></code></pre></td></tr></table></figure><p>BasePlugin.java</p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202407062113274.png" alt="BasePlugin"></p><p>app æ„å»ºæµç¨‹åŒ…æ‹¬ï¼š</p><p><code>configureProject</code></p><p><code>configureExtension</code></p><p><code>createTasks</code></p><p><code>createTasksBeforeEvaluate</code></p><p><code>createAndroidTasks</code></p><p>ç»è¿‡ä»£ç è·Ÿè¸ªï¼Œæœ€ç»ˆåˆ°<code>ApplicationTaskManager</code>ç±»ä¸­å®Œæˆäº†æ•´ä¸ªæ‰“åŒ…è¿‡ç¨‹task çš„æ„å»ºã€‚å¯¹äºæºç é˜…è¯»ï¼Œåªéœ€è¦åœ¨ç”¨åˆ°æ—¶æŸ¥æ‰¾æŸä¸ªåŠŸèƒ½çš„ä½¿ç”¨èŠ‚ç‚¹æ—¶åœ¨è·Ÿè¿›ä»£ç ï¼Œæ‰¾åˆ°å…·ä½“ä½ç½®å³å¯ï¼Œä¾‹å¦‚æƒ³çŸ¥é“è‡ªå®šä¹‰çš„ tranform æ˜¯åœ¨å“ªä¸ªtask ä»»åŠ¡ä¸­è¢«æ‰§è¡Œçš„ï¼Œå°±å¯ä»¥ä»è¯¥å…¥å£è¿›å…¥è¿›è¡ŒæŸ¥æ‰¾ï¼šTaskManager#createPostCompilationTasksï¼Œå…³äºè¿™ä¸ªæ–¹æ³•çš„æ³¨é‡Šä¸ºï¼š</p><p><code>Creates the post-compilation tasks for the given Variant. These tasks create the dex file from the .class files, plus optional intermediary steps like proguard and jacoco</code></p><p>ä¸ºç»™å®šå˜ä½“åˆ›å»ºç¼–è¯‘åä»»åŠ¡ã€‚<br>è¿™äº›ä»»åŠ¡ä».classæ–‡ä»¶åˆ›å»º dex æ–‡ä»¶ï¼Œä»¥åŠå¯é€‰çš„ä¸­é—´æ­¥éª¤ï¼Œå¦‚ proguard å’Œ jacoco</p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202407062114189.png" alt="tranform Task"></p><p>agp å„ä¸ªç‰ˆæœ¬ api å˜åŒ–è¾ƒå¤§ï¼Œæœ€æ–°ç‰ˆæœ¬ç”šè‡³éƒ½ç”¨kotlin é‡å†™äº†æ•´ä¸ªæµç¨‹ï¼Œä½†æ˜¯æ•´ä¸ªæ‰“åŒ…çš„ä¸»ä½“æµç¨‹æ˜¯ä¸å˜çš„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦é€‰æ‹©å…¶ä¸­ä¸€ä¸ªç‰ˆæœ¬ï¼Œåˆ†æå®ƒæ‰“åŒ…æµç¨‹ä¸­æ‰€å¯¹åº”çš„å„ä¸ªtask çš„ä½œç”¨å³å¯ã€‚</p><p><strong>å‚è€ƒèµ„æ–™ï¼š</strong></p><ul><li>å¼€å‘è€…å®˜ç½‘ï¼š<a href="https://developer.android.google.cn/">Android å¼€å‘è€… Â |Â  Android Developers (google.cn)</a></li><li>AOSPå®˜ç½‘ï¼š<a href="https://source.android.google.cn/?hl=zh-cn">Android å¼€æºé¡¹ç›® Â |Â  Android Open Source Project (google.cn)</a></li><li>æ„å»ºç›¸å…³å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://developer.android.google.cn/studio/build?hl=zh-cn">é…ç½® build Â |Â  Android å¼€å‘è€… Â |Â  Android Developers (google.cn)</a></li><li>beesXï¼š<a href="https://www.yuque.com/beesx/beesandroid/qqqbuh">Androidå®‰è£…åŒ…çš„æ‰“åŒ…æµç¨‹ (yuque.com)</a></li><li>ä¸€äº›åšå®¢ï¼š<a href="https://juejin.cn/post/7113713363900694565">Android Apk ç¼–è¯‘æ‰“åŒ…æµç¨‹ï¼Œäº†è§£ä¸€ä¸‹~ - æ˜é‡‘ (juejin.cn)</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å†™ä»£ç çš„ä¸€äº›åŸåˆ™ï¼ˆç¬”è®°æµï¼‰</title>
    <link href="/2024/07/06/%E5%86%99%E4%BB%A3%E7%A0%81%E7%9A%84%E4%B8%80%E4%BA%9B%E5%8E%9F%E5%88%99%EF%BC%88%E7%AC%94%E8%AE%B0%E6%B5%81%EF%BC%89/"/>
    <url>/2024/07/06/%E5%86%99%E4%BB%A3%E7%A0%81%E7%9A%84%E4%B8%80%E4%BA%9B%E5%8E%9F%E5%88%99%EF%BC%88%E7%AC%94%E8%AE%B0%E6%B5%81%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æˆ‘ä»¬éƒ½æ›¾ç»çŸä¸€çœ¼è‡ªå·±äº²æ‰‹é€ æˆçš„æ··ä¹±ï¼Œå†³å®šå¼ƒä¹‹è€Œä¸é¡¾ï¼Œèµ°å‘æ–°çš„ä¸€å¤©ã€‚æˆ‘ä»¬éƒ½æ›¾ç»çœ‹åˆ°è‡ªå·±çš„çƒ‚ç¨‹åºå±…ç„¶èƒ½è¿è¡Œï¼Œç„¶åæ–­è¨€èƒ½è¿è¡Œçš„çƒ‚ç¨‹åºæ€»æ¯”ä»€ä¹ˆéƒ½æ²¡æœ‰å¼ºã€‚æˆ‘ä»¬éƒ½æ›¾ç»è¯´è¿‡æœ‰æœä¸€æ—¥å†å›å¤´æ¸…ç†ã€‚å½“ç„¶ï¼Œåœ¨é‚£äº›æ—¥å­é‡Œï¼Œæˆ‘ä»¬éƒ½æ²¡å¬è¿‡å‹’å¸ƒæœ—ï¼ˆLeBlancï¼‰æ³•åˆ™ï¼šç¨åç­‰äºæ°¸ä¸ï¼ˆLater equals neverï¼‰â€” Clean Code</p></blockquote><p>éšç€éœ€æ±‚çš„ä¸æ–­å¢åŠ å’Œå˜æ›´ï¼Œä¸šåŠ¡é€»è¾‘è¶Šæ¥è¶Šå¤æ‚ï¼Œå‚ä¸å¼€å‘çš„äººä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œå¤šäººåä½œå¼€å‘ä¸å¯é¿å…çš„å°±æœ‰æ”¹åŠ¨åˆ°åŒä¸€å¤„ä»£ç ï¼ŒåŒä¸€å¤„é€»è¾‘çš„éœ€è¦ï¼Œè€Œä¸€ä½†æ¯ä¸ªäººéƒ½éšæ„çš„åœ¨åŒä¸€å¤„åœ°æ–¹æ·»åŠ è‡ªå·±çš„é€»è¾‘ä¹‹åï¼Œå°±ä¼šå¯¼è‡´ä»£ç è€¦åˆä¸¥é‡ï¼Œéš¾ä»¥é˜…è¯»å’Œç»´æŠ¤ï¼Œé™ä½æˆ‘ä»¬æ¯ä¸ªäººçš„å¼€å‘æ•ˆç‡å’Œå¼€å‘ä½“éªŒï¼Œä»è€Œå½±å“ç”šè‡³æ˜¯é˜»ç¢äº†æ–°åŠŸèƒ½çš„è¿­ä»£ã€‚</p><h1 id="å•¥å«è®¾è®¡åŸåˆ™"><a href="#å•¥å«è®¾è®¡åŸåˆ™" class="headerlink" title="å•¥å«è®¾è®¡åŸåˆ™"></a>å•¥å«è®¾è®¡åŸåˆ™</h1><p>å…³äºä»£ç ä¸­çš„è®¾è®¡åŸåˆ™æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ä¸€äº›ç»å…¸çš„è®¾è®¡åŸåˆ™ SOLIDã€KISSã€YAGNIã€DRYã€LOD ç­‰ã€‚åŸåˆ™å¯èƒ½çœ‹èµ·æ¥éå¸¸ç®€å•ï¼Œä½†æ˜¯è¿ç”¨åˆ°å®é™…ä¸­å´ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“ï¼Œè¿™é‡Œåˆ—ä¸¾å‡ºæ¥ï¼Œåç»­å¯ä»¥æ·±å…¥è¿›è¡Œå­¦ä¹ ï¼Œè¿™äº›è®¾è®¡åŸåˆ™ï¼Œå¸¸çœ‹å¸¸æ–°ï¼š</p><blockquote><p>SOLID ï¼šå•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle Responsibility Principleï¼‰ã€å¼€é—­åŸåˆ™ï¼ˆOpen Closed Principleï¼‰ã€é‡Œå¼æ›¿æ¢åŸåˆ™ï¼ˆLiskov Substitution Principleï¼‰ã€æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Principleï¼‰å’Œä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependency Inversion Principleï¼‰ã€‚</p></blockquote><blockquote><p>KISS ï¼šKeep It Simple and Stupid å°½é‡ä¿æŒç®€å•ã€‚</p></blockquote><blockquote><p>YAGNI : You Ainâ€™t Gonna Need It ä¸è¦åšè¿‡åº¦è®¾è®¡ã€‚</p></blockquote><blockquote><p>DRY: Donâ€™t Repeat Yourself ä¸è¦é‡å¤ã€‚</p></blockquote><blockquote><p>LOD : Law of Demeter ä¸è¯¥æœ‰ç›´æ¥ä¾èµ–å…³ç³»çš„ç±»ä¹‹é—´ï¼Œä¸è¦æœ‰ä¾èµ–ï¼›æœ‰ä¾èµ–å…³ç³»çš„ç±»ä¹‹é—´ï¼Œå°½é‡åªä¾èµ–å¿…è¦çš„æ¥å£ã€‚ï¼ˆåŸæ–‡æ˜¯ï¼šEach unit should have only limited knowledge about other units: only units â€œcloselyâ€ related to the current unit. Or: Each unit should only talk to its friends; Donâ€™t talk to strangers.ï¼‰</p></blockquote><h2 id="SOLID"><a href="#SOLID" class="headerlink" title="SOLID"></a>SOLID</h2><p>å•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle Responsibility Principleï¼‰ï¼Œç¼©å†™ä¸º SRPï¼šä¸€ä¸ªç±»æˆ–è€…æ¨¡å—åªè´Ÿè´£å®Œæˆä¸€ä¸ªèŒè´£ï¼ˆæˆ–è€…åŠŸèƒ½ï¼‰ã€‚ä¸è¦è®¾è®¡å¤§è€Œå…¨çš„ç±»ï¼Œè¦è®¾è®¡ç²’åº¦å°ã€åŠŸèƒ½å•ä¸€çš„ç±»ã€‚æ¢ä¸ªè§’åº¦æ¥è®²å°±æ˜¯ï¼Œä¸€ä¸ªç±»åŒ…å«äº†ä¸¤ä¸ªæˆ–è€…ä¸¤ä¸ªä»¥ä¸Šä¸šåŠ¡ä¸ç›¸å¹²çš„åŠŸèƒ½ï¼Œé‚£æˆ‘ä»¬å°±è¯´å®ƒèŒè´£ä¸å¤Ÿå•ä¸€ï¼Œåº”è¯¥å°†å®ƒæ‹†åˆ†æˆå¤šä¸ªåŠŸèƒ½æ›´åŠ å•ä¸€ã€ç²’åº¦æ›´ç»†çš„ç±»ã€‚</p><p>è¯„ä»·ä¸€ä¸ªç±»çš„èŒè´£æ˜¯å¦è¶³å¤Ÿå•ä¸€ï¼Œå¹¶æ²¡æœ‰ä¸€ä¸ªéå¸¸æ˜ç¡®çš„ã€å¯ä»¥é‡åŒ–çš„æ ‡å‡†ã€‚å¯ä»¥å…ˆå†™ä¸€ä¸ªç²—ç²’åº¦çš„ç±»ï¼Œæ»¡è¶³ä¸šåŠ¡éœ€æ±‚ã€‚éšç€ä¸šåŠ¡çš„å‘å±•ï¼Œå¦‚æœç²—ç²’åº¦çš„ç±»è¶Šæ¥è¶Šåºå¤§ï¼Œä»£ç è¶Šæ¥è¶Šå¤šï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†è¿™ä¸ªç²—ç²’åº¦çš„ç±»ï¼Œæ‹†åˆ†æˆå‡ ä¸ªæ›´ç»†ç²’åº¦çš„ç±»ã€‚</p><p>å‡ ä¸ªç®€å•çš„èŒè´£ä¸å¤Ÿå•ä¸€çš„åˆ¤æ–­åŸåˆ™ï¼š</p><ul><li>ç±»ä¸­çš„ä»£ç è¡Œæ•°ã€å‡½æ•°æˆ–å±æ€§è¿‡å¤šã€‚</li><li>ç±»ä¾èµ–çš„å…¶ä»–ç±»è¿‡å¤šï¼Œæˆ–è€…ä¾èµ–ç±»çš„å…¶ä»–ç±»è¿‡å¤šã€‚</li><li>ç§æœ‰æ–¹æ³•è¿‡å¤šã€‚</li><li>æ¯”è¾ƒéš¾ç»™ç±»èµ·ä¸€ä¸ªåˆé€‚åå­—ï¼Œå¾ˆéš¾ç”¨ä¸€ä¸ªä¸šåŠ¡åè¯æ¦‚æ‹¬ã€‚</li></ul><p>å¼€é—­åŸåˆ™ï¼ˆOpen Closed Principleï¼‰ï¼Œâ€˜å¯¹æ‰©å±•å¼€æ”¾ã€ä¿®æ”¹å…³é—­â€™ã€‚</p><p>æ·»åŠ ä¸€ä¸ªæ–°çš„åŠŸèƒ½åº”è¯¥æ˜¯ï¼Œåœ¨å·²æœ‰ä»£ç åŸºç¡€ä¸Šæ‰©å±•ä»£ç ï¼ˆæ–°å¢æ¨¡å—ã€ç±»ã€æ–¹æ³•ç­‰ï¼‰ï¼Œè€Œéä¿®æ”¹å·²æœ‰ä»£ç ï¼ˆä¿®æ”¹æ¨¡å—ã€ç±»ã€æ–¹æ³•ç­‰ï¼‰ã€‚</p><p>æ·»åŠ ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œä¸å¯èƒ½ä»»ä½•æ¨¡å—ã€ç±»ã€æ–¹æ³•çš„ä»£ç éƒ½ä¸â€œä¿®æ”¹â€ï¼Œè¿™ä¸ªæ˜¯åšä¸åˆ°çš„ã€‚ç±»éœ€è¦åˆ›å»ºã€ç»„è£…ã€å¹¶ä¸”åšä¸€äº›åˆå§‹åŒ–æ“ä½œï¼Œæ‰èƒ½æ„å»ºæˆå¯è¿è¡Œçš„çš„ç¨‹åºï¼Œè¿™éƒ¨åˆ†ä»£ç çš„ä¿®æ”¹æ˜¯åœ¨æ‰€éš¾å…çš„ã€‚æˆ‘ä»¬è¦åšçš„æ˜¯å°½é‡è®©ä¿®æ”¹æ“ä½œæ›´é›†ä¸­ã€æ›´å°‘ã€æ›´ä¸Šå±‚ï¼Œå°½é‡è®©æœ€æ ¸å¿ƒã€æœ€å¤æ‚çš„é‚£éƒ¨åˆ†é€»è¾‘ä»£ç æ»¡è¶³å¼€é—­åŸåˆ™ã€‚</p><p>åœ¨å†™ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦å¤šèŠ±ç‚¹æ—¶é—´å¾€å‰å¤šæ€è€ƒä¸€ä¸‹ï¼Œè¿™æ®µä»£ç æœªæ¥å¯èƒ½æœ‰å“ªäº›éœ€æ±‚å˜æ›´ã€å¦‚ä½•è®¾è®¡ä»£ç ç»“æ„ï¼Œäº‹å…ˆç•™å¥½æ‰©å±•ç‚¹ï¼Œä»¥ä¾¿åœ¨æœªæ¥éœ€æ±‚å˜æ›´çš„æ—¶å€™ï¼Œä¸éœ€è¦æ”¹åŠ¨ä»£ç æ•´ä½“ç»“æ„ã€åšåˆ°æœ€å°ä»£ç æ”¹åŠ¨çš„æƒ…å†µä¸‹ï¼Œæ–°çš„ä»£ç èƒ½å¤Ÿå¾ˆçµæ´»åœ°æ’å…¥åˆ°æ‰©å±•ç‚¹ä¸Šï¼Œåšåˆ°â€œå¯¹æ‰©å±•å¼€æ”¾ã€å¯¹ä¿®æ”¹å…³é—­â€ã€‚</p><p>æœ€å¸¸ç”¨æ¥æé«˜ä»£ç æ‰©å±•æ€§çš„æ–¹æ³•æœ‰ï¼šå¤šæ€ã€ä¾èµ–æ³¨å…¥ã€åŸºäºæ¥å£è€Œéå®ç°ç¼–ç¨‹ã€‚</p><p>é‡Œå¼æ›¿æ¢åŸåˆ™ï¼ˆLiskov Substitution Principleï¼‰ï¼Œå­ç±»å¯¹è±¡ï¼ˆobject of subtype&#x2F;derived classï¼‰èƒ½å¤Ÿæ›¿æ¢ç¨‹åºï¼ˆprogramï¼‰ä¸­çˆ¶ç±»å¯¹è±¡ï¼ˆobject of base&#x2F;parent classï¼‰å‡ºç°çš„ä»»ä½•åœ°æ–¹ï¼Œå¹¶ä¸”ä¿è¯åŸæ¥ç¨‹åºçš„é€»è¾‘è¡Œä¸ºï¼ˆbehaviorï¼‰ä¸å˜åŠæ­£ç¡®æ€§ä¸è¢«ç ´åã€‚</p><p>å¤šæ€æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸€å¤§ç‰¹æ€§ï¼Œä¹Ÿæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€çš„ä¸€ç§è¯­æ³•ã€‚å®ƒæ˜¯ä¸€ç§ä»£ç å®ç°çš„æ€è·¯ã€‚è€Œé‡Œå¼æ›¿æ¢æ˜¯ä¸€ç§è®¾è®¡åŸåˆ™ï¼Œæ˜¯ç”¨æ¥æŒ‡å¯¼ç»§æ‰¿å…³ç³»ä¸­å­ç±»è¯¥å¦‚ä½•è®¾è®¡çš„ï¼Œå­ç±»çš„è®¾è®¡è¦ä¿è¯åœ¨æ›¿æ¢çˆ¶ç±»çš„æ—¶å€™ï¼Œä¸æ”¹å˜åŸæœ‰ç¨‹åºçš„é€»è¾‘ä»¥åŠä¸ç ´ååŸæœ‰ç¨‹åºçš„æ­£ç¡®æ€§ã€‚</p><p>å‡ ä¸ªè¿åé‡Œå¼æ›¿æ¢åŸåˆ™çš„ä¾‹å­ï¼š</p><ul><li>å­ç±»è¿èƒŒçˆ¶ç±»å£°æ˜è¦å®ç°çš„åŠŸèƒ½</li><li>å­ç±»è¿èƒŒçˆ¶ç±»å¯¹è¾“å…¥ã€è¾“å‡ºã€å¼‚å¸¸çš„çº¦å®š</li><li>å­ç±»è¿èƒŒçˆ¶ç±»æ³¨é‡Šä¸­æ‰€ç½—åˆ—çš„ä»»ä½•ç‰¹æ®Šè¯´æ˜</li></ul><p>æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Principleï¼‰ï¼Œå®¢æˆ·ç«¯ä¸åº”è¯¥è¢«å¼ºè¿«ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£ã€‚</p><p>å¦‚æœéƒ¨åˆ†æ¥å£åªè¢«éƒ¨åˆ†è°ƒç”¨è€…ä½¿ç”¨ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦å°†è¿™éƒ¨åˆ†æ¥å£éš”ç¦»å‡ºæ¥ï¼Œå•ç‹¬ç»™å¯¹åº”çš„è°ƒç”¨è€…ä½¿ç”¨ï¼Œè€Œä¸æ˜¯å¼ºè¿«å…¶ä»–è°ƒç”¨è€…ä¹Ÿä¾èµ–è¿™éƒ¨åˆ†ä¸ä¼šè¢«ç”¨åˆ°çš„æ¥å£ã€‚</p><p>å‡½æ•°çš„è®¾è®¡è¦åŠŸèƒ½å•ä¸€ï¼Œä¸è¦å°†å¤šä¸ªä¸åŒçš„åŠŸèƒ½é€»è¾‘åœ¨ä¸€ä¸ªå‡½æ•°ä¸­å®ç°ã€‚</p><p>æ¥å£éš”ç¦»åŸåˆ™æä¾›äº†ä¸€ç§åˆ¤æ–­æ¥å£çš„èŒè´£æ˜¯å¦å•ä¸€çš„æ ‡å‡†ï¼šé€šè¿‡è°ƒç”¨è€…å¦‚ä½•ä½¿ç”¨æ¥å£æ¥é—´æ¥åœ°åˆ¤å®šã€‚å¦‚æœè°ƒç”¨è€…åªä½¿ç”¨éƒ¨åˆ†æ¥å£æˆ–æ¥å£çš„éƒ¨åˆ†åŠŸèƒ½ï¼Œé‚£æ¥å£çš„è®¾è®¡å°±ä¸å¤ŸèŒè´£å•ä¸€ã€‚</p><p>ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependency Inversion Principleï¼‰ï¼Œé«˜å±‚æ¨¡å—ï¼ˆhigh-level modulesï¼‰ä¸è¦ä¾èµ–ä½å±‚æ¨¡å—ï¼ˆlow-levelï¼‰ã€‚é«˜å±‚æ¨¡å—å’Œä½å±‚æ¨¡å—åº”è¯¥é€šè¿‡æŠ½è±¡ï¼ˆabstractionsï¼‰æ¥äº’ç›¸ä¾èµ–ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒæŠ½è±¡ï¼ˆabstractionsï¼‰ä¸è¦ä¾èµ–å…·ä½“å®ç°ç»†èŠ‚ï¼ˆdetailsï¼‰ï¼Œå…·ä½“å®ç°ç»†èŠ‚ï¼ˆdetailsï¼‰ä¾èµ–æŠ½è±¡ï¼ˆabstractionsï¼‰ã€‚</p><p>â€œæ§åˆ¶åè½¬â€ï¼šåœ¨ä½¿ç”¨æ¡†æ¶ä¹‹åï¼Œæ•´ä¸ªç¨‹åºçš„æ‰§è¡Œæµç¨‹é€šè¿‡æ¡†æ¶æ¥æ§åˆ¶ã€‚æµç¨‹çš„æ§åˆ¶æƒä»ç¨‹åºå‘˜â€œåè½¬â€ç»™äº†æ¡†æ¶ã€‚æ¡†æ¶æä¾›äº†ä¸€ä¸ªå¯æ‰©å±•çš„ä»£ç éª¨æ¶ï¼Œç”¨æ¥ç»„è£…å¯¹è±¡ã€ç®¡ç†æ•´ä¸ªæ‰§è¡Œæµç¨‹ã€‚ç¨‹åºå‘˜åˆ©ç”¨æ¡†æ¶è¿›è¡Œå¼€å‘çš„æ—¶å€™ï¼Œåªéœ€è¦å¾€é¢„ç•™çš„æ‰©å±•ç‚¹ä¸Šï¼Œæ·»åŠ è·Ÿè‡ªå·±ä¸šåŠ¡ç›¸å…³çš„ä»£ç ï¼Œå°±å¯ä»¥åˆ©ç”¨æ¡†æ¶æ¥é©±åŠ¨æ•´ä¸ªç¨‹åºæµç¨‹çš„æ‰§è¡Œã€‚</p><p>â€œä¾èµ–æ³¨å…¥â€ï¼šä¸é€šè¿‡ new çš„æ–¹å¼åœ¨ç±»å†…éƒ¨åˆ›å»ºä¾èµ–ç±»çš„å¯¹è±¡ï¼Œè€Œæ˜¯å°†ä¾èµ–çš„ç±»å¯¹è±¡åœ¨å¤–éƒ¨åˆ›å»ºå¥½ä¹‹åï¼Œé€šè¿‡æ„é€ å‡½æ•°ã€å‡½æ•°å‚æ•°ç­‰æ–¹å¼ä¼ é€’ï¼ˆæˆ–æ³¨å…¥ï¼‰ç»™ç±»æ¥ä½¿ç”¨ã€‚</p><h2 id="KISSã€YAGNI"><a href="#KISSã€YAGNI" class="headerlink" title="KISSã€YAGNI"></a>KISSã€YAGNI</h2><p>å‡ ä¸ªç®€å•çš„åŸåˆ™ï¼š</p><p>ä¸è¦ä½¿ç”¨åŒäº‹å¯èƒ½ä¸æ‡‚çš„æŠ€æœ¯æ¥å®ç°ä»£ç ã€‚</p><p>ä¸è¦é‡å¤é€ è½®å­ï¼Œè¦å–„äºä½¿ç”¨å·²ç»æœ‰çš„å·¥å…·ç±»åº“ã€‚ç»éªŒè¯æ˜ï¼Œè‡ªå·±å»å®ç°è¿™äº›ç±»åº“ï¼Œå‡º bug çš„æ¦‚ç‡ä¼šæ›´é«˜ï¼Œç»´æŠ¤çš„æˆæœ¬ä¹Ÿæ¯”è¾ƒé«˜ã€‚</p><p>ä¸è¦è¿‡åº¦ä¼˜åŒ–ã€‚</p><h2 id="DRYï¼šä»€ä¹ˆæ˜¯é‡å¤ï¼Œæ€ä¹ˆå®šä¹‰é‡å¤"><a href="#DRYï¼šä»€ä¹ˆæ˜¯é‡å¤ï¼Œæ€ä¹ˆå®šä¹‰é‡å¤" class="headerlink" title="DRYï¼šä»€ä¹ˆæ˜¯é‡å¤ï¼Œæ€ä¹ˆå®šä¹‰é‡å¤"></a>DRYï¼šä»€ä¹ˆæ˜¯é‡å¤ï¼Œæ€ä¹ˆå®šä¹‰é‡å¤</h2><p>å®ç°é€»è¾‘é‡å¤ã€åŠŸèƒ½è¯­ä¹‰é‡å¤å’Œä»£ç æ‰§è¡Œé‡å¤ã€‚</p><p>å®ç°é€»è¾‘é‡å¤ï¼šä»£ç çš„å®ç°é€»è¾‘æ˜¯ç›¸åŒçš„ï¼Œä½†è¯­ä¹‰ä¸åŒï¼Œæˆ‘ä»¬åˆ¤å®šå®ƒå¹¶ä¸è¿å DRY åŸåˆ™ã€‚å¯¹äºåŒ…å«é‡å¤ä»£ç çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŠ½è±¡æˆæ›´ç»†ç²’åº¦å‡½æ•°çš„æ–¹å¼æ¥è§£å†³ã€‚</p><p>åŠŸèƒ½è¯­ä¹‰é‡å¤ï¼šä»£ç çš„å®ç°é€»è¾‘ä¸é‡å¤ï¼Œä½†è¯­ä¹‰é‡å¤ï¼Œä¹Ÿå°±æ˜¯åŠŸèƒ½é‡å¤ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒè¿åäº† DRY åŸåˆ™ã€‚</p><p>ä»£ç æ‰§è¡Œé‡å¤ï¼šç›¸åŒçš„ä»£ç çš„å®ç°é€»è¾‘é‡å¤çš„æ‰§è¡Œäº†ä¸¤æ¬¡ã€‚</p><p>ä»£ç çš„å¤ç”¨æ€§æ˜¯è¯„åˆ¤ä»£ç è´¨é‡çš„ä¸€ä¸ªéå¸¸é‡è¦çš„æ ‡å‡†ã€‚æé«˜ä»£ç å¯å¤ç”¨æ€§çš„ä¸€äº›æ–¹æ³•ï¼š</p><p>å‡å°‘ä»£ç è€¦åˆï¼šé«˜åº¦è€¦åˆçš„ç±»æˆ–è€…å‡½æ•°å¾€å¾€ç§»åŠ¨ä¸€ç‚¹ä»£ç ï¼Œå°±è¦ç‰µè¿åˆ°å¾ˆå¤šå…¶ä»–ç›¸å…³çš„ä»£ç ã€‚é«˜åº¦è€¦åˆçš„ä»£ç ä¼šå½±å“åˆ°ä»£ç çš„å¤ç”¨æ€§ï¼Œæˆ‘ä»¬è¦å°½é‡å‡å°‘ä»£ç è€¦åˆã€‚</p><p>æ»¡è¶³å•ä¸€èŒè´£åŸåˆ™ï¼šå¤§è€Œå…¨çš„ç±»ä¾èµ–å®ƒçš„ä»£ç æˆ–è€…å®ƒä¾èµ–çš„ä»£ç å°±ä¼šæ¯”è¾ƒå¤šï¼Œéš¾ä»¥å¤ç”¨ã€‚è¶Šç»†ç²’åº¦çš„ä»£ç ï¼Œä»£ç çš„é€šç”¨æ€§ä¼šè¶Šå¥½ï¼Œè¶Šå®¹æ˜“è¢«å¤ç”¨ã€‚</p><p>æ¨¡å—åŒ–ä¸šåŠ¡ä¸éä¸šåŠ¡é€»è¾‘åˆ†ç¦»ï¼šè¶Šæ˜¯è·Ÿä¸šåŠ¡æ— å…³çš„ä»£ç è¶Šæ˜¯å®¹æ˜“å¤ç”¨ï¼Œè¶Šæ˜¯é’ˆå¯¹ç‰¹å®šä¸šåŠ¡çš„ä»£ç è¶Šéš¾å¤ç”¨ã€‚</p><p>é€šç”¨ä»£ç ä¸‹æ²‰ï¼šè¶Šåº•å±‚çš„ä»£ç è¶Šé€šç”¨ã€ä¼šè¢«è¶Šå¤šçš„æ¨¡å—è°ƒç”¨ï¼Œè¶Šåº”è¯¥è®¾è®¡å¾—è¶³å¤Ÿå¯å¤ç”¨ã€‚</p><p>ç»§æ‰¿ã€å¤šæ€ã€æŠ½è±¡ã€å°è£…ï¼šè¶ŠæŠ½è±¡ã€è¶Šä¸ä¾èµ–å…·ä½“çš„å®ç°ï¼Œè¶Šå®¹æ˜“å¤ç”¨ã€‚ä»£ç å°è£…æˆæ¨¡å—ï¼Œéšè—å¯å˜çš„ç»†èŠ‚ã€æš´éœ²ä¸å˜çš„æ¥å£ï¼Œå°±è¶Šå®¹æ˜“å¤ç”¨ã€‚</p><p>Rule of threeï¼šç¬¬ä¸€æ¬¡ç”¨åˆ°æŸä¸ªåŠŸèƒ½æ—¶ï¼Œä½ å†™ä¸€ä¸ªç‰¹å®šçš„è§£å†³æ–¹æ³•ï¼›ç¬¬äºŒæ¬¡åˆç”¨åˆ°çš„æ—¶å€™ï¼Œä½ æ‹·è´ä¸Šä¸€æ¬¡çš„ä»£ç ï¼›ç¬¬ä¸‰æ¬¡å‡ºç°çš„æ—¶å€™ï¼Œä½ æ‰ç€æ‰‹â€æŠ½è±¡åŒ–â€ï¼Œå†™å‡ºé€šç”¨çš„è§£å†³æ–¹æ³•ã€‚</p><p>è¿™æ ·åšæœ‰å‡ ä¸ªç†ç”±ï¼š</p><p>ï¼ˆ1ï¼‰çœäº‹ã€‚å¦‚æœä¸€ç§åŠŸèƒ½åªæœ‰ä¸€åˆ°ä¸¤ä¸ªåœ°æ–¹ä¼šç”¨åˆ°ï¼Œå°±ä¸éœ€è¦åœ¨â€æŠ½è±¡åŒ–â€ä¸Šé¢è€—è´¹æ—¶é—´äº†ã€‚</p><p>ï¼ˆ2ï¼‰å®¹æ˜“å‘ç°æ¨¡å¼ã€‚â€æŠ½è±¡åŒ–â€éœ€è¦æ‰¾åˆ°é—®é¢˜çš„æ¨¡å¼ï¼Œé—®é¢˜å‡ºç°çš„åœºåˆè¶Šå¤šï¼Œå°±è¶Šå®¹æ˜“çœ‹å‡ºæ¨¡å¼ï¼Œä»è€Œå¯ä»¥æ›´å‡†ç¡®åœ°â€æŠ½è±¡åŒ–â€ã€‚</p><h2 id="LODï¼šLaw-of-Demeter"><a href="#LODï¼šLaw-of-Demeter" class="headerlink" title="LODï¼šLaw of Demeter"></a>LODï¼šLaw of Demeter</h2><p>è§„åˆ™ä¸€ï¼šä¸è¯¥æœ‰ç›´æ¥ä¾èµ–å…³ç³»çš„ç±»ä¹‹é—´ï¼Œä¸è¦æœ‰ä¾èµ–ã€‚</p><p>è§„åˆ™äºŒï¼šæœ‰ä¾èµ–å…³ç³»çš„ç±»ä¹‹é—´ï¼Œå°½é‡åªä¾èµ–å¿…è¦çš„æ¥å£ã€‚</p><p>è¿ªç±³ç‰¹æ³•åˆ™æ˜¯å¸Œæœ›å‡å°‘ç±»ä¹‹é—´çš„è€¦åˆï¼Œè®©ç±»è¶Šç‹¬ç«‹è¶Šå¥½ã€‚æ¯ä¸ªç±»éƒ½åº”è¯¥å°‘äº†è§£ç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†ã€‚</p><p>å…³äºLoDï¼Œè¯·è®°ä½ä¸€æ¡ï¼šæ–¹æ³•ä¸­ä¸è¦ä½¿ç”¨ChainMethodsã€‚chainä¸­æŸä¸€ä¸ªæ–¹æ³•çš„æ”¹åŠ¨ä¼šå¯¼è‡´æ•´ä¸ªchainå—åˆ°å½±å“ã€‚</p><p>åçš„å®è·µï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">Amount = customer.orders().last().totals().amount()<br><span class="hljs-comment">// or</span><br>orders = customer.orders()<br>lastOders = orders.last()<br>totals = lastOders.totals()<br>amount = totals.amount()<br></code></pre></td></tr></table></figure><p>LoDå¦‚ä½•ä½¿ç”¨ï¼š<br>ä¸€ä¸ªç±»ä¸­çš„æ–¹æ³•åªèƒ½è°ƒç”¨ï¼š<br>1ã€è¯¥ç±»ä¸­å…¶ä»–å®ä¾‹æ–¹æ³•ã€‚<br>2ã€å®ƒè‡ªå·±çš„å‚æ•°æ–¹æ³•ã€‚<br>3ã€å®ƒåˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ã€‚<br>4ã€ä¸è¦è°ƒç”¨å…¨å±€å˜é‡ï¼ˆåŒ…æ‹¬å¯å˜å¯¹è±¡ã€å¯å˜å•ä¾‹ï¼‰ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HtmlDownloader</span>&#123;<br>    Html html;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">downloadHtml</span><span class="hljs-params">(Transporter trans, String url)</span>&#123;<br><span class="hljs-keyword">if</span>(checkUrl(url))&#123;<span class="hljs-comment">// ok è‡ªå·±çš„å®ä¾‹æ–¹æ³•</span><br><span class="hljs-comment">// return</span><br>&#125;<br>rawData = trans.send(uri);<span class="hljs-comment">// ok å‚æ•°å¯¹è±¡çš„æ–¹æ³•</span><br><span class="hljs-type">Html</span> <span class="hljs-variable">html</span> <span class="hljs-operator">=</span> createHtml(rawData); <span class="hljs-comment">// ok å®ƒåˆ›å»ºçš„å¯¹è±¡</span><br>html.save();<span class="hljs-comment">// ok  å®ƒåˆ›å»ºå¯¹è±¡çš„æ–¹æ³•</span><br>    &#125;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">checkUrl</span><span class="hljs-params">(String url)</span> &#123;<br><span class="hljs-comment">// check</span><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ç»†èŠ‚æ˜¯é­”é¬¼"><a href="#ç»†èŠ‚æ˜¯é­”é¬¼" class="headerlink" title="ç»†èŠ‚æ˜¯é­”é¬¼"></a>ç»†èŠ‚æ˜¯é­”é¬¼</h1><h2 id="å‘½å"><a href="#å‘½å" class="headerlink" title="å‘½å"></a>å‘½å</h2><p>åœ¨è¶³å¤Ÿè¡¨è¾¾å…¶å«ä¹‰çš„æƒ…å†µä¸‹ï¼Œå‘½åå½“ç„¶æ˜¯è¶ŠçŸ­è¶Šå¥½ã€‚å¯ä»¥åˆ©ç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯æ¥ç®€åŒ–å‘½åã€‚</p><p>å‘½åè¦é¿å…è¯¯å¯¼ã€‚</p><p>å‘½åè¦å¯è¯»ã€å¯æœç´¢ã€‚</p><p>ç±»åå’Œå¯¹è±¡ååº”è¯¥æ˜¯åè¯æˆ–åè¯çŸ­è¯­ï¼Œæ–¹æ³•ååº”å½“æ˜¯åŠ¨è¯æˆ–åŠ¨è¯çŸ­è¯­ã€‚</p><p>ç»Ÿä¸€å‘½åè§„åˆ™ã€‚</p><p>ä¾‹å¦‚å¯¹äºæ¥å£çš„å‘½åæœ‰äººä¹ æƒ¯äºåœ¨å‰é¢åŠ ä¸Šâ€œIâ€ï¼Œæœ‰äººä¹ æƒ¯äºä¸åŠ  â€œIâ€ï¼Œè€Œæ˜¯åœ¨å®ç°ç±»ä¸ŠåŠ ä¸ŠImplã€‚è¿™ç§åœ¨é¡¹ç›®ä¸­æœ€å¥½ä¿æŒä¸€è‡´ã€‚</p><h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><p>åœ¨ä»£ç æ— æ³•è¡¨è¾¾å‡ºæ¸…æ™°çš„æ„å›¾ï¼Œè€Œéœ€è¦è¡¥å……é¢å¤–çš„ä¿¡æ¯æ—¶æ‰éœ€è¦æ³¨é‡Šã€‚æ³¨é‡Šå­˜åœ¨çš„æ—¶é—´è¶Šä¹…ï¼Œå°±ç¦»å…¶æ‰€æè¿°çš„ä»£ç è¶Šè¿œï¼Œè¶Šæ¥è¶Šå˜å¾—å…¨ç„¶é”™è¯¯ã€‚å®é™…ä¸­æˆ‘ä»¬å¾ˆéš¾åŒæ­¥ä¿®æ”¹ä»£ç ä»¥åŠä»£ç ä¸Šçš„æ³¨é‡Šï¼Œä»è€Œæ— æ³•ä¿è¯ä»£ç å’Œæ³¨é‡Šå§‹ç»ˆè¡¨è¾¾ç›¸åŒçš„æ„æ€ã€‚æ‰€ä»¥å°½ç®¡éœ€è¦æ³¨é‡Šï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿåº”è¯¥è¦å°½é‡å‡å°‘æ³¨é‡Šé‡ã€‚</p><p>åçš„æ³¨é‡Šï¼š</p><ul><li>å¤šä½™çš„æ³¨é‡Š</li><li>åºŸè¯å‹æ³¨é‡Š</li><li>å¯¹æ¯ä¸ªå˜é‡åéƒ½è¿›è¡Œæ³¨é‡Š</li><li>è¡¨è¾¾ â€œæ˜¯ä»€ä¹ˆâ€çš„æ³¨é‡Š</li><li>æ¯ä¸ªç±»ä¸Šçš„å½’å±ä¸ç½²åç±»çš„æ³¨é‡Š</li><li>æ³¨é‡Šæ‰çš„ä»£ç </li></ul><p>å¥½çš„æ³¨é‡Šï¼š</p><ul><li>å¯¹ä»£ç æ„å›¾çš„è§£é‡Šæˆ–è¡¥å……å‹æ³¨é‡Š</li><li>è­¦ç¤ºå‹æ³¨é‡Š</li><li>TODO æ³¨é‡Š</li></ul><p>æ³¨é‡Šçš„å†…å®¹ä¸»è¦åŒ…å«è¿™æ ·ä¸‰ä¸ªæ–¹é¢ï¼šåšä»€ä¹ˆã€ä¸ºä»€ä¹ˆã€æ€ä¹ˆåšã€‚å¯¹äºä¸€äº›å¤æ‚çš„ç±»å’Œæ¥å£ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜éœ€è¦å†™æ˜â€œå¦‚ä½•ç”¨â€ã€‚</p><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><p>å‡½æ•°è¶ŠçŸ­å°è¶Šå¥½ã€‚ä¸€ä¸ªå‡½æ•°åªåšä¸€ä»¶äº‹ã€‚</p><p>å°†å¤§å‡½æ•°ä¸­çš„ä»£ç åˆ†å‰²æˆå°çš„ä»£ç å—ï¼Œå¹¶ä¿è¯å‡½æ•°ä¸­çš„è¯­å¥éƒ½è¦åœ¨åŒä¸€æŠ½è±¡å±‚çº§ä¸Šã€‚ç›¸åŒæŠ½è±¡å±‚çº§çš„å‡½æ•°åº”è¯¥æ”¾åˆ°ä¸€èµ·ã€‚å‡½æ•°ä¸­æ··æ‚ä¸åŒæŠ½è±¡å±‚çº§ï¼Œå¾€å¾€è®©äººè¿·æƒ‘ã€‚</p><p>å‡½æ•°å‚æ•°ï¼šæœ€ç†æƒ³çš„å‚æ•°æ•°é‡æ˜¯é›¶ï¼ˆé›¶å‚æ•°å‡½æ•°ï¼‰ï¼Œå…¶æ¬¡æ˜¯ä¸€ï¼ˆå•å‚æ•°å‡½æ•°ï¼‰ï¼Œå†æ¬¡æ˜¯äºŒï¼ˆåŒå‚æ•°å‡½æ•°ï¼‰ï¼Œåº”å°½é‡é¿å…ä¸‰ï¼ˆä¸‰å‚æ•°å‡½æ•°ï¼‰ã€‚æœ‰è¶³å¤Ÿç‰¹æ®Šçš„ç†ç”±æ‰èƒ½ç”¨ä¸‰ä¸ªä»¥ä¸Šå‚æ•°ï¼ˆå¤šå‚æ•°å‡½æ•°ï¼‰ã€‚å‡½æ•°åŒ…å« 3ã€4 ä¸ªå‚æ•°çš„æ—¶å€™è¿˜æ˜¯èƒ½æ¥å—çš„ï¼Œå¤§äºç­‰äº 5 ä¸ªçš„æ—¶å€™ï¼Œä¼šå½±å“åˆ°ä»£ç çš„å¯è¯»æ€§ã€‚</p><p>å¯¹äºè¿‡å¤šå‚æ•°å‡½æ•°çš„å¤„ç†æ–¹æ³•ï¼š</p><ul><li>è€ƒè™‘å‡½æ•°æ˜¯å¦èŒè´£å•ä¸€ï¼Œæ˜¯å¦èƒ½é€šè¿‡æ‹†åˆ†æˆå¤šä¸ªå‡½æ•°çš„æ–¹å¼æ¥å‡å°‘å‚æ•°ã€‚</li><li>å°†å‡½æ•°çš„å‚æ•°å°è£…æˆå¯¹è±¡ã€‚</li></ul><p>ä¸è¦ç”¨å‚æ•°æ¥æ§åˆ¶å‡½æ•°çš„é€»è¾‘ï¼š</p><p>ä¸è¦åœ¨å‡½æ•°ä¸­ä½¿ç”¨å¸ƒå°”ç±»å‹çš„æ ‡è¯†å‚æ•°æ¥æ§åˆ¶å†…éƒ¨é€»è¾‘ï¼Œtrue çš„æ—¶å€™èµ°è¿™å—é€»è¾‘ï¼Œfalse çš„æ—¶å€™èµ°å¦ä¸€å—é€»è¾‘ã€‚è¿™æ˜æ˜¾è¿èƒŒäº†å•ä¸€èŒè´£åŸåˆ™å’Œæ¥å£éš”ç¦»åŸåˆ™ã€‚å»ºè®®å°†å…¶æ‹†æˆä¸¤ä¸ªå‡½æ•°ï¼Œå¯è¯»æ€§ä¸Šä¹Ÿè¦æ›´å¥½ã€‚</p><p>å‡½æ•°çš„åµŒå¥—å±‚æ¬¡è¿‡æ·±ï¼šæœ€å¥½ä¸è¦è¶…è¿‡ä¸¤å±‚ã€‚</p><p>è§£å†³åµŒå¥—è¿‡æ·±çš„æ–¹æ³•ï¼š</p><p>ä½¿ç”¨ç¼–ç¨‹è¯­è¨€æä¾›çš„ continueã€breakã€return å…³é”®å­—ï¼Œæå‰é€€å‡ºåµŒå¥—ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (digitalEnable &amp;&amp; isDigitalHuman) &#123;<br><span class="hljs-keyword">return</span><br>&#125;<br>...<br></code></pre></td></tr></table></figure><p>è°ƒæ•´æ‰§è¡Œé¡ºåºæ¥å‡å°‘åµŒå¥—ï¼šå…ˆå†™å¼‚å¸¸é€»è¾‘ï¼Œå†å†™æ­£å¸¸é€»è¾‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (!useNewStrategy) &#123;<br><span class="hljs-literal">null</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>...<br>&#125;<br></code></pre></td></tr></table></figure><p>å°†éƒ¨åˆ†åµŒå¥—é€»è¾‘å°è£…æˆå‡½æ•°è°ƒç”¨ã€‚</p><h2 id="ç±»"><a href="#ç±»" class="headerlink" title="ç±»"></a>ç±»</h2><p>å•ä¸€æƒè´£åŸåˆ™ï¼ˆSRPï¼‰è®¤ä¸ºï¼Œç±»æˆ–æ¨¡å—åº”æœ‰ä¸”åªæœ‰ä¸€æ¡åŠ ä»¥ä¿®æ”¹çš„ç†ç”±ã€‚</p><p>ç³»ç»Ÿåº”è¯¥ç”±è®¸å¤šçŸ­å°çš„ç±»è€Œä¸æ˜¯å°‘é‡å·¨å¤§çš„ç±»ç»„æˆã€‚</p><p>ä¾èµ–ç£é“ï¼ˆdependency magnetï¼‰ç±»ï¼šå¸¸é‡ç±»ã€‚æˆ‘ä»¬æŠŠæ‰€æœ‰çš„å¸¸é‡éƒ½å®šä¹‰åˆ°ä¸€å¤„åœ°æ–¹ï¼Œå½“è¯¥å¸¸é‡ç±»ä¿®æ”¹æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„è¿™äº›å…¶ä»–çš„ç±»å’Œæ¨¡å—éƒ½éœ€è¦é‡æ–°ç¼–è¯‘å’Œéƒ¨ç½²ã€‚</p><p>å¯¹è±¡ ä¸æ•°æ®ç»“æ„ï¼š</p><p>å¯¹è±¡æŠŠæ•°æ®éšè—äºæŠ½è±¡ä¹‹åï¼Œæ›éœ²æ“ä½œæ•°æ®çš„å‡½æ•°ã€‚æ•°æ®ç»“æ„æ›éœ²å…¶æ•°æ®ï¼Œæ²¡æœ‰æä¾›æœ‰æ„ä¹‰çš„å‡½æ•°ã€‚</p><p>åœ¨ä»»ä½•ä¸€ä¸ªå¤æ‚ç³»ç»Ÿä¸­ï¼Œéƒ½ä¼šæœ‰éœ€è¦æ·»åŠ æ–°æ•°æ®ç±»å‹è€Œä¸æ˜¯æ–°å‡½æ•°çš„æ—¶å€™ã€‚è¿™æ—¶ï¼Œå¯¹è±¡å’Œé¢å‘å¯¹è±¡å°±æ¯”è¾ƒé€‚åˆã€‚å¦ä¸€æ–¹é¢ï¼Œä¹Ÿä¼šæœ‰æƒ³è¦æ·»åŠ æ–°å‡½æ•°è€Œä¸æ˜¯æ•°æ®ç±»å‹çš„æ—¶å€™ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿‡ç¨‹å¼ä»£ç å’Œæ•°æ®ç»“æ„æ›´åˆé€‚ã€‚</p><p>æ•°æ®ç»“æ„åªç®€å•åœ°æ‹¥æœ‰å…¬å…±å˜é‡ï¼Œæ²¡æœ‰å‡½æ•°ï¼Œè€Œå¯¹è±¡åˆ™æ‹¥æœ‰ç§æœ‰å˜é‡å’Œå…¬å…±å‡½æ•°ã€‚</p><p>æ–¹æ³•ä¸åº”è°ƒç”¨ç”±ä»»ä½•å‡½æ•°è¿”å›çš„å¯¹è±¡çš„æ–¹æ³•ã€‚</p><p>DTOæ˜¯éå¸¸æœ‰ç”¨çš„ç»“æ„ï¼Œå°¤å…¶æ˜¯åœ¨ä¸æ•°æ®åº“é€šä¿¡ã€æˆ–è§£æå¥—æ¥å­—ä¼ é€’çš„æ¶ˆæ¯ä¹‹ç±»åœºæ™¯ä¸­ã€‚æˆ‘ä»¬ä¸å¹¸ç»å¸¸å‘ç°å¼€å‘è€…å¾€è¿™ç±»æ•°æ®ç»“æ„ä¸­å¡è¿›ä¸šåŠ¡è§„åˆ™æ–¹æ³•ï¼ŒæŠŠè¿™ç±»æ•°æ®ç»“æ„å½“æˆå¯¹è±¡æ¥ç”¨ã€‚è¿™æ˜¯ä¸æ™ºçš„è¡Œä¸ºï¼Œå› ä¸ºå®ƒå¯¼è‡´äº†æ•°æ®ç»“æ„å’Œå¯¹è±¡çš„æ··æ‚ä½“ã€‚</p><h1 id="é‡æ„"><a href="#é‡æ„" class="headerlink" title="é‡æ„"></a>é‡æ„</h1><p>é‡æ„ç»å¯¹ä¸ç­‰äºå°†ä»£ç æ‹†åˆ†åˆ°ä¸åŒçš„æ–‡ä»¶ä¸­å»ã€‚</p><p>å¤§å‹é‡æ„çš„æ‰‹æ®µæœ‰ï¼šåˆ†å±‚ã€æ¨¡å—åŒ–ã€è§£è€¦ã€æŠ½è±¡å¯å¤ç”¨ç»„ä»¶ç­‰ç­‰</p><p>å°èŒƒå›´é‡æ„çš„æ‰‹æ®µï¼šä¸»è¦æ˜¯é’ˆå¯¹ç±»ã€å‡½æ•°ã€å˜é‡ç­‰ä»£ç çº§åˆ«çš„é‡æ„ï¼Œæ¯”å¦‚è§„èŒƒå‘½åã€è§„èŒƒæ³¨é‡Šã€æ¶ˆé™¤è¶…å¤§ç±»æˆ–å‡½æ•°ã€æå–é‡å¤ä»£ç ç­‰ç­‰ã€‚</p><p>æŒç»­é‡æ„æ„è¯†æ›´é‡è¦ã€‚æˆ‘ä»¬è¦æ­£ç¡®åœ°çœ‹å¾…ä»£ç è´¨é‡å’Œé‡æ„è¿™ä»¶äº‹æƒ…ã€‚æŠ€æœ¯åœ¨æ›´æ–°ã€éœ€æ±‚åœ¨å˜åŒ–ã€äººå‘˜åœ¨æµåŠ¨ï¼Œä»£ç è´¨é‡æ€»ä¼šåœ¨ä¸‹é™ï¼Œä»£ç æ€»ä¼šå­˜åœ¨ä¸å®Œç¾ï¼Œé‡æ„å°±ä¼šæŒç»­åœ¨è¿›è¡Œã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é©¬æœå¦‚æ­¤æ¶å¿ƒï¼Œå¦‚ä½•ç©ä¸ŠéŸ©æœDNFï¼Ÿ</title>
    <link href="/2024/06/30/%E9%A9%AC%E6%9C%8D%E5%A6%82%E6%AD%A4%E6%81%B6%E5%BF%83%EF%BC%8C%E5%A6%82%E4%BD%95%E7%8E%A9%E4%B8%8A%E9%9F%A9%E6%9C%8DDNF%EF%BC%9F/"/>
    <url>/2024/06/30/%E9%A9%AC%E6%9C%8D%E5%A6%82%E6%AD%A4%E6%81%B6%E5%BF%83%EF%BC%8C%E5%A6%82%E4%BD%95%E7%8E%A9%E4%B8%8A%E9%9F%A9%E6%9C%8DDNF%EF%BC%9F/</url>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202406302106765.jpeg" alt="é€‰è§’è‰²ç•Œé¢"></p><p>æœ€è¿‘ï¼Œå›½æœ DNF ä¸Šçº¿ï¼Œéå¸¸ç«çˆ†ï¼Œæƒ³ç©ç©çœ‹éŸ©æœæ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œç”±äºå›½å†…ç¯å¢ƒé—®é¢˜ï¼Œæƒ³ç©ä¸ŠéŸ©æœDNF è¿˜æ˜¯è¦è´¹ä¸Šä¸€ç•ªåŠŸå¤«çš„ã€‚è¿™é‡Œè®°å½•ä¸‹ Android è®¾å¤‡æ˜¯æ€ä¹ˆä¸‹è½½DNF æ¸¸æˆå®‰è£…åŒ…ä»¥åŠæ³¨å†Œ éŸ©æœ DNF è´¦å·çš„ã€‚</p><p>é¦–å…ˆï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªæœªç»‘å®šä»»ä½•åœ°åŒºçš„ google è´¦å·ã€‚</p><p>è´¦å·æ³¨å†Œéœ€è¦æµ·å¤–æ‰‹æœºå·ï¼Œè¿™é‡Œä½¿ç”¨ wild card æµ·å¤–æ‰‹æœºå· æ¥æ”¶æ³¨å†ŒéªŒè¯ç çš„åŠŸèƒ½ã€‚æŒ‡è·¯ï¼š<a href="https://wildcard.com.cn/sms">WildCard | ä¸€åˆ†é’Ÿæ³¨å†Œï¼Œè½»æ¾è®¢é˜…æµ·å¤–è½¯ä»¶æœåŠ¡</a></p><p>æ³¨å†Œå®Œæˆä¹‹åï¼Œè¿™é‡Œï¼Œä½ éœ€è¦ ä¸€ä¸ª æœ‰ google ä¸‰ä»¶å¥— çš„ android æ‰‹æœºã€‚è¿›å…¥åˆ° google play appï¼Œç™»å½•åˆšæ‰ æ³¨å†Œçš„ è´¦å·ã€‚ç„¶ååˆ‡æ¢åˆ° éŸ©å›½åœ°åŒºã€‚</p><p>åˆ‡æ¢åˆ°éŸ©å›½åœ°åŒºçš„å…·ä½“æ–¹å¼ï¼š</p><ol><li>é¦–å…ˆï¼Œç§‘å­¦ä¸Šç½‘é€‰æ‹©éŸ©å›½èŠ‚ç‚¹ã€‚</li><li>ç„¶åæ¸…ç©º google play app æ‰€æœ‰æ•°æ®ã€‚</li><li>ç„¶åç™»å½•åˆšæ‰æ³¨å†Œçš„è´¦å·ã€‚</li><li>ä¸è¦ç»‘å®šä»»ä½•ä¿¡ç”¨å¡ï¼Œ ä¸€æ—¦ç»‘å®šå°±é”åŒºäº†ï¼Œå°±åˆ‡æ¢ä¸åˆ°éŸ©å›½åœ°åŒºçš„ åº”ç”¨å•†åº—äº†ã€‚</li></ol><p>ä¾‹å¦‚, æƒ³è¦åˆ‡æ¢åˆ° éŸ©å›½åœ°åŒº,ä¸‹è½½ DNF æ‰‹æ¸¸ï¼š</p><p>ç¬¬ä¸€æ­¥, æ³¨å†Œä¸€ä¸ªå…¨æ–°çš„ google è´¦å·,</p><p>ç¬¬äºŒæ­¥ , è¿æ¥å¥½ éŸ©å›½èŠ‚ç‚¹ä»£ç†</p><p>ç¬¬ä¸‰æ­¥,æ¸…ç©º google play store çš„app æ‰€æœ‰æ•°æ®,</p><p>ç¬¬å››æ­¥,ç™»å½•google è´¦å·.</p><p>å³å¯æœåˆ° éŸ©å›½åœ°åŒºçš„æ¸¸æˆäº†.</p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202406302106441.jpeg" alt="Google Play App æ¸…ç©ºæ•°æ®" width="300"><p>DNF åœ¨ éŸ©å›½åœ°åŒº ä¸º 19+ æ¸¸æˆ, éœ€è¦ éŸ©å›½ id è¿›è¡Œå®åè®¤è¯ æ‰å¯ä»¥ä¸‹è½½. æˆ–è€… ä¸‹è½½ DNF 12+ æœªæˆå¹´ç‰ˆæœ¬.</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬ç›´æ¥ä¸‹è½½ 12+ ç‰ˆæœ¬ï¼Œæˆ–è€… ä½ å»æŸå®ä¸Šä¹°ä¸ª id ï¼Œè®¤è¯åä¸‹è½½ 19+ çš„ç‰ˆæœ¬ï¼Œè¿™ä¸¤ä¸ªç‰ˆæœ¬çš„ä¸»è¦åŒºåˆ«æ˜¯ äº¤æ˜“è¡Œçš„é™åˆ¶ï¼Œå…¶ä»–æ²¡åŒºåˆ«ï¼Œè€Œä¸”è´¦å·æ˜¯äº’é€šçš„ã€‚ä½“éªŒéŸ©æœï¼Œä¸‹è½½ 12+ç‰ˆæœ¬å°±è¡Œäº†ã€‚</p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202406302106929.jpeg" alt="éŸ©æœåœ°ä¸‹åŸ" width="300"><p>ç™»å½•æ—¶ï¼Œé€‰æ‹©ä½¿ç”¨ google è´¦å·ç™»å½•ã€‚</p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202406302106834.png" alt="Google ç™»å½•"></p><p>è¿™é‡Œ ä¸‹è½½å®Œæˆä¹‹åï¼Œä¼šé‡åˆ°ä¸€ä¸ªæ¶å¿ƒçš„é—®é¢˜ï¼š</p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202406302106383.png" alt="éæ³•åº”ç”¨"></p><p>è¿™æ—¶éœ€è¦ åœ¨ æƒé™è®¾ç½®ä¸­ï¼Œç¦ç”¨æ‰ dnf app è·å– æ‰‹æœºåº”ç”¨åˆ—è¡¨çš„æƒé™ï¼š</p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202406302107272.jpeg" alt="ç¦ç”¨æƒé™" width="300"><p>å®Œæˆä»¥ä¸Šæ­¥éª¤ä¹‹åï¼Œè¿æ¥å¥½ éŸ©å›½èŠ‚ç‚¹ï¼Œæ‰“å¼€ DNFï¼Œå°±å¯ä»¥æ„‰å¿«çš„æ¸¸æˆäº†ã€‚</p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202406302106508.jpeg" alt="æ¸¸æˆç•Œé¢"></p>]]></content>
    
    
    <categories>
      
      <category>å·¥ä½œä¹‹å¤–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è´¦å·é—®é¢˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android Keyboard é«˜åº¦ç›‘å¬å®è·µ</title>
    <link href="/2024/06/30/Android-Keyboard-%E9%AB%98%E5%BA%A6%E7%9B%91%E5%90%AC%E5%AE%9E%E8%B7%B5/"/>
    <url>/2024/06/30/Android-Keyboard-%E9%AB%98%E5%BA%A6%E7%9B%91%E5%90%AC%E5%AE%9E%E8%B7%B5/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘é‡åˆ°ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦è¾“å…¥æ¡†å¸ƒå±€é™„ç€åœ¨è½¯é”®ç›˜ä¸Šé¢ï¼Œéšç€è½¯é”®ç›˜çš„ä¸Šç§»ä¸‹ç§»åŠ¨ç”»è€Œç§»åŠ¨ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œéœ€è¦ç›‘å¬é”®ç›˜çš„é«˜åº¦ï¼Œè€Œä¸”æœ€å¥½æ˜¯åœ¨é”®ç›˜å¼¹èµ·çš„æ—¶å€™ï¼Œæ¯ä¸€å¸§éƒ½æœ‰ä¸€ä¸ªé«˜åº¦çš„å›è°ƒï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬ç›‘å¬é”®ç›˜é«˜åº¦çš„å˜åŒ–ï¼Œå¯¹æˆ‘ä»¬çš„è¾“å…¥æ¡†å¸ƒå±€åštransYåŠ¨ç”» ï¼Œå³å¯å®ç° è¾“å…¥æ¡†é™„ç€åœ¨é”®ç›˜ä¹‹ä¸Šéšä¹‹ä¸Šä¸‹ç§»åŠ¨çš„åŠ¨ç”»æ•ˆæœäº†ã€‚</p><p>æƒ³è¦å®ç°çš„æ•ˆæœï¼š</p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202406302022019.gif" alt="æ•ˆæœå›¾"></p><p>ä½†æ˜¯ï¼Œç»è¿‡å¯¹android é”®ç›˜é«˜åº¦ç›‘å¬ç›¸å…³æ–¹æ³•çš„äº†è§£ï¼Œå‘ç°äº‹æƒ…å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•ã€‚</p><p>Android ç›‘å¬é”®ç›˜é«˜åº¦ éå¸¸å¤æ‚ã€‚è€Œä¸”ï¼Œæœ‰å¤šç§æ–¹å¼å¯ä»¥å®ç°ï¼Œå¹¶ä¸”å¯¹äºä¸åŒçš„ Android ç‰ˆæœ¬ï¼Œå…¶å®ç°æ–¹å¼ä¹Ÿå„ä¸ç›¸åŒã€‚è€Œä¸”ï¼Œç”±äºAndroid æœºå‹ã€ç‰ˆæœ¬ä¼—å¤šï¼Œæ¥è‡ªä¸åŒå“ç‰Œã€ä¸åŒç±»å‹ã€ä¸åŒç‰ˆæœ¬çš„android  æ‰‹æœºï¼Œç›¸åŒçš„ä»£ç å¯èƒ½æœ‰ä¸åŒçš„è¡¨ç°ã€‚</p><p>åœ¨å¾ˆæ—©ä¹‹å‰ï¼Œå¤§å®¶éƒ½æ˜¯ç”¨ getViewTreeObserver().addOnGlobalLayoutListener  æ‹¿åˆ°Activityçš„ContentViewï¼Œè®¾ç½®<code>contentView.getViewTreeObserver()                 .addOnGlobalLayoutListener(onGlobalLayoutListener);</code></p><p>ç„¶ååœ¨ç›‘å¬å†…éƒ¨å†é€šè¿‡ <code>decorView.getWindowVisibleDisplayFrame</code>æ¥è·å–æ˜¾ç¤ºçš„Rectï¼Œå†é€šè¿‡ <code>decorView.getBottom() - outRect.bottom</code>çš„æ–¹å¼æ¥è·å–é«˜åº¦ã€‚æˆ–è€…æ˜¯ é€šè¿‡ æ·»åŠ ä¸€ä¸ªå®½åº¦ä¸º0ï¼Œé«˜åº¦æ’‘æ»¡å…¨å±çš„ PopupWindow çš„éªšæ“ä½œæ¥è·å–é”®ç›˜çš„é«˜åº¦ï¼Œè®©è½¯é”®ç›˜å¼¹èµ·çš„æ—¶å€™ï¼Œè®¡ç®—PopopWindowç§»åŠ¨äº†å¤šå°‘èŒƒå›´ï¼Œä»è€Œè®¡ç®—è½¯é”®ç›˜çš„é«˜åº¦ã€‚è€Œå…¶ä¸­çš„å…³é”®å°±æ˜¯å½“è¾“å…¥æ³•å¼¹å‡ºæ—¶ï¼Œ å®ƒä¼šæŠŠä¹‹å‰æˆ‘ä»¬åˆ›å»ºçš„é‚£ä¸ªçœ‹ä¸è§çš„å¼¹çª—å¾€ä¸ŠæŒ¤ï¼Œ è¿™æ ·æˆ‘ä»¬åˆ›å»ºçš„é‚£ä¸ªå¼¹çª—çš„ä½ç½®å°±å˜åŒ–äº†ï¼Œåªè¦è·å–å®ƒåº•éƒ¨é«˜åº¦çš„å˜åŒ–å€¼å°±å¯ä»¥é—´æ¥çš„è·å–è¾“å…¥æ³•çš„é«˜åº¦äº†ã€‚</p><p>ä¸‹é¢ï¼Œç®€å•ä»‹ç»ä¸‹ï¼Œåœ¨ android ä¸­ ï¼Œè·å–é”®ç›˜é«˜åº¦çš„æœ€æ–°æ–¹å¼ã€‚åœ¨ Android R ï¼ˆAndroid 11 ï¼ŒAPI 30ï¼‰ç‰ˆæœ¬ä¸­ï¼Œæä¾›äº† WindowInsets ç›¸å…³APIï¼Œæ–°å¢äº†<code>WindowInsetsAnimation.Callback</code> å›è°ƒæ–¹æ³•ã€‚ </p><p>ä»€ä¹ˆæ˜¯ Insetsï¼Ÿ</p><p>å±å¹•ä¸Šé™¤äº†å¼€å‘è€… app ç»˜åˆ¶çš„å†…å®¹è¿˜æœ‰ç³»ç»Ÿçš„ Insetsï¼ˆåµŒå…¥ç‰©ï¼‰ï¼ŒInsets åŒºåŸŸè´Ÿè´£æè¿°å±å¹•çš„å“ªäº›éƒ¨åˆ†ä¼šä¸ç³»ç»Ÿ UI ç›¸äº¤ã€‚ä¾‹å¦‚å¯¼èˆªæˆ–çŠ¶æ€æ ã€‚</p><p>å¸¸è§çš„ Insets æœ‰ï¼š</p><ul><li><code>STATUS_BAR</code>ï¼Œç”¨äºå±•ç¤ºç³»ç»Ÿæ—¶é—´ï¼Œç”µé‡ï¼Œwifi ç­‰ä¿¡æ¯</li><li><code>NAVIGATION_BAR</code>ï¼Œè™šæ‹Ÿå¯¼èˆªæ ï¼ˆåŒºåˆ«äºå®ä½“çš„ä¸‰å¤§é‡‘åˆšé”®ï¼‰ï¼Œå½¢æ€æœ‰ä¸‰å¤§é‡‘åˆšé”®å¯¼èˆªï¼Œæ‰‹åŠ¿å¯¼èˆªä¸¤ç§ã€‚ï¼ˆæœ‰äº›è®¾å¤‡å½¢æ€å¦‚ TV æ²¡æœ‰å¯¼èˆªæ ï¼‰</li><li><code>IME</code>ï¼Œè½¯é”®ç›˜ï¼Œç”¨äºè¾“å…¥æ–‡å­—</li></ul><p>å¦‚æœç»˜åˆ¶çš„å†…å®¹å‡ºç°åœ¨äº†ç³»ç»Ÿ UI åŒºåŸŸå†…ï¼Œå°±å¯èƒ½å‡ºç°è§†è§‰ä¸æ‰‹åŠ¿çš„å†²çªã€‚å¯ä»¥å€ŸåŠ© Insets æŠŠ view ä»å±å¹•è¾¹ç¼˜å‘å†…ç§»åŠ¨åˆ°ä¸€ä¸ªåˆé€‚çš„ä½ç½®ã€‚ä¸ºäº†é˜²æ­¢ App å†…å®¹åŒºåŸŸä¸Â <code>System bar</code>å‘ç”Ÿè§†è§‰å†²çªï¼Œå®˜æ–¹æä¾›äº†ä¸¤ç§ APIï¼Œ<code>WidowInsets</code>Â ä¸ Â <code>fitsSystemWindows</code>ã€‚</p><p><strong><code>WidowInsets</code></strong>Â </p><p><strong>å¯ä»¥é€šè¿‡åœ¨è‡ªå®šä¹‰ View ä¸­é‡å†™ <code>onApplyWindowInsets()</code> æ–¹æ³•æˆ–è°ƒç”¨ <code>setOnApplyWindowInsetsListener()</code> æ¥ç›‘å¬ <code>WindowInsets</code> çš„å˜åŒ–ï¼Œé€šè¿‡å¯¹ View æ·»åŠ  <code>margin</code> æˆ– <code>padding</code> çš„æ–¹å¼å¤„ç†è§£å†³å†²çª</strong>ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">editText.setOnApplyWindowInsetsListener(<span class="hljs-keyword">object</span> : View.OnApplyWindowInsetsListener &#123;<br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onApplyWindowInsets</span><span class="hljs-params">(v: <span class="hljs-type">View</span>, insets: <span class="hljs-type">WindowInsets</span>)</span></span>: WindowInsets &#123;<br>                <span class="hljs-keyword">val</span> statusBar = insets.getInsets(WindowInsets.Type.statusBars())<br>                <span class="hljs-keyword">val</span> navBars = insets.getInsets(WindowInsets.Type.navigationBars())<br>                Log.i(<span class="hljs-string">&quot;MainActivity&quot;</span>, <span class="hljs-string">&quot;status bar: <span class="hljs-subst">$&#123;statusBar.bottom&#125;</span>, nav bar: <span class="hljs-subst">$&#123;navBars.bottom&#125;</span>&quot;</span>)<br>                <span class="hljs-keyword">return</span> insets<br>            &#125;<br>        &#125;)<br></code></pre></td></tr></table></figure><p>å¦‚ä½•ä½¿ç”¨  window insetsï¼š( ç‰ˆæœ¬ â‰¥ API 21 å‡å¯ä½¿ç”¨ï¼ŒwindowInsetsCompatåˆ™ä¸ºå…¶å…¼å®¹ç‰ˆæœ¬)</p><ol><li>ä½¿ç”¨ <code>ViewCompat.getRootWindowInsets(view)</code>Â è·å–Â <code>WindowInsets</code></li><li>é€šè¿‡Â <code>WindowInsets#getInsets(type)</code>Â è·å– Insets</li><li>é€šè¿‡ Insets.top æˆ– Insets.bottom è·å–Â <code>System bar</code>Â é«˜åº¦</li></ol><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> windowInsetsCompat = ViewCompat.getRootWindowInsets(editText)<br><span class="hljs-keyword">val</span> ime = windowInsetsCompat?.getInsets(WindowInsetsCompat.Type.ime())<br><span class="hljs-keyword">val</span> height = ime?.bottom<br></code></pre></td></tr></table></figure><p><strong><code>fitsSystemWindows</code></strong></p><p><strong><code>SetFitsSystemWindows</code></strong>Â æ˜¯ View ä¸­ API 14 ååŠ å…¥çš„æ–¹æ³•ï¼Œå¯¹åº”çš„ xml å±æ€§æ˜¯Â <strong><code>android:fitsSystemWindows</code></strong></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=<span class="hljs-string">&quot;http://schemas.android.com/apk/res/android&quot;</span><br>    xmlns:app=<span class="hljs-string">&quot;http://schemas.android.com/apk/res-auto&quot;</span><br>    xmlns:tools=<span class="hljs-string">&quot;http://schemas.android.com/tools&quot;</span><br>    android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>    android:layout_height=<span class="hljs-string">&quot;match_parent&quot;</span><br>    **android:fitsSystemWindows=<span class="hljs-string">&quot;true&quot;</span>**<br>    tools:context=<span class="hljs-string">&quot;.MainActivity&quot;</span>&gt;<br>&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;<br></code></pre></td></tr></table></figure><p><strong><code>FitsSystemWindows</code>Â çš„é»˜è®¤è¡Œä¸ºæ˜¯ï¼šé€šè¿‡ padding ä¸ºÂ <code>System bar</code>Â é¢„ç•™å‡ºç©ºé—´ã€‚</strong></p><p>å…³äº <code>fitsSystemWindows</code>ï¼š</p><ul><li><code>fitsSystemWindows</code> æ˜¯æ·±åº¦ä¼˜å…ˆï¼ˆæˆ‘ä»¬å¯ä»¥å°†è§†å›¾æ ‘çœ‹æˆä¸€ä¸ª Nå‰æ ‘ï¼‰çš„ï¼Œç¬¬ä¸€ä¸ªè®¾ç½® <code>fitsSystemWindows</code> çš„ view ä¼šå»æ¶ˆè´¹ insets å¹¶å½±å“è§†è§‰ã€‚</li><li>å¼€å‘è€…åœ¨ xml æˆ– view åˆå§‹åŒ–è®¾ç½®çš„ padding ä¼šè¢«<strong>è¦†ç›–ã€‚</strong></li><li><a href="https://link.juejin.cn/?target=https://developer.android.com/reference/com/google/android/material/appbar/AppBarLayout.html">AppBarLayout</a>ï¼Œ<a href="https://link.juejin.cn/?target=https://developer.android.com/reference/androidx/coordinatorlayout/widget/CoordinatorLayout.html">CoordinatorLayout</a>ï¼Œ<a href="https://link.juejin.cn/?target=https://developer.android.com/reference/androidx/drawerlayout/widget/DrawerLayout.html">DrawerLayout</a> ç­‰ view ä¼šè‡ªå®šä¹‰ <code>fitsSystemWindows</code> çš„è¡Œä¸ºã€‚</li></ul><p>æœ‰äº†ä»¥ä¸ŠèƒŒæ™¯çŸ¥è¯†ä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹å¦‚ä½•ä½¿ç”¨ window insets æ¥ç›‘å¬é”®ç›˜é«˜åº¦ï¼Œé¦–å…ˆï¼Œè®¾ç½® setDecorFitsSystemWindows ä¸º falseï¼Œæ¥è®©å†…å®¹åŒºåŸŸå…¨å±ï¼Œç„¶åå»æ‰ android:fitsSystemWindows&#x3D;â€trueâ€ ï¼ˆä¸€å®šè¦å»æ‰è¯¥å±æ€§ï¼‰ã€‚è®¾ç½®å®Œè¯¥å±æ€§åï¼Œå‘ç°ä¸‹æ–¹å†…å®¹éƒ½è¢«ç³»ç»Ÿçš„ nav bar æŒ¡ä½äº†ï¼Œå‡ºç°äº†è§†è§‰å†²çªã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥è§£å†³å†…å®¹è¢«ç³»ç»Ÿbar è¦†ç›–çš„é—®é¢˜ã€‚</p><p>é¦–å…ˆè®¾ç½® bar ä¸ºé€æ˜ï¼Œç„¶åï¼Œé€šè¿‡ setOnApplyWindowInsetsListener æ¥è·å– window insetsï¼Œè·å–ç³»ç»Ÿbar çš„é«˜åº¦ä¹‹åï¼Œè®¾ç½®ç›¸åº”çš„paddingã€‚</p><p><strong>å®ç° è¾¹åˆ°è¾¹ (edge-to-edge) æ²‰æµ¸å¼æ•ˆæœï¼Œå¹¶è®¾ç½®å¯¹åº”paddingï¼Œä¸è®©ç³»ç»Ÿbar é®æŒ¡viewå†…å®¹ã€‚</strong></p><p>Android R ç‰ˆæœ¬åŠä»¥ä¸Šçš„å®ç°æ–¹å¼ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//1. ä½¿å†…å®¹åŒºåŸŸå…¨å±</span><br>window.setDecorFitsSystemWindows(<span class="hljs-literal">false</span>)<br> <span class="hljs-comment">// 2. è®¾ç½® System bar é€æ˜</span><br>window.statusBarColor = Color.TRANSPARENT<br>window.navigationBarColor = Color.TRANSPARENT<br><span class="hljs-keyword">val</span> rootView = findViewById&lt;View&gt;(R.id.root_container)<br>rootView.setOnApplyWindowInsetsListener &#123; v, insets -&gt;<br><span class="hljs-keyword">val</span> systemBars = insets.getInsets(WindowInsets.Type.systemBars())<br>  <span class="hljs-comment">// æ­¤å¤„æ›´æ”¹çš„ marginï¼Œä¹Ÿå¯è®¾ç½® paddingï¼Œè§†æƒ…å†µè€Œå®š</span><br>  rootView.updateLayoutParams&lt;ViewGroup.MarginLayoutParams&gt; &#123;<br>     topMargin = systemBars.top<br>     leftMargin = systemBars.left<br>     bottomMargin = systemBars.bottom<br>     rightMargin = systemBars.right<br>  &#125;<br>  <span class="hljs-keyword">return</span><span class="hljs-symbol">@setOnApplyWindowInsetsListener</span> insets<br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶å è®¾ç½® <code>WindowInsetsAnimation.Callback</code> æ¥ç›‘å¬ window insets çš„é«˜åº¦å˜åŒ–ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> editText = findViewById&lt;EditText&gt;(R.id.edit_text_view)<br>       <span class="hljs-keyword">val</span> call = <span class="hljs-keyword">object</span> : WindowInsetsAnimation.Callback(DISPATCH_MODE_CONTINUE_ON_SUBTREE) &#123;<br>           <span class="hljs-meta">@RequiresApi(Build.VERSION_CODES.R)</span><br>           <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onProgress</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">               insets: <span class="hljs-type">WindowInsets</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">               runningAnimations: <span class="hljs-type">MutableList</span>&lt;<span class="hljs-type">WindowInsetsAnimation</span>&gt;</span></span><br><span class="hljs-params"><span class="hljs-function">           )</span></span>: WindowInsets &#123;<br>               <span class="hljs-keyword">val</span> navBar = insets.getInsets(WindowInsets.Type.navigationBars())<br>               <span class="hljs-keyword">val</span> ime = insets.getInsets(WindowInsets.Type.ime())<br>               Log.i(<br>                   <span class="hljs-string">&quot;MainActivity&quot;</span>, <span class="hljs-string">&quot;ime:&quot;</span> + ime.top +<br>                           <span class="hljs-string">&quot; &quot;</span> + ime.bottom<br>               )<br>               <span class="hljs-keyword">val</span> params = (editText.layoutParams <span class="hljs-keyword">as</span> ViewGroup.MarginLayoutParams)<br>               params.bottomMargin = (ime.bottom - navBar.bottom).coerceAtLeast(<span class="hljs-number">0</span>)<br>               editText.layoutParams = params<br>               <span class="hljs-keyword">return</span> insets<br>           &#125;<br>       &#125;<br></code></pre></td></tr></table></figure><p>åœ¨ onProgress ä¸­ï¼Œè·å– ime çš„ é«˜åº¦ï¼Œå¹¶è®¾ç½® è¾“å…¥æ¡† view bottom margin ä¸º ime é«˜åº¦ - nav baré«˜åº¦ï¼Œè¿™æ ·ï¼Œè¾“å…¥æ¡†å°±ä¼šè·Ÿéšé”®ç›˜ å¼¹èµ· å’Œæ”¶èµ·äº†ã€‚å¯ä»¥çœ‹åˆ°åŠ¨ç”»æ•ˆæœéå¸¸ä¸æ»‘ã€‚</p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202406302020246.gif" alt="å½•å±1"></p><aside>â›³ Android æä¾›äº† WindowCompat å’Œ ViewCompat API æ¥å¯¹ å°äº Android R ç‰ˆæœ¬çš„ ç³»ç»Ÿæ¥è¿›è¡Œå…¼å®¹ã€‚å…·ä½“å®ç°ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œä½†æ˜¯ï¼Œç»è¿‡æˆ‘çš„å®é™…æµ‹è¯•ï¼Œä»¥ä¸‹ä»£ç  æ— æ³•åœ¨ ä½äº Android R çš„è®¾å¤‡ä¸Šè¿è¡Œã€‚</aside><p>åŸå› åˆ†æï¼š æˆ‘åœ¨ manifest xml æ–‡ä»¶ä¸­è®¾ç½®äº†<br><code>android:windowSoftInputMode=&quot;stateAlwaysHidden|adjustNothing&quot;</code> å±æ€§ï¼Œå½±å“äº†ä½ç‰ˆæœ¬æ‹¿insetsï¼Œæ­¤æ—¶è·å–åˆ°çš„ insets ä¸º nullã€‚åœ¨ä½ç‰ˆæœ¬ä¸Šï¼Œå„ç§SystemUiFlagéƒ½ä¼šå½±å“åˆ°æœ€ç»ˆçš„æ˜¾ç¤ºæ•ˆæœã€‚è¿™é‡Œä¼šæœ‰è®¸å¤šå…¼å®¹æ€§é—®é¢˜ï¼Œä¸å»ºè®®åœ¨ ä½ç‰ˆæœ¬æœºå‹ä¸Šä½¿ç”¨ windowinsets compat çš„æ–¹å¼æ¥ç›‘å¬é”®ç›˜çš„é«˜åº¦ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// 1. ä½¿å†…å®¹åŒºåŸŸå…¨å±</span><br>WindowCompat.setDecorFitsSystemWindows(window, <span class="hljs-literal">false</span>)<br><br><span class="hljs-comment">// 2. è®¾ç½® System bar é€æ˜</span><br>window.statusBarColor = Color.TRANSPARENT<br>window.navigationBarColor = Color.TRANSPARENT<br><br><span class="hljs-comment">// 3. å¯èƒ½å‡ºç°è§†è§‰å†²çªçš„ view å¤„ç† insets</span><br>ViewCompat.setOnApplyWindowInsetsListener(view) &#123; view, windowInsets -&gt;<br>  <span class="hljs-keyword">val</span> insets = windowInsets.getInsets(WindowInsetsCompat.Type.systemBars())<br>  <span class="hljs-comment">// æ­¤å¤„æ›´æ”¹çš„ marginï¼Œä¹Ÿå¯è®¾ç½® paddingï¼Œè§†æƒ…å†µè€Œå®š</span><br>  view.updateLayoutParams&lt;MarginLayoutParams&gt; &#123;<br>    topMargin = insets.top<br>      leftMargin = insets.left<br>      bottomMargin = insets.bottom<br>      rightMargin = insets.right<br>  &#125;<br>  WindowInsetsCompat.CONSUMED<br>&#125;<br><span class="hljs-keyword">val</span> callback = <span class="hljs-keyword">object</span> : WindowInsetsAnimationCompat.Callback(DISPATCH_MODE_CONTINUE_ON_SUBTREE) &#123;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onPrepare</span><span class="hljs-params">(animation: <span class="hljs-type">WindowInsetsAnimationCompat</span>)</span></span> &#123;<br>                <span class="hljs-keyword">super</span>.onPrepare(animation)<br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStart</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">                animation: <span class="hljs-type">WindowInsetsAnimationCompat</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">                bounds: <span class="hljs-type">WindowInsetsAnimationCompat</span>.<span class="hljs-type">BoundsCompat</span></span></span><br><span class="hljs-params"><span class="hljs-function">            )</span></span>: WindowInsetsAnimationCompat.BoundsCompat &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onStart(animation, bounds)<br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onProgress</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">                insets: <span class="hljs-type">WindowInsetsCompat</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">                runningAnimations: <span class="hljs-type">MutableList</span>&lt;<span class="hljs-type">WindowInsetsAnimationCompat</span>&gt;</span></span><br><span class="hljs-params"><span class="hljs-function">            )</span></span>: WindowInsetsCompat &#123;<br>                <span class="hljs-keyword">val</span> navBar = insets.getInsets(WindowInsetsCompat.Type.navigationBars())<br>                <span class="hljs-keyword">val</span> ime = insets.getInsets(WindowInsetsCompat.Type.ime())<br>                Log.i(<br>                    <span class="hljs-string">&quot;MainActivity&quot;</span>, <span class="hljs-string">&quot;ime:&quot;</span> + ime.top +<br>                            <span class="hljs-string">&quot; &quot;</span> + ime.bottom<br>                )<br>                <span class="hljs-keyword">val</span> params = (editText.layoutParams <span class="hljs-keyword">as</span> ViewGroup.MarginLayoutParams)<br>                params.bottomMargin = (ime.bottom - navBar.bottom).coerceAtLeast(<span class="hljs-number">0</span>)<br>                editText.layoutParams = params<br>                <span class="hljs-keyword">return</span> insets<br>            &#125;<br><br>            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onEnd</span><span class="hljs-params">(animation: <span class="hljs-type">WindowInsetsAnimationCompat</span>)</span></span> &#123;<br>                <span class="hljs-keyword">super</span>.onEnd(animation)<br>            &#125;<br>&#125;<br><span class="hljs-keyword">val</span> editText = findViewById&lt;EditText&gt;(R.id.edit_text_view)<br>ViewCompat.setWindowInsetsAnimationCallback(editText, callback)<br></code></pre></td></tr></table></figure><p>æ€»ç»“ï¼Œé’ˆå¯¹é”®ç›˜é«˜åº¦ç›‘å¬çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ æ ¹æ® android ç‰ˆæœ¬ å’Œæœºå‹ï¼Œåšå…¼å®¹æ€§çš„å¤„ç†ï¼Œä¾‹å¦‚ï¼Œåˆ¤æ–­ android ç³»ç»Ÿç‰ˆæœ¬ï¼Œåœ¨ Android R åŠä»¥ä¸Šç‰ˆæœ¬ä¸Šï¼Œä½¿ç”¨Window Insets Animation çš„æ–¹å¼ï¼Œä»¥è·å¾—æœ€ä½³çš„ é”®ç›˜é«˜åº¦ç›‘å¬åŠ¨ç”»æ•ˆæœã€‚åœ¨ Android R ä»¥ä¸‹ç‰ˆæœ¬ æˆ–è€… ç±»ä¼¼ åä¸º ä¸‰æ˜Ÿç­‰å¥‡è‘©æœºå‹ä¸Šï¼Œä½¿ç”¨ addOnGlobalLayoutListener ç»“åˆ popup window çš„æ–¹å¼ç›‘å¬é”®ç›˜å¼¹èµ·æ—¶çš„é«˜åº¦å˜åŒ–ã€‚</p><p>å‚è€ƒï¼š</p><p><a href="https://juejin.cn/post/6892118334762909709">å®ç°è¾¹åˆ°è¾¹çš„ä½“éªŒ | è®©æ‚¨çš„è½¯é”®ç›˜åŠ¨èµ·æ¥ (ä¸€) - æ˜é‡‘ (juejin.cn)</a></p><p><a href="https://juejin.cn/post/7179128712141471802">Androidï¼šä½¿ç”¨ViewCompaté€‚é…è½¯é”®ç›˜å¼¹å‡ºï¼Œè§£å†³è½¯é”®ç›˜é®æŒ¡å¸ƒå±€é—®é¢˜ - æ˜é‡‘ (juejin.cn)</a></p><p><a href="https://juejin.cn/post/6844904006343458830">å¤„ç†è§†è§‰å†²çª | æ‰‹åŠ¿å¯¼èˆª (äºŒ) - æ˜é‡‘ (juejin.cn)</a></p><p><a href="https://juejin.cn/post/7038422081528135687">Android Detailï¼šWindow ç¯‡â€”â€” WindowInsets ä¸ fitsSystemWindow - æ˜é‡‘ (juejin.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>Android å¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MAC ç›®å½•ä¸åŒºåˆ†å¤§å°å†™é—®é¢˜</title>
    <link href="/2024/06/02/MAC-%E7%9B%AE%E5%BD%95%E4%B8%8D%E5%8C%BA%E5%88%86%E5%A4%A7%E5%B0%8F%E5%86%99%E9%97%AE%E9%A2%98/"/>
    <url>/2024/06/02/MAC-%E7%9B%AE%E5%BD%95%E4%B8%8D%E5%8C%BA%E5%88%86%E5%A4%A7%E5%B0%8F%E5%86%99%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<p>åœ¨è‹¹æœæ–‡ä»¶ç³»ç»Ÿ <strong>APFS (Apple File System)</strong>Â  ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œè¿™æ„å‘³ç€æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„åç§°ä¸åŒºåˆ†å¤§å°å†™ã€‚ä¾‹å¦‚ï¼Œâ€Document.txtâ€ å’Œ â€œdocument.txtâ€ è¢«è§†ä¸ºç›¸åŒçš„æ–‡ä»¶ã€‚è¿™ç§è¡Œä¸ºé€‚ç”¨äºå¤§å¤šæ•°ç”¨æˆ·ï¼Œå¹¶ä¸”æ˜¯ macOS å’Œ iOS è®¾å¤‡çš„é»˜è®¤è®¾ç½®ã€‚</p><p>æœ€è¿‘é‡åˆ°äº†ä¸€ä¸ªè¯¥ç‰¹æ€§å¯¼è‡´çš„é—®é¢˜ï¼Œåœ¨å¾€ git ä»“åº“æäº¤æ–‡ä»¶æ—¶ï¼Œä¸¤ä¸ªäººåˆ†åˆ«åˆ›å»ºäº†ä¸¤ä¸ªåŒåçš„ä¸åŒºåˆ†å¤§å°å†™çš„æ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚æ˜¯ï¼šâ€Moduleâ€ å’Œ â€œmoduleâ€ï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹éƒ½è¢«æäº¤åˆ° git ä»“åº“ä¸­äº†ï¼Œç„¶åï¼Œæˆ‘æœ¬åœ°åœ¨æ‹‰å–ä»£ç åˆ° Mac æœ¬åœ°æ—¶ï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸­çš„å†…å®¹å°±è¢«åˆå¹¶äº†ï¼Œåœ¨ä¸åŒºåˆ†å¤§å°å†™çš„ mac æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ— æ³•åŒºåˆ†å‡ºè¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ã€‚</p><p>è¿™ç§æƒ…å†µå¯¼è‡´äº†ä¸€äº›é—®é¢˜ï¼Œæˆ‘ä»¬çš„ä»£ç ç¼–è¯‘æ˜¯åœ¨ linux ä¸Šè¿›è¡Œçš„ï¼Œç”±äº linux ç³»ç»Ÿæ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œæ‰€ä»¥ åœ¨ Module å’Œ module ä¸­çš„æ–‡ä»¶ å‡ºç°äº†æ··ä¹±ï¼Œå¯¼è‡´ç¼–è¯‘å¤±è´¥ã€‚</p><p>è§£å†³æ–¹æ¡ˆï¼š</p><p>åœ¨ mac ä¸Šæ–°å»ºä¸€ä¸ªåŒºåˆ†å¤§å°å†™çš„æ–‡ä»¶ç³»ç»Ÿåˆ†åŒºï¼Œæ‰“å¼€ç£ç›˜å·¥å…·ï¼Œåˆ›å»ºä¸€ä¸ªåŒºåˆ†å¤§å°å†™çš„ç£ç›˜åˆ†åŒºã€‚</p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024Untitled.png" alt="apfs"></p><p>ç„¶åæ‹‰å–æºä»£ç åˆ°æœ¬åœ°ï¼Œè¿™æ—¶ï¼Œå°±å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªä¸åŒçš„ â€œModuleâ€ å’Œ â€œmoduleâ€ ç›®å½•ï¼Œç„¶åé€‰æ‹©ä¿ç•™å…¶ä¸­ä¸€ä¸ªç›®å½•ï¼Œä¾‹å¦‚ï¼Œä¿ç•™ â€œmoduleâ€ å°å†™ç›®å½•ï¼Œç„¶åç§»åŠ¨æ‰€æœ‰ â€œModuleâ€ ç›®å½•ä¸­çš„æ–‡ä»¶åˆ° â€œmoduleâ€ ä¸­ä¹‹åï¼Œåˆ é™¤ â€œModuleâ€ ç›®å½•ï¼Œé‡æ–°æäº¤æ›´æ”¹åˆ° git ä»“åº“ã€‚</p><p>ç§»åŠ¨æ–‡ä»¶çš„ç›¸å…³æŒ‡ä»¤ï¼Œåˆ° è¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹çš„ çˆ¶ç›®å½•ä¸‹ï¼Œæ‰§è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">rsync -av --remove-source-files Module/ module/<br></code></pre></td></tr></table></figure><p><code>-a</code>ï¼šå½’æ¡£æ¨¡å¼ï¼Œé€’å½’å¤åˆ¶å¹¶ä¿æŒæ–‡ä»¶å±æ€§ã€‚</p><p><code>-v</code>ï¼šæ˜¾ç¤ºè¯¦ç»†è¾“å‡ºã€‚</p><p><code>--remove-source-files</code>ï¼šåœ¨åŒæ­¥ååˆ é™¤æºç›®å½•ä¸­çš„æ–‡ä»¶ã€‚</p><p>è¿™ä¸ªå‘½ä»¤ä¼šå°†æºç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ç§»åŠ¨åˆ°ç›®æ ‡ç›®å½•ï¼Œå¹¶åœ¨å®Œæˆååˆ é™¤æºç›®å½•ä¸­çš„æ–‡ä»¶ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å¼€å‘é—®é¢˜è®°å½•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MACç³»ç»Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo åšå®¢ä¸­çš„å›¾ç‰‡æ€ä¹ˆç®¡ç†ï¼Ÿ</title>
    <link href="/2024/06/02/Hexo-%E5%8D%9A%E5%AE%A2%E4%B8%AD%E7%9A%84%E5%9B%BE%E7%89%87%E6%80%8E%E4%B9%88%E7%AE%A1%E7%90%86%EF%BC%9F/"/>
    <url>/2024/06/02/Hexo-%E5%8D%9A%E5%AE%A2%E4%B8%AD%E7%9A%84%E5%9B%BE%E7%89%87%E6%80%8E%E4%B9%88%E7%AE%A1%E7%90%86%EF%BC%9F/</url>
    
    <content type="html"><![CDATA[<p>ä¸€èˆ¬æ¥è®²ï¼Œæˆ‘ä»¬çš„åšå®¢ä¸­ä¼šæœ‰å¾ˆå¤šçš„å›¾ç‰‡ï¼Œå¦‚æœéƒ½æäº¤åˆ° Hexo é¡¹ç›®ä¸­è¿›è¡Œå‘å¸ƒçš„è¯ï¼Œä¼šå¯¼è‡´æˆ‘ä»¬çš„ Hexo é™æ€ç½‘ç«™é¡¹ç›®éå¸¸è‡ƒè‚¿ï¼Œæä¸æ¨èä½¿ç”¨è¿™ç§æ–¹å¼æ¥ç®¡ç†åšå®¢ä¸­çš„å›¾ç‰‡ã€‚</p><p>å¦‚æœæ˜¯æˆ‘ä»¬æœ¬åœ°å†™ Markdown ç¬”è®°ï¼Œå›¾ç‰‡ä¸€èˆ¬ä¼šä¿å­˜åˆ°æœ¬åœ°ç›®å½•ï¼Œå¦‚æœæ˜¯åœ¨ Notion or ä¸€äº›äº‘ç¬”è®°ç½‘ç«™ä¸Šå†™ï¼Œå›¾ç‰‡ä¼šä¸Šä¼ åˆ°å®ƒä»¬çš„æœåŠ¡å™¨è¿›è¡Œä¿å­˜ã€‚</p><p>å¯¹äº Hexo åšå®¢ï¼Œè¿™é‡Œæ¨èä½¿ç”¨ å›¾åºŠ çš„æ–¹å¼æ¥è¿›è¡Œç®¡ç†ã€‚</p><p>é¦–å…ˆï¼Œä»‹ç»ä¸€ä¸‹ picgoï¼Œ<strong>PicGo æ˜¯ä¸€ä¸ªç”¨äºå¿«é€Ÿä¸Šä¼ å›¾ç‰‡å¹¶è·å–å›¾ç‰‡ URL é“¾æ¥çš„å·¥å…·ã€‚</strong></p><p><a href="https://picgo.github.io/PicGo-Doc/zh/guide/">PicGo is Here | PicGo</a></p><p>PicGo æœ¬ä½“æ”¯æŒå¦‚ä¸‹å›¾åºŠï¼š</p><ul><li><code>ä¸ƒç‰›å›¾åºŠ</code>Â v1.0</li><li><code>è…¾è®¯äº‘ COS v4\v5 ç‰ˆæœ¬</code>Â v1.1 &amp; v1.5.0</li><li><code>åˆæ‹äº‘</code>Â v1.2.0</li><li><code>GitHub</code>Â v1.5.0</li><li><code>SM.MS V2</code>Â v2.3.0-beta.0</li><li><code>é˜¿é‡Œäº‘ OSS</code>Â v1.6.0</li><li><code>Imgur</code>Â v1.6.0</li></ul><p>æˆ‘ä»¬å¯ä»¥ç»“åˆä½¿ç”¨ picgo + githubï¼Œæ¥ç®¡ç†åšå®¢ä¸­çš„å›¾ç‰‡ã€‚</p><p>æˆ‘ä»¬é€‰æ‹©ç›´æ¥å¤ç”¨ æˆ‘ä»¬æ‰˜ç®¡ Hexo åšå®¢çš„ github ä»“åº“ï¼Œä¹Ÿå°±æ˜¯ <a href="http://xcxyh.github.io/">xcxyh.github.io</a> è¿™ä¸ªä»“åº“ï¼Œæ¥æ–°å»ºä¸ª image-save çš„åˆ†æ”¯ç®¡ç†å›¾ç‰‡ã€‚</p><p>åœ¨ PicGo ä¸­é…ç½®ï¼š</p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202406021902888.png" alt="Untitled"></p><p>å…¶ä¸­ï¼Œgit token çš„ç”Ÿæˆæ–¹å¼ å¯ä»¥å‚è€ƒï¼š<a href="https://www.cnblogs.com/leon-2016/p/9284837.html">github ç”Ÿæˆ token çš„æ–¹æ³• - å—èœå›­ - åšå®¢å›­ (cnblogs.com)</a></p><p>è®¾ç½®å®Œæˆä¹‹åï¼Œå¯ä»¥æµ‹è¯•ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œåœ¨ç›¸å†Œä¸­ å¤åˆ¶å›¾ç‰‡çš„é“¾æ¥ï¼Œçœ‹æ˜¯å¦å¯ä»¥è®¿é—®ã€‚</p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202406021902261.png" alt="Untitled 1"></p><p>ç»“åˆ Typora ä½¿ç”¨ï¼š</p><p>å½“æˆ‘ä»¬æˆåŠŸæ­å»ºå¥½å›¾åºŠä¹‹åï¼Œæ¯æ¬¡å†™ Markdown æ–‡æ¡£æ—¶ï¼Œéƒ½éœ€è¦å…ˆæˆªå›¾ï¼Œå†ä¿å­˜ï¼Œç„¶åæ‰‹åŠ¨æ‰“å¼€ Picgo å®Œæˆä¸Šä¼ ï¼Œæœ€åå°†å›¾ç‰‡åœ°å€å¤åˆ¶åˆ° Markdown æ–‡æ¡£ä¸­ã€‚</p><p>å¦‚ä½•åšåˆ°æ›´åŠ é«˜æ•ˆåœ°ä¸Šä¼ å›¾ç‰‡åˆ°å›¾åºŠå‘¢ï¼Ÿ</p><p>ç”¨ Typora å†™ç¬”è®°ï¼Œåªéœ€è¦å…ˆæˆªå›¾ï¼Œå†ç²˜è´´åˆ° Markdown æ–‡æ¡£ï¼Œæ ¹æ®æç¤ºç›´æ¥ä¸Šä¼ å›¾ç‰‡ï¼ŒTypora å¸®æˆ‘ä»¬è‡ªåŠ¨å®Œæˆã€‚</p><p>æ“ä½œä¸ºï¼šæ‰“å¼€ Typora çš„è®¾ç½®ï¼Œç‚¹å‡»å›¾åƒï¼ŒæŒ‰ç…§æˆ‘ç»™çš„å›¾ç‰‡è¿›è¡Œè®¾ç½®ï¼Œæ›¿æ¢ PicGo è·¯å¾„ä¸ºä½ å½“å‰çš„å®‰è£…è·¯å¾„ã€‚</p><p><img src="https://raw.githubusercontent.com/xcxyh/xcxyh.github.io/image-save/images/2024202406021902052.png" alt="Untitled 2"></p><p>å¯ä»¥ç‚¹å‡»éªŒè¯å›¾ç‰‡ä¸Šä¼ ï¼ŒéªŒè¯æ˜¯å¦è®¾ç½®æˆåŠŸ~~</p><p>ä¹‹åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥æ„‰å¿«åœ°ç”¨ Hexo å†™å›¾æ–‡å¹¶èŒ‚çš„åšå®¢å•¦~~~~</p>]]></content>
    
    
    <categories>
      
      <category>HEXO ç›¸å…³</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexoå»ºç«™</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¬‘ä¸€ç¬‘å°±å¥½</title>
    <link href="/2024/05/19/%E7%AC%91%E4%B8%80%E7%AC%91%E5%B0%B1%E5%A5%BD/"/>
    <url>/2024/05/19/%E7%AC%91%E4%B8%80%E7%AC%91%E5%B0%B1%E5%A5%BD/</url>
    
    <content type="html"><![CDATA[<p>éšæ‰‹è®°å½•çš„ä¸œè¥¿ï¼Œç¬‘ä¸€ç¬‘å°±å¥½ã€‚</p><h2 id="ä¸­æ–‡ç¯‡"><a href="#ä¸­æ–‡ç¯‡" class="headerlink" title="ä¸­æ–‡ç¯‡"></a>ä¸­æ–‡ç¯‡</h2><p>é€‰æ‹©ä½ æ‰€çˆ±çš„ï¼Œçˆ±ä½ æ‰€é€‰æ‹©çš„ã€‚</p><hr><p>æ²¡æœ‰è°çœŸæ­£é‡è¦ã€‚</p><hr><p>å¦‚æœäººåœ¨èŒåœºä¸æŒç»­å­¦ä¹ å…·ä½“çš„æŠ€èƒ½ï¼Œä¸“ä¸šçš„çŸ¥è¯†ï¼Œä½†åˆæƒ³åœ¨èŒåœºç”Ÿå­˜ä¸‹å»ï¼Œå°±å®¹æ˜“æåˆ«çš„è·¯å­ï¼Œå³æ˜¯å¯¹è‡ªå·±æœ‰åˆ©ï¼Œèƒ½æå‡è‡ªå·±åœ°ä½çš„äº‹ã€‚æ‰€ä»¥ï¼ŒæŒæ¡ä¸€é—¨æŠ€æœ¯ï¼Œåœ¨æŸä¸€æ–¹é¢æˆä¸ºä¸€åä¸“å®¶ï¼Œä¸ä»…æ˜¯åœ¨å¢é•¿è‡ªå·±çš„èƒ½åŠ›ï¼Œä¹Ÿæ˜¯åœ¨ä¿å…¨è‡ªå·±çš„äººå“ã€‚</p><hr><p>ç¡äº†ä¸¤å°æ—¶åˆè§‰ï¼Œæ„Ÿè§‰çµé­‚éƒ½è¢«ä¿®å¤äº†ã€‚é‚£æ˜¯ä¸€ä¸ªæ¸©æš–çš„æ¢¦ã€‚</p><hr><p>æ‹¥æŠ±å˜åŒ–ã€‚</p><hr><p>è°è¨€ä¸ä¼šä¼¤äººï¼ŒçœŸç›¸æ‰æ˜¯å¿«åˆ€ã€‚</p><hr><p>è¦å°å¿ƒé‚£äº›ä¸€æ— æ‰€æœ‰çš„äººã€‚</p><hr><p>æ„¤æ€’ï¼Œå¸¦æ¥å†²åŠ¨ã€‚</p><hr><p>äººï¼Œåªæœ‰å½“å¸¦ä¸Šé¢å…·ï¼Œæ‰èƒ½å¸ä¸‹ä¼ªè£…ã€‚</p><hr><p>æ­£ä¹‰æ— æ³•ä¼¸å¼ è‡ªå·±ã€‚</p><hr><p>äººä»¿ä½›æ°¸è¿œéƒ½æ˜¯ç©ºè™šçš„ï¼Œç”¨ä»€ä¹ˆéƒ½å¡«ä¸æ»¡ã€‚</p><hr><p>æœ‰çš„æ—¶å€™ï¼Œä¸è¦è¿‡åº¦å»å…³æ³¨ã€å¯»æ‰¾ç”Ÿæ´»çš„æ„ä¹‰ï¼Œè€Œæ˜¯è¦å»å…³æ³¨ç”Ÿæ´»æœ¬èº«ï¼Œå»ä½“éªŒï¼Œå»åšï¼Œæœ‰äº›åœ°æ–¹ï¼Œæˆ‘å»è¿‡ï¼Œæœ‰äº›äº‹æƒ…ï¼Œæˆ‘åšè¿‡ï¼Œæœ‰äº›ä¸œè¥¿ï¼Œæ‹¥æœ‰è¿‡ï¼Œå…¶å®å°±å¤Ÿäº†ã€‚ç”Ÿæ´»æœ¬èº«åœ¨å¤§å¤šæ•°æ—¶å€™å°±æ˜¯æ— æ„ä¹‰çš„ï¼Œå¤§å¤šæ•°äººçš„ç”Ÿæ´»ä¹Ÿæ˜¯æ¯«æ— æ„ä¹‰çš„ï¼Œå¯¹äºå¹³åº¸çš„æˆ‘ä»¬æ¥è®²ï¼Œç”Ÿæ´»çš„ä½“éªŒæ¯”æ„ä¹‰è¦é‡è¦ä¸æ˜¯å—ã€‚</p><hr><p>ä½ ä»€ä¹ˆéƒ½æƒ³è¦ï¼Œä½ å°±ä»€ä¹ˆéƒ½å¾—ä¸åˆ°ã€‚</p><hr><p>ä»¥æ–—äº‰æ±‚å’Œå¹³åˆ™å’Œå¹³å­˜ï¼Œä»¥å¦¥åæ±‚å’Œå¹³åˆ™å’Œå¹³äº¡ã€‚</p><hr><p>ç§¯æã€ä¸»åŠ¨ã€ä¸æ€•æ‹’ç»ã€æ°¸è¿œä¿æŒæ¿€æƒ…ã€‚</p><hr><p>çŸ¥é“å’Œåšåˆ°ä¸­é—´æœ‰å·¨å¤§çš„é¸¿æ²Ÿï¼Œå¾ˆå¤šäººç»ˆç”Ÿæ— æ³•é€¾è¶Šã€‚</p><hr><p>è‡ªå¾‹ï¼Œä¸æ˜¯é æ„å¿—åŠ›æ¥åšåˆ°çš„ï¼Œè€Œæ˜¯æºäºä½ å¯¹æœªæ¥çš„æœŸæœ›ï¼Œä½ çš„ç›®æ ‡ï¼Œä½ å†…å¿ƒçš„æ¸´æ±‚ã€‚</p><hr><p>æ·±å…¥æ€è€ƒã€è°¨æ…å†³å®šã€åšå®šæ‰§è¡Œã€‚</p><hr><p>åŠ¿åˆ©å°±æ˜¯åªå¯¹è¡¨é¢ç°çŠ¶çš„é™„å’Œï¼Œä¸èƒ½è¶…è¶Šç°åœ¨ï¼Œå»æƒ³è±¡è¿˜æœªå‘ç”Ÿçš„äº‹æƒ…ã€‚</p><hr><p>è¦å»äº†è§£ä¸€ä¸ªäººæ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„äººï¼Œé¦–å…ˆæƒ³åˆ°çš„è¦èŠçš„è¯é¢˜çš„åº”è¯¥æ˜¯ä»–çš„ç«¥å¹´ã€‚</p><hr><p>å¸¦ç€å®¡è§†çš„ç›®å…‰å»è¯»ä¹¦ï¼Œå¤šé—®ä¸ºä»€ä¹ˆã€‚</p><hr><p>å¯¹äºé‚£äº›åœ¨ä½ ç”Ÿå‘½ä¸­å‡ºç°è¿‡çš„ï¼Œé™ªä½ èµ°è¿‡ä¸€æ®µè·¯çš„äººï¼Œè¦å¿ƒæ€€æ„Ÿæ¿€ã€‚</p><hr><p>æœªå®Œå¾…ç»­â€¦</p><h2 id="è‹±æ–‡ç¯‡"><a href="#è‹±æ–‡ç¯‡" class="headerlink" title="è‹±æ–‡ç¯‡"></a>è‹±æ–‡ç¯‡</h2><p>Living with Painã€‚</p><hr><p>Fear lasts longer than love.</p><hr><p>Every day like itâ€™s your last.</p><hr><p>Be water my friend.</p><hr><p>Kill the boy and let the man be born.</p><hr><p>Good and great are seldom in the same man.</p><hr><p>Not all problems are worth solving.</p><hr><p>All greatness comes from a brave beginning. â€” cadillac.</p><hr><p><img src="/../img/movie/dogman.png" alt="dogman"></p><hr><p><img src="/../img/movie/bastard.png" alt="bastarden"></p><hr><p>To be continuedâ€¦</p>]]></content>
    
    
    <categories>
      
      <category>å·¥ä½œä¹‹å¤–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>éšç¬”</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo å»ºç«™-HelloWorld</title>
    <link href="/2024/05/19/hello-world/"/>
    <url>/2024/05/19/hello-world/</url>
    
    <content type="html"><![CDATA[<p>ä¸ºä»€ä¹ˆéœ€è¦ä¸ªäººåšå®¢ï¼Ÿ</p><p>å¹³æ—¶ï¼Œä½œä¸ºä¸ªäººè®°å½•ï¼Œä½¿ç”¨ç±»ä¼¼ Notion çš„äº‘ç¬”è®°å°±è¶³å¤Ÿäº†ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦ä¸€ä¸ªä¸ªäººåšå®¢å‘¢ï¼Œæˆ‘è®¤ä¸ºä¸ªäººåšå®¢æœ‰ä¸¤ä¸ªä½œç”¨ï¼Œä¸€ä¸ªæ˜¯åšå®¢æ˜¯å±•ç¤ºè‡ªå·±çš„çª—å£ï¼Œæ˜¯å¯¹å¤–çš„ï¼Œè®©åˆ«äººèƒ½å¤Ÿæ›´å¿«çš„äº†è§£ä½ ã€‚å¦ä¸€ä¸ªä½œç”¨å°±æ˜¯ä½œä¸ºç®€å†çš„è¡¥å……ï¼Œåœ¨æ‰¾å·¥ä½œæ—¶ï¼Œé™„ä¸Šä¸ªäººç½‘ç«™çš„é“¾æ¥ï¼Œæ— è®ºæ˜¯ hr è¿˜æ˜¯ é¢è¯•å®˜ï¼Œéƒ½å¯ä»¥é€šè¿‡ä¸ªäººåšå®¢ç½‘ç«™å¿«é€Ÿäº†è§£ä½ ï¼Œè¿™é‡Œçš„ä¿¡æ¯è¦æ¯”ç®€å†æ›´ä¸°å¯Œã€‚</p><p>ä¸€å¥è¯ï¼Œå®ƒæ˜¯å‘ä»–äººå±•ç¤ºè‡ªå·±çš„çª—å£ï¼Œä¹Ÿæ˜¯ç®€å†çš„ä¸€éƒ¨åˆ†ã€‚</p><p>Hexo æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ã€‚ä¸»è¦ç”¨äºæ­å»ºé™æ€åšå®¢ã€‚æ”¯æŒå¿«é€Ÿæ–¹ä¾¿çš„å°†ä¸ªäººåšå®¢ç½‘ç«™æ‰˜ç®¡åœ¨ GitHub Pages ä¸Šï¼ŒGitHub Pages æ˜¯ä¸€ç§é™æ€ç«™ç‚¹æ‰˜ç®¡æœåŠ¡ï¼Œæ¯ä¸ª GitHub å¸æˆ·æˆ–ç»„ç»‡éƒ½å¯ä»¥æœ‰ä¸€ä¸ªç«™ç‚¹ã€‚</p><p>éƒ¨ç½²æ–¹å¼æå…¶ç®€å•ï¼Œåªè¦ç®€å•å‡ æ­¥ï¼Œä½ å°±å¯ä»¥æ‹¥æœ‰ä¸€ä¸ªä¸ªäººç½‘ç«™ã€‚ä¹Ÿå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£æ­å»ºï¼š</p><p><a href="https://hexo.io/zh-cn/docs/">æ–‡æ¡£ | Hexo</a></p><h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>é¦–å…ˆä¿è¯ä½ çš„ç”µè„‘ä¸Šæœ‰ node js å’Œ git ç¯å¢ƒã€‚</p><p>è¿™é‡Œæˆ‘æ¨è åˆ›å»ºä¸¤ä¸ª git ä»“åº“ï¼Œä¸€ä¸ª git ä»“åº“ç”¨æ¥æ”¾ hexo é¡¹ç›®å’Œåšå®¢ markdown æºæ–‡ä»¶ï¼Œä¸€ä¸ª git ä»“åº“ç”¨äº éƒ¨ç½² hexo é™æ€åšå®¢é¡¹ç›®ã€‚å¯ä»¥å°† æ”¾ hexo é¡¹ç›®å’Œåšå®¢ markdown æºæ–‡ä»¶çš„ä»“åº“è®¾ç½®ä¸º private çš„ï¼Œå°† éƒ¨ç½² hexo çš„ä»“åº“è®¾ç½®ä¸º public çš„ã€‚</p><p>å®‰è£… hexoï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">npm install -g hexo<br></code></pre></td></tr></table></figure><p>åœ¨æƒ³è¦çš„è·¯å¾„ä¸‹æ–°å»ºä¸€ä¸ªåä¸º hexo çš„æ–‡ä»¶å¤¹ï¼ˆåå­—å¯ä»¥éšä¾¿å–ï¼‰ï¼Œä¾‹å¦‚æˆ‘çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">D:\Hexo\hexo-markdown\<br></code></pre></td></tr></table></figure><p>hexo åˆå§‹åŒ–ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">cd D:\Hexo\hexo-markdown\<br>hexo init<br><span class="hljs-comment">// æ³¨æ„ï¼Œå…ˆè·‘ hexo initï¼Œè¿™ä¸ªå‘½ä»¤éœ€è¦åœ¨ä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ä¸‹è¿è¡Œ</span><br>git init<br></code></pre></td></tr></table></figure><p>è¾“å…¥ä»¥ä¸Šå‘½ä»¤åï¼Œhexo ä¼šè‡ªåŠ¨ä¸‹è½½ hexo é¡¹ç›®åˆå§‹åŒ–çš„æ–‡ä»¶åˆ°å½“å‰ç›®å½•ä¸‹ï¼Œå…¶ä¸­ _config.yml ä¸ºç½‘ç«™çš„å…¨å±€é…ç½®æ–‡ä»¶ã€‚å¦‚ä½•é…ç½®è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œå¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œæˆ–è€… config æ–‡ä»¶ä¸­çš„æ³¨é‡Šé…ç½®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">.<br>â”œâ”€â”€ _config.yml<br>â”œâ”€â”€ <span class="hljs-keyword">package</span>.json<br>â”œâ”€â”€ scaffolds<br>â”œâ”€â”€ source<br>|   â”œâ”€â”€ _drafts<br>|   â””â”€â”€ _posts<br>â””â”€â”€ themes<br></code></pre></td></tr></table></figure><p>å…³äºä¸»é¢˜ï¼Œç›´æ¥å…¨ç½‘æœ hexo ä¸»é¢˜ï¼Œæˆ–è€…å»è¿™é‡Œ<a href="https://hexo.io/themes/">Themes | Hexo</a>æŒ‘ä¸€ä¸ªè‡ªå·±é¡ºçœ¼çš„å°±è¡Œï¼Œå°†ä¸»é¢˜ ä¸‹è½½åˆ° themes ç›®å½•ä¸‹ï¼Œæ›´æ”¹ä¸‹ é…ç½®æ–‡ä»¶ä¸­çš„ theme é…ç½®åç§°å°±è¡Œäº†ã€‚è¿™é‡Œæˆ‘é€‰çš„æ˜¯ <a href="https://hexo.fluid-dev.com/">Hexo Theme Fluid (fluid-dev.com)</a> è¿™ä¸ªä¸»é¢˜ï¼ŒæŒ‰ç…§æ•™ç¨‹é…ç½®ä¹Ÿå¾ˆç®€å•ï¼Œè¿™é‡Œå°±ä¸ä»‹ç»äº†ã€‚</p><h1 id="åšå®¢ç”Ÿæˆã€é¢„è§ˆ"><a href="#åšå®¢ç”Ÿæˆã€é¢„è§ˆ" class="headerlink" title="åšå®¢ç”Ÿæˆã€é¢„è§ˆ"></a>åšå®¢ç”Ÿæˆã€é¢„è§ˆ</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">hexo g # ç”Ÿæˆ<br>hexo s # å¯åŠ¨æœåŠ¡<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œä»¥ä¸Šå‘½ä»¤ä¹‹åï¼Œhexo å°±ä¼šåœ¨ public æ–‡ä»¶å¤¹ç”Ÿæˆç›¸å…³ html æ–‡ä»¶ï¼Œè¿™äº›å°±æ˜¯ä½ åšå®¢çš„é™æ€æ–‡ä»¶ï¼Œåç»­éœ€è¦æŠŠè¿™äº›æäº¤åˆ° GitHub ä¸Šã€‚</p><p>hexo s æ˜¯å¼€å¯æœ¬åœ°é¢„è§ˆæœåŠ¡ï¼Œæ‰“å¼€æµè§ˆå™¨è®¿é—® Â <code>localhost:4000</code>Â  å³å¯çœ‹åˆ°å†…å®¹ï¼Œå¾ˆå¤šäººä¼šç¢°åˆ°æµè§ˆå™¨ä¸€ç›´åœ¨è½¬åœˆä½†æ˜¯å°±æ˜¯åŠ è½½ä¸å‡ºæ¥çš„é—®é¢˜ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯å› ä¸ºç«¯å£å ç”¨çš„ç¼˜æ•…ã€‚</p><p>ä¸€äº›å¸¸ç”¨çš„ hexo å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">hexo new <span class="hljs-string">&quot;postName&quot;</span>   <span class="hljs-comment"># æ–°å»ºæ–‡ç« </span><br>hexo new page <span class="hljs-string">&quot;pageName&quot;</span> <span class="hljs-comment"># æ–°å»ºé¡µé¢</span><br>hexo generate <span class="hljs-comment"># ç”Ÿæˆé™æ€é¡µé¢è‡³publicç›®å½•</span><br>hexo server <span class="hljs-comment"># å¼€å¯é¢„è§ˆè®¿é—®ç«¯å£ï¼ˆé»˜è®¤ç«¯å£4000ï¼Œ&#x27;ctrl + c&#x27;å…³é—­serverï¼‰</span><br>hexo deploy <span class="hljs-comment"># å°†.deployç›®å½•éƒ¨ç½²åˆ°GitHub</span><br>hexo <span class="hljs-built_in">help</span>  <span class="hljs-comment"># æŸ¥çœ‹å¸®åŠ©</span><br>hexo version  <span class="hljs-comment"># æŸ¥çœ‹Hexoçš„ç‰ˆæœ¬</span><br>hexo deploy -g  <span class="hljs-comment"># ç”ŸæˆåŠ éƒ¨ç½²</span><br>hexo server -g  <span class="hljs-comment"># ç”ŸæˆåŠ é¢„è§ˆ</span><br><span class="hljs-comment"># å‘½ä»¤çš„ç®€å†™</span><br>hexo n == hexo new<br>hexo g == hexo generate<br>hexo s == hexo server<br>hexo d == hexo deploy<br></code></pre></td></tr></table></figure><p>è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥å…ˆ hexo cleanï¼Œå†é‡è¯•ã€‚</p><h1 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h1><p>é¦–å…ˆï¼Œåœ¨ config æ–‡ä»¶ä¸­ é…ç½® éƒ¨ç½²æ–¹å¼ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©éƒ¨ç½²åˆ° GitHub Pages ä¸Šã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">deploy:</span><br>  <span class="hljs-attr">type:</span> <span class="hljs-string">&quot;git&quot;</span><br>  <span class="hljs-attr">repository:</span> <span class="hljs-string">git@github.com:xxxxx/xxxxx.github.io.git</span> <span class="hljs-comment"># å†™ä½ è‡ªå·±çš„ä»“åº“</span><br>  <span class="hljs-attr">branch:</span> <span class="hljs-string">master</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œéœ€è¦å…ˆæŠŠ git æ¨ä»£ç çš„ ssh é…ç½®å®Œæˆï¼Œè¿™æ · åœ¨ éƒ¨ç½²æ—¶ï¼Œhexo ä¼šæŠŠæœ€æ–°ä»£ç æ¨é€åˆ° éƒ¨ç½²ä»“åº“ã€‚</p><p>éƒ¨ç½²ä»“åº“åˆ›å»ºï¼š</p><p>æ–°å»ºä¸€ä¸ªåä¸º ç”¨æˆ·å.github.ioÂ  çš„ä»“åº“ï¼Œæ¯”å¦‚è¯´ï¼Œå¦‚æœä½ çš„ GitHub ç”¨æˆ·åæ˜¯ xcxyhï¼Œé‚£ä¹ˆä½ å°±æ–°å»ºåä¸º Â xcxyh.github.ioÂ  çš„ä»“åº“ï¼Œå°†æ¥ä½ çš„ç½‘ç«™è®¿é—®åœ°å€å°±æ˜¯ Â xcxyh.github.ioã€‚ä»“åº“åå­—å¿…é¡»æ˜¯ï¼šusername.github.ioï¼Œå…¶ä¸­ username æ˜¯ä½ çš„ç”¨æˆ·åã€‚</p><p>ç”±æ­¤å¯è§ï¼Œæ¯ä¸€ä¸ª GitHub è´¦æˆ·æœ€å¤šåªèƒ½åˆ›å»ºä¸€ä¸ªè¿™æ ·å¯ä»¥ç›´æ¥ä½¿ç”¨åŸŸåè®¿é—®çš„ä»“åº“ã€‚</p><p>hexo éƒ¨ç½²å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hexo d<br></code></pre></td></tr></table></figure><p>ç›´æ¥æ‰§è¡Œ hexo d çš„è¯ä¸€èˆ¬ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p><p><code>Deployer not found: git</code></p><p>è¿™æ˜¯å› ä¸ºç¼ºå°‘äº†ä¸€ä¸ªæ’ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤å®‰è£…ï¼š</p><p><code>npm install hexo-deployer-git --save</code></p><p>ç„¶åè¾“å…¥ hexo d å°±ä¼šå°†æœ¬æ¬¡æœ‰æ”¹åŠ¨çš„ä»£ç å…¨éƒ¨æäº¤ï¼ˆPSï¼šè¿™é‡Œ hexo é€‰æ‹©çš„æ–¹å¼æ˜¯å¼ºæ¨åˆ° master åˆ†æ”¯ï¼‰ã€‚</p><p>github.ioÂ  åœ¨å¤§é™†çš„åŠ è½½é€Ÿåº¦è¿‡æ…¢ä¸”å»¶è¿Ÿè¿‡é«˜ï¼Œå¯ä»¥é€‰æ‹©å°† ä¸ªäººç½‘ç«™éƒ¨ç½²åœ¨ Codingï¼Œå¯ä»¥å‚è€ƒï¼š<a href="https://support.qq.com/products/104149/faqs-more/?id=61222">CODING (qq.com)</a></p><p>éƒ¨ç½²éšæœºåŸŸåçš„ä¸ªäººç½‘é¡µæµç¨‹ï¼š</p><p>æ–°å»ºå›¢é˜Ÿç”¨æˆ·ï¼Œä¸ªäººä¸ºç®¡ç†ã€‚</p><p>æ–°å»º DevOps é¡¹ç›®ï¼Œå–åè¦ä¸è‡ªå·±çš„å›¢é˜Ÿåç›¸åŒã€‚</p><p>ä¹‹åå†å·¦ä¾§è¾¹æ ä¸­æ‰¾åˆ°æŒç»­éƒ¨ç½²èœå•æ ï¼Œé€‰ä¸­é™æ€ç½‘ç«™è¿›è¡Œç«‹å³éƒ¨ç½²ã€‚</p><p>ç„¶åä¿®æ”¹ é…ç½® _config.xml ä¸­ç›¸å…³ deploy éƒ¨åˆ†å³å¯ã€‚</p><h1 id="å†™æ–‡ç« "><a href="#å†™æ–‡ç« " class="headerlink" title="å†™æ–‡ç« "></a>å†™æ–‡ç« </h1><p>åœ¨ hexo æ ¹ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hexo new <span class="hljs-string">&#x27;æ–‡ç« åç§°&#x27;</span><br></code></pre></td></tr></table></figure><p>hexo ä¼šå¸®æˆ‘ä»¬åœ¨ _posts ä¸‹ç”Ÿæˆç›¸å…³ md æ–‡ä»¶ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰“å¼€è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥å¼€å§‹å†™åšå®¢æ–‡ç« äº†ï¼Œç”¨è¿™ä¸ªå‘½ä»¤çš„å¥½å¤„æ˜¯å¸®æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆäº†æ–‡ç« åˆ›å»ºæ—¶é—´ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>HEXO ç›¸å…³</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexoå»ºç«™</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
